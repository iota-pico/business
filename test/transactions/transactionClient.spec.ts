/**
 * Tests for TransactionClient.
 */
import { IApiClient } from "@iota-pico/api/dist/interfaces/IApiClient";
import { IProofOfWork } from "@iota-pico/crypto/dist/interfaces/IProofOfWork";
import { Address } from "@iota-pico/data/dist/data/address";
import { AddressSecurity } from "@iota-pico/data/dist/data/addressSecurity";
import { Hash } from "@iota-pico/data/dist/data/hash";
import { Input } from "@iota-pico/data/dist/data/input";
import { Tag } from "@iota-pico/data/dist/data/tag";
import { Transaction } from "@iota-pico/data/dist/data/transaction";
import { Transfer } from "@iota-pico/data/dist/data/transfer";
import { TryteNumber } from "@iota-pico/data/dist/data/tryteNumber";
import { Trytes } from "@iota-pico/data/dist/data/trytes";
import * as chai from "chai";
import * as sinon from "sinon";
import { TransactionClient } from "../../src/transactions/transactionClient";

describe("TransactionClient", () => {
    let apiClientStub: IApiClient;
    const sandbox = sinon.sandbox.create();

    beforeEach(() => {
        sandbox.stub();
        apiClientStub = <IApiClient>{};
    });

    afterEach(() => {
        sandbox.restore();
    });

    it("can be created", () => {
        const obj = new TransactionClient(apiClientStub);
        chai.should().exist(obj);
    });

    describe("initialize", () => {
        it("can be called with no proof of work initialization", async () => {
            const obj = new TransactionClient(apiClientStub);
            await obj.initialize();
            chai.should().exist(obj);
        });

        it("can be called with proof of work initialization", async () => {
            const proofOfWorkStub = <IProofOfWork>{};
            proofOfWorkStub.initialize = sandbox.stub().resolves();
            const obj = new TransactionClient(apiClientStub, proofOfWorkStub);
            await obj.initialize();
            chai.should().exist(obj);
        });
    });

    describe("getTransactionsInProgress", () => {
        it("can be called and have no response", async () => {
            apiClientStub.getTips = sandbox.stub().resolves(undefined);
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getTransactionsInProgress();
            chai.expect(response).be.deep.equal([]);
        });

        it("can be called and return some hashes", async () => {
            apiClientStub.getTips = sandbox.stub().resolves({ hashes: ["A".repeat(81), "B".repeat(81)] });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getTransactionsInProgress();
            chai.expect(response[0].toTrytes().toString()).be.equal("A".repeat(81));
            chai.expect(response[1].toTrytes().toString()).be.equal("B".repeat(81));
        });
    });

    describe("findTransactions", () => {
        it("can fail with no parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.findTransactions();
            } catch (err) {
                chai.expect(err.message).to.contain("must provide bundles");
            }
        });

        it("can fail with invalid bundle parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.findTransactions(<any>[1]);
            } catch (err) {
                chai.expect(err.message).to.contain("The bundle");
            }
        });

        it("can fail with invalid addresses parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.findTransactions(undefined, <any>[1]);
            } catch (err) {
                chai.expect(err.message).to.contain("The addresses");
            }
        });

        it("can fail with invalid tags parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.findTransactions(undefined, undefined, <any>[1]);
            } catch (err) {
                chai.expect(err.message).to.contain("The tags");
            }
        });

        it("can fail with invalid approvees parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.findTransactions(undefined, undefined, undefined, <any>[1]);
            } catch (err) {
                chai.expect(err.message).to.contain("The approvees");
            }
        });

        it("can be called with no response", async () => {
            apiClientStub.findTransactions = sandbox.stub().resolves(undefined);
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.findTransactions(undefined, [Address.fromTrytes(Trytes.fromString("XFAELMMFKBKNGAYLKNFOLHMOTAM9IVOLABDLNKNWUIFK9QJXEJKGAUHMEPMYPGLPFBWZAXJMFZYCWMQEA"))]);
            chai.expect(response).be.deep.equal([]);
        });

        it("can be called with bundles and return some hashes", async () => {
            apiClientStub.findTransactions = sandbox.stub().resolves({
                hashes: [
                    "TSQWPHOJGWJOACGHSWKXLOVSLPUZWTWGMOPKUWDNXGUERKK9PPFKBGFUKWMDGZBZZTLXHRTPIYEU99999",
                    "PPAYHUKKHOAPUNCMRXWLZKY9WOVUJ9BNETKVMYZKA9UIVYJSEOVVNPZSYBFVRZGHEKPMQSHEEVPLA9999"
                ]
            });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.findTransactions([Hash.fromTrytes(Trytes.fromString("XGEGFFINFHKFCTT9TCSFVNWYZRWMGMVJKKXQBTGSTFUKDVJ9SGSIWZJIZTNO9DWNGQGHVJBKOR9GBKKWW"))]);
            chai.expect(response[0].toTrytes().toString()).be.equal("TSQWPHOJGWJOACGHSWKXLOVSLPUZWTWGMOPKUWDNXGUERKK9PPFKBGFUKWMDGZBZZTLXHRTPIYEU99999");
            chai.expect(response[1].toTrytes().toString()).be.equal("PPAYHUKKHOAPUNCMRXWLZKY9WOVUJ9BNETKVMYZKA9UIVYJSEOVVNPZSYBFVRZGHEKPMQSHEEVPLA9999");
        });

        it("can be called with addresses return some hashes", async () => {
            apiClientStub.findTransactions = sandbox.stub().resolves({
                hashes: [
                    "DOOSQLTIPGWQBV9BYNRROYDYWXJAKZCKJBEQNISEB9QLHHBNQQGWZLAQHVZGTQVSOCJRBGUVAEXV99999",
                    "VRLBDGXDZXIVSOUWAGZULWKVLEQRYBRKAMQGXNPLBUDOLBP9IBPDZAAGTKQOUOLREUKTBIJXHFG9A9999"
                ]
            });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.findTransactions(undefined, [Address.fromTrytes(Trytes.fromString("XFAELMMFKBKNGAYLKNFOLHMOTAM9IVOLABDLNKNWUIFK9QJXEJKGAUHMEPMYPGLPFBWZAXJMFZYCWMQEA"))]);
            chai.expect(response[0].toTrytes().toString()).be.equal("DOOSQLTIPGWQBV9BYNRROYDYWXJAKZCKJBEQNISEB9QLHHBNQQGWZLAQHVZGTQVSOCJRBGUVAEXV99999");
            chai.expect(response[1].toTrytes().toString()).be.equal("VRLBDGXDZXIVSOUWAGZULWKVLEQRYBRKAMQGXNPLBUDOLBP9IBPDZAAGTKQOUOLREUKTBIJXHFG9A9999");
        });

        it("can be called with tags and return some some hashes", async () => {
            apiClientStub.findTransactions = sandbox.stub().resolves({
                hashes: [
                    "TSQWPHOJGWJOACGHSWKXLOVSLPUZWTWGMOPKUWDNXGUERKK9PPFKBGFUKWMDGZBZZTLXHRTPIYEU99999",
                    "EMOFBQIMQ9TTAMRTBRZBF9KZWY9ZCHIKAJZBPDJJAJIZVHVW9AXEXBDRWNMXXSOHIZLB9WRQSQCZ99999"
                ]
            });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.findTransactions(undefined, undefined, [Tag.fromTrytes(Trytes.fromString("AGIFTFORU"))]);
            chai.expect(response[0].toTrytes().toString()).be.equal("TSQWPHOJGWJOACGHSWKXLOVSLPUZWTWGMOPKUWDNXGUERKK9PPFKBGFUKWMDGZBZZTLXHRTPIYEU99999");
            chai.expect(response[1].toTrytes().toString()).be.equal("EMOFBQIMQ9TTAMRTBRZBF9KZWY9ZCHIKAJZBPDJJAJIZVHVW9AXEXBDRWNMXXSOHIZLB9WRQSQCZ99999");
        });
        it("can be called with approvees and return some hashes", async () => {
            apiClientStub.findTransactions = sandbox.stub().resolves({
                hashes: [
                    "TSQWPHOJGWJOACGHSWKXLOVSLPUZWTWGMOPKUWDNXGUERKK9PPFKBGFUKWMDGZBZZTLXHRTPIYEU99999",
                    "NCVGRHO9XHDXYBKJNNEDUMNDKOBQHRDNTBJWFFWMPUP9VZUDQTVTJ9MI9AQAFZKJOGAY9TG9JNBTA9999"
                ]
            });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.findTransactions(undefined, undefined, undefined, [
                Hash.fromTrytes(Trytes.fromString("TLBZDQPRDNQMMGSJTLSECGZP9B9BWYSFOWZGCPPZYHDRAITCUHOGEIBKLTUJTBNFKUCGNONBMUXA99999"))]);
            chai.expect(response[0].toTrytes().toString()).be.equal("TSQWPHOJGWJOACGHSWKXLOVSLPUZWTWGMOPKUWDNXGUERKK9PPFKBGFUKWMDGZBZZTLXHRTPIYEU99999");
            chai.expect(response[1].toTrytes().toString()).be.equal("NCVGRHO9XHDXYBKJNNEDUMNDKOBQHRDNTBJWFFWMPUP9VZUDQTVTJ9MI9AQAFZKJOGAY9TG9JNBTA9999");
        });
    });

    describe("getTransactionsObjects", () => {
        it("can fail with no parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getTransactionsObjects(undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The transactionHashes");
            }
        });

        it("can fail with invalid parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getTransactionsObjects(<any>[1]);
            } catch (err) {
                chai.expect(err.message).to.contain("The transactionHashes");
            }
        });

        it("can be called with transaction hashes and return no transaction objects", async () => {
            apiClientStub.getTrytes = sandbox.stub().resolves(undefined);
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getTransactionsObjects([
                Hash.fromTrytes(Trytes.fromString("V9MSZLPEDELSILGWDWXIZVK9SMYQ9FRFIUCQ9TTHQXEPCXTTAJCRKDCAXNFDDLIOIULKBVRJM9NMZ9999"))]);

            chai.expect(response.length).to.be.equal(0);
        });

        it("can be called with transaction hashes and return some transaction objects", async () => {
            apiClientStub.getTrytes = sandbox.stub().resolves({
                trytes: [
                    // tslint:disable-next-line:max-line-length
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999MGCBEIBTRCXOVCEZKHAGGGA9KMFCEPARA9KDB9MVYMDBPTJF9PCCLKXDUEMDXQFXQOVGDS9MVUUYUUHDZHSLGEFUOWBA9999999999999999999999999999999999999999999VADJUYD99C99999999C99999999BOJHRBIIKYBFJF9FFRXJBOUSOZH9EEYAJHEXQOFUVUTCHAEUEQOABERXPW9EWEBSFJRXXS9KEILBDYYRDMSDQVDADPRYMDT9YGTXWCQLHRCJMBRETLLAUTJSREBUJCWVEOOIMPPQCQEHBYSQVMACJFEJWLWFZA9999LFZLSXFKKMLFVUUZUCPPJGJGCMVMBBSLQWVAJJPGHGXCIPRLWHA9UEPHLFFIWVHDKDDEBDVPDYZZZ9999999999999999999999999999999EAKTTFCJE999999999L99999999OPIESBFYFUHSYQQDJYOBUSZLKCU"
                ]
            });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getTransactionsObjects([
                Hash.fromTrytes(Trytes.fromString("V9MSZLPEDELSILGWDWXIZVK9SMYQ9FRFIUCQ9TTHQXEPCXTTAJCRKDCAXNFDDLIOIULKBVRJM9NMZ9999"))]);

            chai.expect(response.length).to.be.equal(1);
            // tslint:disable-next-line:max-line-length
            chai.expect(response[0].signatureMessageFragment.toTrytes().toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[0].address.toTrytes().toString()).to.be.equal("MGCBEIBTRCXOVCEZKHAGGGA9KMFCEPARA9KDB9MVYMDBPTJF9PCCLKXDUEMDXQFXQOVGDS9MVUUYUUHDZ");
            chai.expect(response[0].value.toNumber()).to.be.equal(219884849054297);
            chai.expect(response[0].obsoleteTag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response[0].timestamp.toNumber()).to.be.equal(1517995264);
            chai.expect(response[0].currentIndex.toNumber()).to.be.equal(3);
            chai.expect(response[0].lastIndex.toNumber()).to.be.equal(3);
            chai.expect(response[0].bundle.toTrytes().toString()).to.be.equal("BOJHRBIIKYBFJF9FFRXJBOUSOZH9EEYAJHEXQOFUVUTCHAEUEQOABERXPW9EWEBSFJRXXS9KEILBDYYRD");
            chai.expect(response[0].trunkTransaction.toTrytes().toString()).to.be.equal("MSDQVDADPRYMDT9YGTXWCQLHRCJMBRETLLAUTJSREBUJCWVEOOIMPPQCQEHBYSQVMACJFEJWLWFZA9999");
            chai.expect(response[0].branchTransaction.toTrytes().toString()).to.be.equal("LFZLSXFKKMLFVUUZUCPPJGJGCMVMBBSLQWVAJJPGHGXCIPRLWHA9UEPHLFFIWVHDKDDEBDVPDYZZZ9999");
            chai.expect(response[0].tag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response[0].attachmentTimestamp.toNumber()).to.be.equal(1517995719527);
            chai.expect(response[0].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response[0].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response[0].nonce.toTrytes().toString()).to.be.equal("OPIESBFYFUHSYQQDJYOBUSZLKCU");
        });
    });

    describe("getLatestInclusion", () => {
        it("can fail with no parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getLatestInclusion(undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The transactionHashes");
            }
        });

        it("can fail with invalid parameters", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getLatestInclusion(<any>[1]);
            } catch (err) {
                chai.expect(err.message).to.contain("The transactionHashes");
            }
        });

        it("can fail if node has no latestSolidSubtangleMilestone", async () => {
            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: "123" });
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getLatestInclusion([
                    Hash.fromTrytes(Trytes.fromString("V9MSZLPEDELSILGWDWXIZVK9SMYQ9FRFIUCQ9TTHQXEPCXTTAJCRKDCAXNFDDLIOIULKBVRJM9NMZ9999")),
                    Hash.fromTrytes(Trytes.fromString("JMECUJIFAQKYCPMPRATVEFLAKHLHBRFHSJXUKQSZNZCEXVG9EANYIGHBVUTXLBNRCHXLCPT9MPKCA9999")),
                    Hash.fromTrytes(Trytes.fromString("THENWGPTAPZIIDWHQJ9GREHOVPXNTFWTSTEUGMBPHCHVPGPCEOLGHKZWH9FKACAUIMXJIAFVN9TJZ9999"))
                ]);
            } catch (err) {
                chai.expect(err.message).to.contain("latestSolidSubtangleMilestone");
            }
        });

        it("can be called with transaction hashes and return no transaction objects", async () => {
            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: 123 });
            apiClientStub.getInclusionStates = sandbox.stub().resolves(undefined);
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getLatestInclusion([
                Hash.fromTrytes(Trytes.fromString("V9MSZLPEDELSILGWDWXIZVK9SMYQ9FRFIUCQ9TTHQXEPCXTTAJCRKDCAXNFDDLIOIULKBVRJM9NMZ9999")),
                Hash.fromTrytes(Trytes.fromString("JMECUJIFAQKYCPMPRATVEFLAKHLHBRFHSJXUKQSZNZCEXVG9EANYIGHBVUTXLBNRCHXLCPT9MPKCA9999")),
                Hash.fromTrytes(Trytes.fromString("THENWGPTAPZIIDWHQJ9GREHOVPXNTFWTSTEUGMBPHCHVPGPCEOLGHKZWH9FKACAUIMXJIAFVN9TJZ9999"))
            ]);

            chai.expect(response.length).to.be.equal(0);
        });

        it("can be called with transaction hashes and return some inclusion states", async () => {
            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: 123 });
            apiClientStub.getInclusionStates = sandbox.stub().resolves({ states: [false, true, false] });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getLatestInclusion([
                Hash.fromTrytes(Trytes.fromString("V9MSZLPEDELSILGWDWXIZVK9SMYQ9FRFIUCQ9TTHQXEPCXTTAJCRKDCAXNFDDLIOIULKBVRJM9NMZ9999")),
                Hash.fromTrytes(Trytes.fromString("JMECUJIFAQKYCPMPRATVEFLAKHLHBRFHSJXUKQSZNZCEXVG9EANYIGHBVUTXLBNRCHXLCPT9MPKCA9999")),
                Hash.fromTrytes(Trytes.fromString("THENWGPTAPZIIDWHQJ9GREHOVPXNTFWTSTEUGMBPHCHVPGPCEOLGHKZWH9FKACAUIMXJIAFVN9TJZ9999"))
            ]);

            chai.expect(response.length).to.be.equal(3);
            chai.expect(response[0]).to.be.equal(false);
            chai.expect(response[1]).to.be.equal(true);
            chai.expect(response[2]).to.be.equal(false);
        });
    });

    describe("getNewAddress", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getNewAddress(<any>"ABC");
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can fail with non integer startIndex", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getNewAddress(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), <any>true);
            } catch (err) {
                chai.expect(err.message).to.contain("must be an integer");
            }
        });

        it("can fail with invalid startIndex", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getNewAddress(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), -1);
            } catch (err) {
                chai.expect(err.message).to.contain(">= 0");
            }
        });

        it("can fail with invalid endIndex <= 0", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getNewAddress(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 1, 0);
            } catch (err) {
                chai.expect(err.message).to.contain("> 0");
            }
        });

        it("can fail with invalid total > 500", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getNewAddress(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 1, 501);
            } catch (err) {
                chai.expect(err.message).to.contain("<= 500");
            }
        });

        it("can succeed getting indexed address", async () => {
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getNewAddress(Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW")), 0, 2);
            chai.expect(response[0].toTrytes().toString()).to.be.equal("FKACNBUBBPKFVGUEVDRQWCJELYQPZWTQETATRCLGMOSLAJHKPQDKESFBTMQIQBBH9DUCHGEIDJCSHKFFC");
            chai.expect(response[1].toTrytes().toString()).to.be.equal("QFSPUNJAYKVCOAAKCDZLWFMWOSLUZEHCPPHWSM9BODLELNLGB9LDCVLDAOUEXAVGNWPPVXVODAAOJFFRX");
        });

        it("can succeed getting non indexed address", async () => {
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.getNewAddress(Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW")), 1);
            chai.expect(response[0].toTrytes().toString()).to.be.equal("QFSPUNJAYKVCOAAKCDZLWFMWOSLUZEHCPPHWSM9BODLELNLGB9LDCVLDAOUEXAVGNWPPVXVODAAOJFFRX");
        });
    });

    describe("getAddressesByIndex", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesByIndex(<any>"ABC", undefined, undefined, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can fail with invalid startIndex", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesByIndex(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), -1, undefined, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The startIndex");
            }
        });

        it("can fail with invalid endIndex <= 0", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesByIndex(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 1, 0, false, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The endIndex");
            }
        });

        it("can fail with invalid total > 500", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesByIndex(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 1, 501, false, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("<= 500");
            }
        });

        it("can fail with invalid security", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesByIndex(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 0, 1, false, <any>0);
            } catch (err) {
                chai.expect(err.message).to.contain("The security");
            }
        });

        it("can generate index-based 1 addresses with checksum", async () => {
            const obj = new TransactionClient(apiClientStub);

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesByIndex(seed, 1, 2, true, AddressSecurity.low);

            chai.expect(response[0].toTrytesWithChecksum().toString()).to.be.equal("WUQMPPKFDR9IIGRLDBETVTMGTLYLPTKICWKMNZNBYPQDNQ9YTTOPYUBUYFQEALBRTEPRUFHWOVY9NCW9DE9WXEIJWC");
            chai.expect(response[1].toTrytesWithChecksum().toString()).to.be.equal("SAYJVKKLL9YKEEUSQFKCPUUEXADXWTQYFSCJOXDPLVGUXCTHKRRVUUSMGYOAPKT9YXCHRJWDTTPZGE9BXVLRXSAJZX");
        });

        it("can generate index-based 1 addresses no checksum", async () => {
            const obj = new TransactionClient(apiClientStub);

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesByIndex(seed, 1, 2, false, AddressSecurity.low);

            chai.expect(response[0].toTrytes().toString()).to.be.equal("WUQMPPKFDR9IIGRLDBETVTMGTLYLPTKICWKMNZNBYPQDNQ9YTTOPYUBUYFQEALBRTEPRUFHWOVY9NCW9D");
            chai.expect(response[1].toTrytes().toString()).to.be.equal("SAYJVKKLL9YKEEUSQFKCPUUEXADXWTQYFSCJOXDPLVGUXCTHKRRVUUSMGYOAPKT9YXCHRJWDTTPZGE9BX");
        });

        it("can generate index-based 5 addresses with checksum", async () => {
            const obj = new TransactionClient(apiClientStub);

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesByIndex(seed, 5, 7, true, AddressSecurity.low);

            chai.expect(response[0].toTrytesWithChecksum().toString()).to.be.equal("GNHOKBJGTHASHZCGOVFRSDTLVZHMREKHZESIOEJMYI9P9INKUZXKLW9P9KFHSUDBPVDIWILOHLLDRXVSDXCAMKD9HZ");
            chai.expect(response[1].toTrytesWithChecksum().toString()).to.be.equal("LFVKRMYLAEDJBGQU9APVPZIFKVZUEMGLTDYBDTEUHRNCDNODNCOLAB9VXSZTHMXPVBD9DSVHUPPUWCNS9IVP9OKKHD");
        });

        it("can generate index-based 10 addresses with checksum security medium", async () => {
            const obj = new TransactionClient(apiClientStub);

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesByIndex(seed, 10, 12, true, AddressSecurity.medium);

            chai.expect(response[0].toTrytesWithChecksum().toString()).to.be.equal("NDZNIIRCKGY9X9KLJFYRXNDUYVMTAXEMWHNHUQ9C9X9RICXIRRIYRWYXXDQAGYCDVC9GSASO9FGIWKN9XKIUDXZZXZ");
            chai.expect(response[1].toTrytesWithChecksum().toString()).to.be.equal("LENQNXNREDKHEJBKSOJABZIVZQFGTBRVAMMDVPI9FZF9QWXWQK9FMRIBKPIUOXPGMMYGGZIMEWHHUBCZWSNODDUTAY");
        });

        it("can generate index-based 15 addresses with checksum security high", async () => {
            const obj = new TransactionClient(apiClientStub);

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesByIndex(seed, 15, 17, true, AddressSecurity.high);

            chai.expect(response[0].toTrytesWithChecksum().toString()).to.be.equal("LCNP9HTWETYMYCCEVUTKYDCGGWCAVUZYTYCCLBRIGCQNMBWVUIQKKVJOKZWOKUTMMKTMWPZEPJHMKDVMWIVTRDEWXY");
            chai.expect(response[1].toTrytesWithChecksum().toString()).to.be.equal("YXVZ9LBTIXBAVBQBBCEXIJOGIZVBKKQSIFQIA9RMKL9JDVWOVWANEMDZGZBJLWIAZHQATFNAFPFKUXZLBXZMSORZMW");
        });
    });

    describe("getAddressesToUnused", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesToUnused(<any>"ABC", undefined, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can fail with invalid startIndex", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesToUnused(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), -1, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The startIndex");
            }
        });

        it("can fail with invalid security", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAddressesToUnused(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 0, false, <any>0);
            } catch (err) {
                chai.expect(err.message).to.contain("The security");
            }
        });

        it("can generate unused address where not spent from and no transactions response", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves(undefined);
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesToUnused(seed, 0, true, AddressSecurity.low);

            chai.expect(response[0].toTrytesWithChecksum().toString()).to.be.equal("UHUASCSYJQOCABTJAJKVFPIUDTXYPMSJTKICSGJOVKAEDBGJBUXHNTKKMNRHQRKVGPPFKQLP9VNXJOTRBKMJGYCQBD");
        });

        it("can generate unused address where not spent from and no transactions", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesToUnused(seed, 0, true, AddressSecurity.low);

            chai.expect(response[0].toTrytesWithChecksum().toString()).to.be.equal("UHUASCSYJQOCABTJAJKVFPIUDTXYPMSJTKICSGJOVKAEDBGJBUXHNTKKMNRHQRKVGPPFKQLP9VNXJOTRBKMJGYCQBD");
        });

        it("can generate unused address where spent from and no transactions", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub()
                .onFirstCall().resolves({ states: [true] })
                .onSecondCall().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesToUnused(seed, 0, true, AddressSecurity.low);

            chai.expect(response[1].toTrytesWithChecksum().toString()).to.be.equal("WUQMPPKFDR9IIGRLDBETVTMGTLYLPTKICWKMNZNBYPQDNQ9YTTOPYUBUYFQEALBRTEPRUFHWOVY9NCW9DE9WXEIJWC");
        });

        it("can generate unused address where not spent from but has transactions", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub()
                .onFirstCall().resolves({ hashes: ["AAA"] })
                .onSecondCall().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getAddressesToUnused(seed, 0, true, AddressSecurity.low);

            chai.expect(response[1].toTrytesWithChecksum().toString()).to.be.equal("WUQMPPKFDR9IIGRLDBETVTMGTLYLPTKICWKMNZNBYPQDNQ9YTTOPYUBUYFQEALBRTEPRUFHWOVY9NCW9DE9WXEIJWC");
        });
    });

    describe("getInputs", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getInputs(<any>"ABC", undefined, undefined, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can fail with invalid startIndex", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getInputs(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), -1, undefined, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The startIndex");
            }
        });

        it("can fail with invalid security", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getInputs(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 0, 1, <any>0, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The security");
            }
        });

        it("can fail with invalid totalRequired", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getInputs(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 0, 1, AddressSecurity.low, -1);
            } catch (err) {
                chai.expect(err.message).to.contain("The totalRequired");
            }
        });

        it("can fail when getBalance has no response", async () => {
            apiClientStub.getBalances = sandbox.stub().resolves(undefined);
            const obj = new TransactionClient(apiClientStub);

            try {
                await obj.getInputs(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), 0, 1, AddressSecurity.low, 100);
            } catch (err) {
                chai.expect(err.message).to.contain("Not enough combined");
            }
        });

        it("can succeed when totalRequired = 0", async () => {
            apiClientStub.getBalances = sandbox.stub().resolves({ balances: [ "43" ] });
            const obj = new TransactionClient(apiClientStub);

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getInputs(seed, 0, 2, AddressSecurity.low, 0);

            chai.expect(response.totalBalance).to.be.equal(43);
            chai.expect(response.inputs.length).to.be.equal(1);
            chai.expect(response.inputs[0].address.toTrytes().toString()).to.be.equal("UHUASCSYJQOCABTJAJKVFPIUDTXYPMSJTKICSGJOVKAEDBGJBUXHNTKKMNRHQRKVGPPFKQLP9VNXJOTRB");
            chai.expect(response.inputs[0].balance).to.be.equal(43);
            chai.expect(response.inputs[0].keyIndex).to.be.equal(0);
            chai.expect(response.inputs[0].security).to.be.equal(1);
        });

        it("can succeed when requiring mulitple addresses", async () => {
            apiClientStub.getBalances = sandbox.stub().resolves({ balances: [ "1", "5", "50" ] });
            const obj = new TransactionClient(apiClientStub);

            const seed = Hash.fromTrytes(Trytes.fromString("JCGUED9XQWAHWHJUIYIEYSJVGNQLJSGRSUQCEBJD9NQLZIZQGVDILVNNEFWLSCIPEBZTYBJYXWMJOEEZW"));

            const response = await obj.getInputs(seed, 10, 15, AddressSecurity.low, 40);

            chai.expect(response.totalBalance).to.be.equal(56);
            chai.expect(response.inputs.length).to.be.equal(3);
            chai.expect(response.inputs[0].address.toTrytes().toString()).to.be.equal("JBKWWNAWNNNRRMTC9OHFS99EDJNJKSCUDSALPNGYZXUCUNLLWOQBASUKPRTJBOXYEGGTWWVHNOZXTH9PB");
            chai.expect(response.inputs[0].balance).to.be.equal(1);
            chai.expect(response.inputs[0].keyIndex).to.be.equal(10);
            chai.expect(response.inputs[0].security).to.be.equal(1);

            chai.expect(response.inputs[1].address.toTrytes().toString()).to.be.equal("QMDFMN9YAICLTYPZXJPMFP9ZT9FOCOSHOLAALAXOSSRLV9IVBTDMMWCWBAUXDABSOOZATA99KF9IXCYQW");
            chai.expect(response.inputs[1].balance).to.be.equal(5);
            chai.expect(response.inputs[1].keyIndex).to.be.equal(11);
            chai.expect(response.inputs[1].security).to.be.equal(1);

            chai.expect(response.inputs[2].address.toTrytes().toString()).to.be.equal("SHLALKJRGUQYNCKWVJJQKHLCROTSYRFOXSJAJKFKYAPEGNWKTMAVJ99NOFLHVFIAPZ9BSRIPGFCBZKWED");
            chai.expect(response.inputs[2].balance).to.be.equal(50);
            chai.expect(response.inputs[2].keyIndex).to.be.equal(12);
            chai.expect(response.inputs[2].security).to.be.equal(1);
        });
    });

    describe("prepareTransfers", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.prepareTransfers(<any>"ABC", undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can fail with invalid transfers", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));
                await obj.prepareTransfers(seed, []);
            } catch (err) {
                chai.expect(err.message).to.contain("The transfers");
            }
        });

        it("can prepare transfers with no options", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    5,
                    Trytes.fromString("BLAHBLAHBLAHBLAH"),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const response = await obj.prepareTransfers(seed, transfers);

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXKA9999999999999999999999999THISISATAG99999999999999999EJDWC9999C99999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("YGGXHATQITGJFXTYXTSZGUNIFJYQQMSBUMCUPUMIVZNKQGPKPPHUW9VUTQRU9PEJFXVVZYHUMAOQKS9KBMUTHGZVBDN9ZXDSXDKRPFWTTQSEXCZJVKOOITJVVMGTNINPIYVJWAFYAYTMWN9VIAWVHMABAUQFMFTXQWTSUBS99ILK9EDCVIFJXBSUWCHUQTMQLHFWCSYRKPPTCDKGKXG9AIH9HVIAPOFOVFGZPDQGPA9AWVYGPIWGHDMAAUDAQPSEXQAANRWLYSKVWGNWMWQUVMGFVCXNYPTXLFCB9MEQUOHACNUOZVKSWMDIC9VJKGCMNLZ9XJS9VAUXFLJUMDMPGLOIPANXIHNVUFZESIJNVBEVGBYGWYLNX9GMQXHCIMBWIFWUZVHWMP9TPBMCFK9VCIHPXDPJSVHOWF9FZKETGHUAIRJQZMJIDLHKZTGLTRQXSUXEEXEKVMPZLATCCMNDYPDQBWUDFTXFRRBS9AEGTIKFZAFQKGVKLLANESPDXUUMEUM9IMPQVUUKGJYMFDVUEFFUXHTJE9TPIBXOFHHMTGJRBSUX9LBPFXXJ9SSXPQJJUCAFZNXSLMWWPJVLLRNBGOQ9HVNAECPGLCFGMWQP9ZECEW9UECDOYEIWEUVWFL9FYYOAKFMDDYTOTEASTMZA9FYLB9HPZWVFSHYOOWTQ9LKZSDTPCRGRHOYAFBNSWISXFVNYHOEDZGSRPQTTMZBDWUVCWXUSJOTRGZRCZGYWJCDTYMFHGWYBQXNDMIEQ9HNSWV9RBFGUNRKCUNDRAAVVBJQWUGFWAUNGJP9TODLGZDXTHRIJBJOTGQMGPOZKK9KDYLRYHIXWOCFOIWOUUDPOJPFFDNQVCSMAXPNLPUEDOZKEHZMTRLHEAOJRSSDUVVKCDGWHZYKVKTZXYKJUAEDVNGENJWX9XRTYTZUWSXT9ZIRYKHDWIARPSDPTZLQOLWJ9YHIKHMYGBMTWZJUJJQPOXZJQTVQGUHSIXVUAISNVAFUTLYAS9ISMMYD9LLTJTJNYGZSTFUYJKNQDVSWKIMCFFYSFXKEV9GYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZTOALYKXTXTTILGBRGMHC99GZHHCRIT9KGUJYJLSSUMRFSOXLCTRAFUPEJSDWSOHYJQBPVAOZBLAVGCOBDVGNKPJKLAWMHWS9AVKWMXDEZCYPMNFXQPHTXNAYUNXF9MTGSAXYWMQFBFAXXIVISHEEVVBHPDLLGCRNEWTMTC9CUWKXDXBEULDPJPZUESC9BZVPILKVFZVFUNWODKPKYJ9BR9RSRDQPNGMIKFRALTLFNJETRYROCTBVCFXLNDPVETVJHJTQYES9IPDQCJLMCQXPXLEIKTIAVERSXMYGGHTCPJBVTTIUWIAWKCLIFKCEIEGVTPSZYETSCQLVTLIJHDNXVDTTLLMLZFJ9CAKEFIKSYESOZ9TJEHTJLTPHQV9TAFDXSSHRZCYKPOZ9VXKZBJXWZWWWHKLOUP9CEOZXDVRPHMLFJQOUIOJSBZMRNGMMPRVFUKWXBQBAVVFRAIWMNWVMUKYSVA9IBPHOCCMOBDYSTYZSFTZTTYOWCTJMVYUAFE9JWKEPCBNTOMIJYVYKLYHVFLVJBVGLRJIGMBSK9HVGNCUNHMQMOEGAWZZRORGTOAZA9NNKXISDDQEELSLVQ9XHYFDLSNLKWGLTKDJJEVAXBCDKQJLJQVIEUMDTGMNMCZBI9FNDCEHDJJWQDWKFGMUEMUTDQPUHLLEQXQRQAWXRHDDPYHXBTYCUEHEVJSVXGWPGIXPJWBYWJOVKDXSNF9WQKHKA9X9CHOTSWNWIAAYQUTXVTMEPDJHX9ZMURDOQCC9RNYQKQYMUSJLWPHQNPXYWUGLBTAHFBVGHVSJSTBXQVBN9UC9MGHEKD9WLRKHZZZZJRNNTLFUCGZWSOMYUHQHUDIKUSQBCFYKTDNU9WNKKWD9XVSWGYASRYISLCU9HXKODOLSQZYUA9AMJRUZCFYKDHKQJWNWPWPNLYDUNOKWHTJDCYASUTFJWOPZNUYEBAN9YWWCVNNEZE9ZW9RCGPDFAKXRRCNBTMOQDARIVZRMLNJ9OXCGWRHYSGIIVZQRAKLVQEPHJWFCD9BAIOZGGEHKWPEEFXZOGYGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999THISISATAG99999999999999999EJDWC9999B99999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("NJTUZNAHHFRIUGQVMZQUJOHXITWTOAITPDFFKXKSNBOCJBBWZKXIXZUVQIIXNKFFPWYTPIXXHWIVHVSPZOBXRQCSKWOJPYFTBWZCFALTXWDNJZOFNTHBLUOAKIQJRODDJYMEKTKGBCUQZAMLQ9CQEFKFJYSHILDBTAVWSWATHRJDZMZRBKMSOYQGNRWOQRMU9FI9ZCJZUTUICBZFHUIIMAGNHK9TLCVXCYEKJZAYTUBGBRWOOZZLLTQAAERF9VTESVQKHQPSRQXUXLYMOTAXOUB9VWPHLQRJZXHTZDUGORJXYXGFZWVTFZMDJNTNG9EZIMRXSEXOFCABWOZN9RKVYF9KCKV9WIGL9ZSWYWOPJOLUKZUNJBMAKPMPBGGYZYLEFPXEBOUYBCTUQUZXOOIYXKBKIAKVRKLJZMRVMWJXJNPAOCJYISAJVZKVQDTFOJHUJDJGDBJNXTDERIVTNHUCULTPJAY9WNWKSSEYD9EFRUTTRDIIBDCQMWVZYSPRRRZGKANSJOIQNKPHQLAYW9BGUNRGUXKYVKIWDOMUBHBNWCEVNVRPTZMKXPXARKHUHBHNGOPEMDDJDWHHSAXJVWZJUQC9JVWHUOFQXVVLKUGBYMVECOQYWVIQTVLMVSZAIITHJFOIUSBBPKVFTHQFYGOMMDLHJVCFXNUKRHQOQWAONCPGPXIZUICISJRNTMTJW9FWJWWRMFCGCQSPLWHDURRKZEEG9SGYOMIWLIJ9NOQD9WFHWAJV9SK9YIQLQVTWITKXARWDMEBXLHDLW9TNMCA9ZKTTVYWNNQ9ZIVRHLVSEVCTLZFQGLAX9DFJXPDT9DPBWYGODIRVPQMZYGNCUJDTFQOZNHSESILGVTYQU9BWEQDVQTXIACJYIZACTGXWXFKNWUUJJCQWLSBDVHWT9DLYMXLHGPJDXRSEM9WFPNPZZBZPXXUKRBEVNXQYOS9NGJKDZSEXWQOUUILFDPBQIPRLMVISKZBRWCTMXSDOYHXYNJA9WMMMVQDWEPJVLDHXOGHBMWBAFFFVERYDKUHDPHFEVPPXWSHY9ZAVCXWUKKGNMHS9SKDDDPFAMALSILASFB9CLHZBRD9LBFFTTQTDSTCLKNKIUKRQQMOIVLEZHUBSNEXU9NAZLOYV9WUXM9YYZSJXUGAWGSBNDDSPIXHBRCZX9FXSWQDVPGAKLHWAWKUUMLLSQFNCHHIRCSPMPFSQETVWQUHFVOY9BPGYOUMU9A9KFZVPCNGHXKLQUFJAFGJPUXAIJZENLM9OONPBYNJVQQ99YUIZCDOKPB9JLLFE9EFGC9WHC9BXXONEZMBMXDDLOKNBTSMIAGXIRLRRSJBGCCKRSNUHKJXO9SY9JIXWW9WPXFRLMVFVJITQEAOBXRAIOCXTSODXFRYUZIVMNDZOPOXMTDPWZEDPXUMOSEYLZZZK9LTVAHAIYLPLVAPMVHEV9PSUVQOUTQ9LKWHBYWMPLKGQELSBCWSWQLVITY9HB9Q9AUCULQSB9EFTVZNRPRTRZFQTBVNLAYBUEITRPRJDKSTI9TRBVZEADHLYJEOCZPCTGPJFJUJ9VJMZTZJ9LSLZUZKLRPIYPLSWAQPSF99EJAYWKZL9BZEDDJSZRGK9EKSKCWXMTLIWKUI9HXYWOTICQEJMLVUAITJPTEABKN9UUOWUIXOVKCDSBMM9JZ9UXESZFW9OHL9XZHUDOKMAYYXMQMPPWHEKOYFJXOEKFTFED9L9ORNFYNOXYLWSWHHLXFLARFIAJNYNQYHONAOXGFTZSFMTRR9NKLLRVEBAEP99QUBEKCILEAKXHZSWRYYSGNTSQTWFQVHF9LWABOKPDTGTSRHYNWWGJCIPMFCBLETMSBVOGQXTO9TZMIAHHGFWEUMW9WJADFWDLIDEELTIGOO999ARKDQQQURJVISYEOJQKPFSZTIDUOTHOWXVUSXWOGQDJHGPDQXSQZGKHWXXCYLUJYRTRVAWYBTYKURUXSR9CFKSFTTRYITBZLGFPYNEWMAFTBIRKHIPRTMFRPTDZCPGDBLVUOOGHTPDQXXQQHLTSMKYMIWVSNIOI9FLCQTWBIHNCLNVFYYDJXZMDA9TRBFKVKVGOLYPYZBSQBLRGSZNYR9TQSWMJPGPUHNZIUVJXPWHUGLJBLJTPSXABBUBJEFMFMNANKYXVCRVJBBHJXPOUCZCDTJREIFKDJMBGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999THISISATAG99999999999999999EJDWC9999A99999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[3].toString()).to.be.equal("BLAHBLAHBLAHBLAH99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBE99999999999999999999999999BNJSISATAG99999999999999999EJDWC9999999999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with zero balance", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["0"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    5,
                    Trytes.fromString("BLAHBLAHBLAHBLAH"),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const inputs = [
                Input.fromParams(Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD")),
                                 AddressSecurity.medium,
                                 0,
                                 0)
            ];

            try {
                await obj.prepareTransfers(seed, transfers, { inputs});
            } catch (err) {
                chai.expect(err.message).to.contain("Not enough balance");
            }
        });

        it("can prepare transfers with no message or tags", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    5,
                    undefined,
                    undefined
                )
            ];

            const response = await obj.prepareTransfers(seed, transfers);

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXKA9999999999999999999999999999999999999999999999999999EJDWC9999C99999999C99999999MFTGRDELIRHRCHTYIHGOEOCISPIFKIQXCOZDR9AHQZCPIITI9GYTKFNFESNFYLZSYBPKHOXXKJVTDJKQD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("YGGXHATQITGJFXTYXTSZGUNIFJYQQMSBUMCUPUMIVZNKQGPKPPHUW9VUTQRU9PEJFXVVZYHUMAOQKS9KBKDOTGXNTJUURXCEFQIDDAIBYQIODUHKXQTWLXFJDKYXDVSHTIWHNFPTAFVQEAXBARMT9C9VPDEUONA9FWLHEYCNKCUBQVGJAHMAALFR9TAHU9OSEYEZ9RRKCXHILYQOPQZBXQISXTH9MWMYG9XE9ZOLTIUXWDDCTNCOTRKJGMGWUTMGUC9ZLPGBAPOXSAFCQPPBGZE9RAHAHIPSSCTIKQWBMCCNLNZREDIJWYCKXNXVZQCKJEWWDANMZIABNM9RD9PPKPKBGOQBLJEHBTSKYHOFNTCWWREQNGYWSVDBZTZHDWZINVOXNBNRSR9MYZNOKJZPACZPUMOACYDVQMHCYRPIIKDVEJUJXPMRXEISE9MSXMTZBLEFFMZYNJQGRA9VKHGSNMJEPZMBMFLFXZQCXAZWRJCCLVVPJIPUUPXIUACJCCQJETQIVLPPTJLWATXMRXZAXS9ESKLJKAJRJJVEJPBNWGQFWRIFAFDIEPXBXFIITGMLMV9ZYDAZPZ9PHXMYPFDYJOJWUMMLYPJBRVIZVEIOVDYG9UZCLGAMCDVBUKYMZNMZGRUQMYWWFDTOREUCJIVLHFXUIDHXNHDDRBTHIHWLXGQY9GLCZMGAEPRYIUBQXJHMOZDPQDGYSTSR9OWEXQOQLXDKA9XCBGOERGA9OUUTWKHNTSDSLHLSNFNVJHUIXCYJPFVWLOEAYGGGXFVGCZEFSPABCDGYTXHKORBVCDPXECMKM9VPEJYIHHBIFLFVYW99ODZTWXFQUUOIHTXEYKBKCCLCGAVPY9MJNWPUYWLLRPILYMRJM9KDTOCBDLCQPAMVMHREZLKAERFIIOHLMLCQTAAGPNTTQBOZLDQZXUQJQDGZBL9DGJVXGBCDTBPBGBL9QT9FXVRCSCHZREYRLKNHT9EVSEGBFMTTIDZH9YVNSYMJQLH9ELQISAMDHYMW99NWOHPNEDHPTRL9TRMBLDQTYFHWGGNQZVVVAXNENJEYBJBMLWUNCLJHJQBCWWOTSZZQRDMKDZLMHSMYZAWGCYAKIQTULBJUTWTPECEHNHZMDURJHZPRGEMXVXSGBARSBZATGWMNYVHGVSJCFGTIYOFNKOKAVA9RALAKNVIPXQFZKOIAXFCRZTWOUZYP9VDZBEDZFGANU9LMETCZLFCZAFDP9QRUVGDQCVUYFIYEXR9SZZUXPTJRIZAKAXDMXCNAICIQGEWXDCFL9P99WIFZS9LUWRDDXWQVGVSZGMKF9OMHWNVQJNIESMNLHURHKKXILHBAKXY9TVLPLVGRRAB9EHECHKNQSZYFSJHRDWKUFSDQDAPMFYRRDPIPML9QFGPRE9VPXKGXIOOXGNISCZWFOMGXSE9YWGBCHD9WU9PLPIQRPKVWOTSPVDQMPWYVKDVCMGV9KZBPCMTOLIR9HXMFYDYQNWTUXTVUCDFFZRACXITCPWVHTYNFIMTTXTW9VEWTDICFLU9X9SLNLPCERJZHRVQCHLNVRHQZBTNO9QLLNNGRBHDEHNAXCYAJBKDBOGEBUIDJITKHBJROLRPHUPLFHDYCWNCGADTMFVBFKRHKMQPQAHZVARCUQ9XZIS9YWDBHTVRBSBEGRHPODPLKWYMIBURTFKKMNCLJNTBQIHWDCRORGTOAZA9NNKXISDDQEELSLVQ9XHYFDLSNLKWGLTKDJJEVAXBCDKQJLJQVIEUMDTGMNMCZBI9FNDCEHD9YKXJCMKSSYKXZCN9PXYEEUKACXRUVGDLDVZKMKDNDDTCT9TYCYJWMPKJQVROPTCYHLVL9CCMYZLPCWHAYAUHAOH9MJXPBJYYAIUARGHUBVQLICUYRHWPXBONGRRKWYUAPPUO9JFJDPBBWCTINPSTDUUPQUWJZBAHZECJ9YFMQIBLGIWHU9LYL9SZKIFXNEOZ9FNJ9HNDJ9JGWBUIDIWULPOO9GJHMJGJNETGLTTQ9AXMUIRFAD9QXZPYIFQMQQLLUUHAU9MADJVDSYREXFXBBAIJBMYIBTAKDDVLBOXRGRIKQHVZXR9FPDWUDRQGSARRGIZPSXZHKFJMWVHGAJPHLYMWSGD9ST9I9ZSKWVBZXTFQPVHLPYRZHAINNGTXBJ9YUXNPE9URNMBDWXQOKKMDGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999999999999999999999999999999EJDWC9999B99999999C99999999MFTGRDELIRHRCHTYIHGOEOCISPIFKIQXCOZDR9AHQZCPIITI9GYTKFNFESNFYLZSYBPKHOXXKJVTDJKQD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("NJTUZNAHHFRIUGQVMZQUJOHXITWTOAITPDFFKXKSNBOCJBBWZKXIXZUVQIIXNKFFPWYTPIXXHWIVHVSPZNQHAGWUFBRW9QNYQSMRCECTIXDHQBDSLIDYTHRGAJEID9AANMSYVJHRIKJRUEHIDLZWE9QQAPQJWLXYJYTLY9VTBGBVOTDBYGMMRASYDPRTHXEVELJUHYKMLWSFPQGEQEEEFFCEWZBELZQFMYCCERLFYYL9JWRSOTAUKUFVMUHVNGKH9XWYBEZWYPPOYIYVSLI9NPBRWLIOHEPORETXJPNRVDVWGVDKUURRHF9UYSLVZGAHUQYW9RLBGTUJKVKLV9PQYDPFLNZYREVYWMQIWXONHIKYBRLXJLQXJDJUMW9ROW9RASAUJKNDZ9SATYIFHOGBZQWETFOUCOMT9RQJCWVBMYZLUDNCOSSJKWDLRDPEJCVXXGYZYSVBNATHYUUSYBOVQMGUGBZFHGHGXQBNLW9XSXENXYPSLQAGNFGKISBT99XQIRNBYLYAODHIQVVTMVHEK9NWYNMHBJNPD9MV9KGYCJAIAFOD9XRSHVDLKBSXBPGVY9NTCGDPO9HRPUD9GXQPMKH9RJDGMXWOUIPAGZKADZLDITNQX9ECFXZFZQVMAKTQSC9RZYTWHSAOPUMFK9XRW9VFGPJAHQCXDFB9MBDMZCEWIQGMYRKAZQWMEPOTJXBPXHAADKLMDTZHNFEQOLEFIDPCDITBPGSTOGKJRZKNRVVFQFGHUFYNBCXNTZEJJBNGUVOPKJZTDLVSKYGRLOLRTQRCCUIKE9VULXTLVYXKXDEPWZZCKDAWZWUNYLQWY99YKQTUHPOXMMLAIQAXVUPQUZTZSWCXFNRECZXXQNHQMPNXRBPSFLWY9I9HBTZRLC9AR9K9YBERPUINETTBHVWNXLD9SW9LIDCKAHHKXKGPVUFVDMKOXSQPMCK9EOZVAUKP9X9WMFXETIP9UKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBKAULMSKHUIRYICIXDCPRZBWNBYVQUHTQEHTEHIZDCHCQNZXCAEKMBHZEJFWCMHLKYYUNSGOHCTHNILC9XWRKLYILKKETQNEXOFEQFMDOZLYYHWK9YISDSVNZSQODIDLHCEHEEYMYYGWAYXNLPUWUFBOGTSNDTKWPOCAXKJ9WFPAEALEDCBAPMHLSYXAOXPROPXDYNMEZQGASRVUR9Q9YZAKFSEMVHFVEBCXENHVOAKE9XFCYGLYNVHFSKXXIBRJCU9ZGWISYXGOQG9UXZPQXKYRHPRSS9LZTLYQJGNXELC9AOPWSBLJNSJXKPQFNUMFZFZXDJU9XKNTBQELSDMWFD9HEEIIMXRT9NQOGVEOJAQSVV9HZJMMDRUTYLCPIAR9JUXTQCSS9SMVMBKVLSMOKYKWRYLLHRQNOVXFNRMP9AMFJWYDMM9KZWSTSZWO9ISAJTGLTBORBKRYHLLQUELUYQXTOWXSDNGRDBVXDECNMXMZZLQ9TPGNCXLXOFTSFZ9PRQWMRGRULAOCEHWWVUJOQFGVOIWKCNCVZFQT9CQQBPOPTWKMAVHCGOLDFIIGLKXTHTUQGFHXLPCLJBUCDRJQ9NXKYYNHQFJFSKMOVTMJEXDXQYUEMJFAIMYPLJCBCWBKXHGVMBSIWVJOISDBWYNMHMU9QUALCSDKULXDSOCXPUMJCAZQEMQWXBCQZBAHMJCROH9MTUADZNXRAJEDXXJI9UEGYWWVABHXOHOAQKGQLAGCYWAU9JOVNYBTQCFTDGOLKXBAZVSUCCFFYYGQ9VJOASEHJEZPGUEGQAVVOMMQRJBCNRPO9QUDNPPAZVNGUINIPTSS9QRCMW9HWVLVVEVROYWCQECXERQSI9BMWL9NRCGYTTLBH9JVRXH9HDGAWZTLJMI9KT9QQIZSVUHMMGKPRJZ9DDQNZGLAAU9QCFSCJYVPRXDUSQNPKLETGSOKYZZJREDYAVBKIRLLDFLMIFRDCCNXZSQURAFOCBTFVVDVQQEKSBIY9SRYYSBTKRACQ9HIHYYWXRZGSEULUXUPL9ODRNDJFFNQCCJFZOQBYOEXQJHNKDVKSQBAQSOOWVAYZPEKSB9AAMGGCWZYWRP9EM9EC9TDE9KUYTUALZQDIEUBOYYHMBWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999999999999999999999999999999EJDWC9999A99999999C99999999MFTGRDELIRHRCHTYIHGOEOCISPIFKIQXCOZDR9AHQZCPIITI9GYTKFNFESNFYLZSYBPKHOXXKJVTDJKQD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[3].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBE99999999999999999999999999BB9999999999999999999999999EJDWC9999999999999C99999999MFTGRDELIRHRCHTYIHGOEOCISPIFKIQXCOZDR9AHQZCPIITI9GYTKFNFESNFYLZSYBPKHOXXKJVTDJKQD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with multiple balances required", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["1", "43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    5,
                    undefined,
                    undefined
                )
            ];

            const inputs = [
                Input.fromParams(Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD")),
                                 AddressSecurity.medium,
                                 0,
                                 1),
                Input.fromParams(Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICE")),
                                 AddressSecurity.medium,
                                 0,
                                 43)
            ];

            const response = await obj.prepareTransfers(seed, transfers, { inputs });

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXLA9999999999999999999999999999999999999999999999999999EJDWC9999E99999999E99999999UWVUVFP9HEBSDKKPXYBZLGREJFVZUXDYZVLSEVETSHBRKLKVBKLBP9HAALUZPRULZCGAKDZOEQYRICVBY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("YGGXHATQITGJFXTYXTSZGUNIFJYQQMSBUMCUPUMIVZNKQGPKPPHUW9VUTQRU9PEJFXVVZYHUMAOQKS9KBDZI9TLAACPW9ES9VBMXMDO9SJYKIGEDSJLWAKEDLO9GIH9ENWSIUUCQOLRHHPYKFHODIZNPPFWPDCO9KYXEGMLTXFQWFPSXIYJXLVUIPFSCCGCKXSORYILHVVABLZXAQDTHCKDEMWCVWN9HYMZDQACUHECXAAGRBOWOEV9XCCDNVIYVMGYUVLMLCPEE9X9MYBODXBZDGQCOZKFI9EOBQUGA9KECJEQDGULRRELAKQBMADWKQRQBCEHKYN9NEDNXBRQST9UUX9WJJDQFECGODVYSXATNSVMUCZHYRVEZAD9EICQQEDFGYIETXYMMPIDBNBGEBUKLECMLPXXWABGG9KAQUVPHBLPTLHBTGPHMRNVJWKMIMST9GTSKOJBCV9HJNHMEECKEHAKESLXMCHNBGWSGHYTHXGXKLE9PUR9LTUSXIJ9JGJRWMWUHSQHD9PMMZXMHLGIRKYR9LKPNGWYDJZPATEFLJWXOQJZBYQAJ9SSXPQJJUCAFZNXSLMWWPJVLLRNBGOQ9HVNAECPGLCFGMWQP9ZECEW9UECDOYEIWEUVWFL9FYYOAKFMDPDMAECJKERSVEWEXTORGFQVYMIPPMJQBTLKNYLSUH9LIRLYUVM9BVENPBEZMYBUIVIHVYCKYTXMEQYV9WPFZFFTAWCWFLMABGOTKN9INNAQJIQYMBTSZTZNYQYWLDZMTTRMDIDVKZZQALISHQULIAFURWYXHMJRIXBTNOFFJHUQTAWLQTZHVIKUBZBBE9KGTZPUCSYAGRU9GBSNSZNHJQHTMPIPPDKCTILVQ9RBMOPKVEJKLYNYUYWWXWUCEKBRFOWMFH9YXQOGKTLLPTQQFHITRXWRFJWPNIQTQGCZVHXBEJ9VUVREYWZVOBUELVPGTFWRBDQLLBMCERYEMQUBGRHVWOAHFP9IHNLTCUVZLZUPIXILB9DUIPPJYINDNJCRTGRTXFVLVSTIUOZLLNCZE9OWMTRHLQYPKBFOEQPH9AFM9EAEOTCGTZBQZNWMRJZPOMZWKRQJDENEFJEUQHAUMQWVXWGSXFDXYXHVTVY9HKSQJBJALNJ9MGIWBAODJSHOAMM9JU9NPPWLI9WVWCKNFSCNADKJLUHOADXHIKOAEJFIYXQDERXYTQYYUPZNSTPSAOGPIDRZOZXVJZHPROJBJMLRSOENHCGP9GOIXXXHUHJAGQAHMHJWCEXZXIWIZP9NCUYTJDZRDXDLCCNQHJM9QWDATIMXDRNTWEDEGZDOZFIZKTRPDGQGP9JNTPTHXOWOCHOZIVWKJFXPNDVYYPVXJJUFK9ATDBPXKPJ9VGTTCSGNFPZKWUB9FDOXEUPEANC9GFQOY9ZVONCGS9WRGOYYTNRHDICOKDRSUIDZMZOAKHCBNFUARWZEHICJHTDJIIEOVVWDOJIXGEPHZQQWEMBXMOOXYQDQYKUJBHQ9KKKDYIKTCLXLKUOXKGXQHFLWXATSTXKL9PSGIUI9KZPGIWHOH9CTPAEZJWLNUNBSVJNHBVVYLPX9EQQIQOAMWPNMSBJCWQDXWJDDBORRDUGFOXLJUNYZR9TOFTGVMAPPMJTYVYVSOSIJUOR9HYTTLZPJXCKBJROAODHOLGYFNNVWKBYHDGQAIX9QFBRFUDSDWDFMBYSKZZPUWKIMQVU9DPBRFIALLPRCNQUZJQX9MXWEHSTSVVZRDWZALLTOAXEBXQH9IQJCWDAEA9NGZKJXNXCOV9YMQUXISMNOBKUXBEMFHDHTFMUODBZVEPREXEJCVVHTGUJDQP9GRQBYVPXAVVRICRVZIFCFWIELTKDTUPHGNOOKSHNNYZLJBPVXZVTNUNRRJFTMPEDKWSIMXFMSDMVJRSTOSWYVIVZKAJBTOKDLBUFXJQCAAWCGHTTXFMACWABLZ9HQNFZZBOHXMNJMKHDYBQJC9PRTVGLAASG9ACBNVMXIWWJKFUXETKTGMAWYRSHAKWVWGDTXKKANRRYFNAWTD9GN9CQM9QLVYUGTLQNLNYKAYDASBQNGFCLYKPBQWPEKDJBQXJ9MQYWUNLWQFJMNIYZFIEZASANRBKCLHQASIZ9JINUKGYUTPSFSCWL9SACEXZACSSRBXS99FLDREE9YVLKGALRCGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICE999999999999999999999999999999999999999999999999999999EJDWC9999D99999999E99999999UWVUVFP9HEBSDKKPXYBZLGREJFVZUXDYZVLSEVETSHBRKLKVBKLBP9HAALUZPRULZCGAKDZOEQYRICVBY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("NJTUZNAHHFRIUGQVMZQUJOHXITWTOAITPDFFKXKSNBOCJBBWZKXIXZUVQIIXNKFFPWYTPIXXHWIVHVSPZMVPAGDSVFNQQCPPSDOCAGREVIVHWMILXUNBSJSRUUDIAI9ISEGLEFMELIYMZSFFPYXGVTGSEGGHOTUX9ZHXDEUCWQNOQO9RCVRRQ9ZIRNWPVPJSOGCSFQFUNYBDZIKF9AUIJNHZEGAECEYMSGPTQBK9XPTMKEE9VIWJE9OVQCOCPFALNASWOVTISGUCEKNRKNQRZDTHJWKSYDVQ9ZMFEATCAIBFGCYWPQMEMDYKAUVOOWO9KWQXIJFZOISELSDZTEHUBDCXRPQJTNKTV9JDFH9HSTHNWAL9TFVKODXJULPUOAHVZCACZIJZPPFAAHSAGLUYDTYW9VLYFOIKSYFIXWLLJKWHIJHQJTNWAJABKQZYZWGMCABFQUTQVWPRDONAYFQPPFCDZQYRZSZMS9ULX9JUAQDDYVPPEUVXCPVOXIUMAWFKAJVFSABUN9DIE9JHDDKSMKZRYPNUTZPHTFYSENDSPWZQCIVTWVZHOFXPPAYNELOBBLSXPLGDESDWN99ME9MBXMJPFXYUNXOBWTGTMSJUSHQQSO9HV9MRDYRDKFFVH9FWU9IY9OJW9AMYX9XDGZ9PDPPKXCTKQKBUSQFKJODNUGJMPMFN9BRALV9QRMGQDNOCYYS9BPNXVCOJLCDJKYJTVHMQCXKDINXT9OMCLIKQCSCFXTXSFRSYMEKCNSQPRPUWQYLUWNMBZQLHNHRIT9LGCNJBESXDTXFXYGOGDYGUJABTQAYVQGPATUDFYJQXMYHHVB9QC9FRVFELJZGPHAZDNVDHAYGWY9UJ9QDCI9ZEGBUHAKNIKWOUKZCSRIW9WCKUCYEZFKOXXVSUALDPVTASMWNKHSZRNZGOEOULMQVUPWIWIEXQEONRSUWP9PGDCAYMXABYWIUTKWQCGOJRVP9FYQGJYSAHWDCCENWJWKCRNXLQHTTUNVFZDEDOCYKNTOCRHULRDQPFQOIDPSCCDRNIVUNEVGDZXYZULWHRZGXTJK9ZGDGLQUYBVBPVQQQIIAGZYMJEUFK9BXGTMHSUUOVVZLTHTQXRSZFEGRROXYVLQYFEXWKK9LA9XHC9VMKSTBSSU9LHWBIRTZUUBCNGUMYSUUGQLLOEHSRXPESVKKHZEBFWIVMKVHINPYJTMHZPBRXFPHNIXX9KD9NBFSUXQRIAALDCVXJYHCPZNVJLYIFRIODBXPJYDWZZGNKTARGY9TKVS9SGHQVMOLELVDYCEKWYQUBSX9DBRKR9HHPXWQZJBLLJXIIZ9CFXBJJZBIKIGOCBFJYHXPHOXMHFD9TQ9SZGYL9KVMULZHSDADEWTEUFWRSWUBMUQZLVXQXACPRMIPIPUSTHVOJOYGOZASGYJZGDCFYBPMP99O99CIQ9YXXYDVIRSZIWADYTP9CRBLWJZFOHWVEL9KNPJEVEJMNMPHJTHVCOGAKII99SJHLDQQUTSLPEXHD9FTPPVTBZFMZOWICOAPXFKFEWKKMMMFAGTOUWCKKD9RXESVYUDJHCONWOWZGWJMGJKVS9GYTORBDXNGFJSWXBXQYJNGNOFVUTSIR9EEYMKRBFCMIZFGIXDWHECOOYVKRJTBJPYRZXWDGTKEDQJW9VZBJDXU9W9ZIOPSO9FOOWTKJXRSGVDTFMDQFNJRJKBNUYDEQVLYXL9WCNWJHWSFTVT9PUTELIGMEBTXHI9JXJNBDHWTRJXVLQQJBBYDWNXQOQNWGTAWQDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZYFPSKFPIEUAVNHUA9RWXLNJZWEVXGGWCPORCTYJUS9IVWDO9QPHRIYYWHWFUKYGCQVCSVSXMROUMBDXIXPP9YQXJJ9KBQIARODE9HCXNSPDHHDESF9LEOJXSBOQMFAUMAURBJTTZXRVTUBONABFYUHSODRCJCABQKWDBMEJAIQPHOBOQMKECWKERWZKNYNATXMHGVFNWLGFOEDOAOYLDMKQDDVKUSEXVCXLWDZSPEHEPWQZRAJXIOA9ADTYQRAYPLW9CGQRXNXGUDBGNILBIILZHFSISUJBPH9ELSZKFROSY9QUDLTFBANJ9CNUIEUXEJXM9GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICEKY9999999999999999999999999999999999999999999999999999EJDWC9999C99999999E99999999UWVUVFP9HEBSDKKPXYBZLGREJFVZUXDYZVLSEVETSHBRKLKVBKLBP9HAALUZPRULZCGAKDZOEQYRICVBY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[3].toString()).to.be.equal("YGGXHATQITGJFXTYXTSZGUNIFJYQQMSBUMCUPUMIVZNKQGPKPPHUW9VUTQRU9PEJFXVVZYHUMAOQKS9KBDZI9TLAACPW9ES9VBMXMDO9SJYKIGEDSJLWAKEDLO9GIH9ENWSIUUCQOLRHHPYKFHODIZNPPFWPDCO9KYXEGMLTXFQWFPSXIYJXLVUIPFSCCGCKXSORYILHVVABLZXAQDTHCKDEMWCVWN9HYMZDQACUHECXAAGRBOWOEV9XCCDNVIYVMGYUVLMLCPEE9X9MYBODXBZDGQCOZKFI9EOBQUGA9KECJEQDGULRRELAKQBMADWKQRQBCEHKYN9NEDNXBRQST9UUX9WJJDQFECGODVYSXATNSVMUCZHYRVEZAD9EICQQEDFGYIETXYMMPIDBNBGEBUKLECMLPXXWABGG9KAQUVPHBLPTLHBTGPHMRNVJWKMIMST9GTSKOJBCV9HJNHMEECKEHAKESLXMCHNBGWSGHYTHXGXKLE9PUR9LTUSXIJ9JGJRWMWUHSQHD9PMMZXMHLGIRKYR9LKPNGWYDJZPATEFLJWXOQJZBYQAJ9SSXPQJJUCAFZNXSLMWWPJVLLRNBGOQ9HVNAECPGLCFGMWQP9ZECEW9UECDOYEIWEUVWFL9FYYOAKFMDPDMAECJKERSVEWEXTORGFQVYMIPPMJQBTLKNYLSUH9LIRLYUVM9BVENPBEZMYBUIVIHVYCKYTXMEQYV9WPFZFFTAWCWFLMABGOTKN9INNAQJIQYMBTSZTZNYQYWLDZMTTRMDIDVKZZQALISHQULIAFURWYXHMJRIXBTNOFFJHUQTAWLQTZHVIKUBZBBE9KGTZPUCSYAGRU9GBSNSZNHJQHTMPIPPDKCTILVQ9RBMOPKVEJKLYNYUYWWXWUCEKBRFOWMFH9YXQOGKTLLPTQQFHITRXWRFJWPNIQTQGCZVHXBEJ9VUVREYWZVOBUELVPGTFWRBDQLLBMCERYEMQUBGRHVWOAHFP9IHNLTCUVZLZUPIXILB9DUIPPJYINDNJCRTGRTXFVLVSTIUOZLLNCZE9OWMTRHLQYPKBFOEQPH9AFM9EAEOTCGTZBQZNWMRJZPOMZWKRQJDENEFJEUQHAUMQWVXWGSXFDXYXHVTVY9HKSQJBJALNJ9MGIWBAODJSHOAMM9JU9NPPWLI9WVWCKNFSCNADKJLUHOADXHIKOAEJFIYXQDERXYTQYYUPZNSTPSAOGPIDRZOZXVJZHPROJBJMLRSOENHCGP9GOIXXXHUHJAGQAHMHJWCEXZXIWIZP9NCUYTJDZRDXDLCCNQHJM9QWDATIMXDRNTWEDEGZDOZFIZKTRPDGQGP9JNTPTHXOWOCHOZIVWKJFXPNDVYYPVXJJUFK9ATDBPXKPJ9VGTTCSGNFPZKWUB9FDOXEUPEANC9GFQOY9ZVONCGS9WRGOYYTNRHDICOKDRSUIDZMZOAKHCBNFUARWZEHICJHTDJIIEOVVWDOJIXGEPHZQQWEMBXMOOXYQDQYKUJBHQ9KKKDYIKTCLXLKUOXKGXQHFLWXATSTXKL9PSGIUI9KZPGIWHOH9CTPAEZJWLNUNBSVJNHBVVYLPX9EQQIQOAMWPNMSBJCWQDXWJDDBORRDUGFOXLJUNYZR9TOFTGVMAPPMJTYVYVSOSIJUOR9HYTTLZPJXCKBJROAODHOLGYFNNVWKBYHDGQAIX9QFBRFUDSDWDFMBYSKZZPUWKIMQVU9DPBRFIALLPRCNQUZJQX9MXWEHSTSVVZRDWZALLTOAXEBXQH9IQJCWDAEA9NGZKJXNXCOV9YMQUXISMNOBKUXBEMFHDHTFMUODBZVEPREXEJCVVHTGUJDQP9GRQBYVPXAVVRICRVZIFCFWIELTKDTUPHGNOOKSHNNYZLJBPVXZVTNUNRRJFTMPEDKWSIMXFMSDMVJRSTOSWYVIVZKAJBTOKDLBUFXJQCAAWCGHTTXFMACWABLZ9HQNFZZBOHXMNJMKHDYBQJC9PRTVGLAASG9ACBNVMXIWWJKFUXETKTGMAWYRSHAKWVWGDTXKKANRRYFNAWTD9GN9CQM9QLVYUGTLQNLNYKAYDASBQNGFCLYKPBQWPEKDJBQXJ9MQYWUNLWQFJMNIYZFIEZASANRBKCLHQASIZ9JINUKGYUTPSFSCWL9SACEXZACSSRBXS99FLDREE9YVLKGALRCGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999999999999999999999999999999EJDWC9999B99999999E99999999UWVUVFP9HEBSDKKPXYBZLGREJFVZUXDYZVLSEVETSHBRKLKVBKLBP9HAALUZPRULZCGAKDZOEQYRICVBY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[4].toString()).to.be.equal("NJTUZNAHHFRIUGQVMZQUJOHXITWTOAITPDFFKXKSNBOCJBBWZKXIXZUVQIIXNKFFPWYTPIXXHWIVHVSPZMVPAGDSVFNQQCPPSDOCAGREVIVHWMILXUNBSJSRUUDIAI9ISEGLEFMELIYMZSFFPYXGVTGSEGGHOTUX9ZHXDEUCWQNOQO9RCVRRQ9ZIRNWPVPJSOGCSFQFUNYBDZIKF9AUIJNHZEGAECEYMSGPTQBK9XPTMKEE9VIWJE9OVQCOCPFALNASWOVTISGUCEKNRKNQRZDTHJWKSYDVQ9ZMFEATCAIBFGCYWPQMEMDYKAUVOOWO9KWQXIJFZOISELSDZTEHUBDCXRPQJTNKTV9JDFH9HSTHNWAL9TFVKODXJULPUOAHVZCACZIJZPPFAAHSAGLUYDTYW9VLYFOIKSYFIXWLLJKWHIJHQJTNWAJABKQZYZWGMCABFQUTQVWPRDONAYFQPPFCDZQYRZSZMS9ULX9JUAQDDYVPPEUVXCPVOXIUMAWFKAJVFSABUN9DIE9JHDDKSMKZRYPNUTZPHTFYSENDSPWZQCIVTWVZHOFXPPAYNELOBBLSXPLGDESDWN99ME9MBXMJPFXYUNXOBWTGTMSJUSHQQSO9HV9MRDYRDKFFVH9FWU9IY9OJW9AMYX9XDGZ9PDPPKXCTKQKBUSQFKJODNUGJMPMFN9BRALV9QRMGQDNOCYYS9BPNXVCOJLCDJKYJTVHMQCXKDINXT9OMCLIKQCSCFXTXSFRSYMEKCNSQPRPUWQYLUWNMBZQLHNHRIT9LGCNJBESXDTXFXYGOGDYGUJABTQAYVQGPATUDFYJQXMYHHVB9QC9FRVFELJZGPHAZDNVDHAYGWY9UJ9QDCI9ZEGBUHAKNIKWOUKZCSRIW9WCKUCYEZFKOXXVSUALDPVTASMWNKHSZRNZGOEOULMQVUPWIWIEXQEONRSUWP9PGDCAYMXABYWIUTKWQCGOJRVP9FYQGJYSAHWDCCENWJWKCRNXLQHTTUNVFZDEDOCYKNTOCRHULRDQPFQOIDPSCCDRNIVUNEVGDZXYZULWHRZGXTJK9ZGDGLQUYBVBPVQQQIIAGZYMJEUFK9BXGTMHSUUOVVZLTHTQXRSZFEGRROXYVLQYFEXWKK9LA9XHC9VMKSTBSSU9LHWBIRTZUUBCNGUMYSUUGQLLOEHSRXPESVKKHZEBFWIVMKVHINPYJTMHZPBRXFPHNIXX9KD9NBFSUXQRIAALDCVXJYHCPZNVJLYIFRIODBXPJYDWZZGNKTARGY9TKVS9SGHQVMOLELVDYCEKWYQUBSX9DBRKR9HHPXWQZJBLLJXIIZ9CFXBJJZBIKIGOCBFJYHXPHOXMHFD9TQ9SZGYL9KVMULZHSDADEWTEUFWRSWUBMUQZLVXQXACPRMIPIPUSTHVOJOYGOZASGYJZGDCFYBPMP99O99CIQ9YXXYDVIRSZIWADYTP9CRBLWJZFOHWVEL9KNPJEVEJMNMPHJTHVCOGAKII99SJHLDQQUTSLPEXHD9FTPPVTBZFMZOWICOAPXFKFEWKKMMMFAGTOUWCKKD9RXESVYUDJHCONWOWZGWJMGJKVS9GYTORBDXNGFJSWXBXQYJNGNOFVUTSIR9EEYMKRBFCMIZFGIXDWHECOOYVKRJTBJPYRZXWDGTKEDQJW9VZBJDXU9W9ZIOPSO9FOOWTKJXRSGVDTFMDQFNJRJKBNUYDEQVLYXL9WCNWJHWSFTVT9PUTELIGMEBTXHI9JXJNBDHWTRJXVLQQJBBYDWNXQOQNWGTAWQDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZYFPSKFPIEUAVNHUA9RWXLNJZWEVXGGWCPORCTYJUS9IVWDO9QPHRIYYWHWFUKYGCQVCSVSXMROUMBDXIXPP9YQXJJ9KBQIARODE9HCXNSPDHHDESF9LEOJXSBOQMFAUMAURBJTTZXRVTUBONABFYUHSODRCJCABQKWDBMEJAIQPHOBOQMKECWKERWZKNYNATXMHGVFNWLGFOEDOAOYLDMKQDDVKUSEXVCXLWDZSPEHEPWQZRAJXIOA9ADTYQRAYPLW9CGQRXNXGUDBGNILBIILZHFSISUJBPH9ELSZKFROSY9QUDLTFBANJ9CNUIEUXEJXM9GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDZ99999999999999999999999999999999999999999999999999999EJDWC9999A99999999E99999999UWVUVFP9HEBSDKKPXYBZLGREJFVZUXDYZVLSEVETSHBRKLKVBKLBP9HAALUZPRULZCGAKDZOEQYRICVBY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[5].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBE99999999999999999999999999NA9999999999999999999999999EJDWC9999999999999E99999999UWVUVFP9HEBSDKKPXYBZLGREJFVZUXDYZVLSEVETSHBRKLKVBKLBP9HAALUZPRULZCGAKDZOEQYRICVBY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with long message", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    5,
                    Trytes.fromString("A".repeat(5000)),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const response = await obj.prepareTransfers(seed, transfers);

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXKA9999999999999999999999999THISISATAG99999999999999999EJDWC9999E99999999E99999999DPINYID9YHTSOYULKLAJSYVBRZZBZRTKJTSWFHRHINLSRKKUUCUFP9FLHXI9QGPNQLERSPLGBWQKUKEXX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("SVLMSBYOKWSWUXHEWYQCBPLNNJIOTKBPLTWOJJJRSUCRAKKNAGUQNXXQPMDFDKZ9NCLVXTWEMLIL9F999IPEXGJWRIIRFFDNGYEANKMXXKILVSLSNOOWMEBISVIEW9UXGQ9T9UJNMA9LTGISLWYMCCUBXAFAXUSN99EJKGPHHXBVCLMOZTX9BUKDQVZASISPBLWCNHXHTIMYA9MTKCWDEKRMDOGOSQLWSHIUUZHZKXBUQZICOBDHKMPWYEQBPQZZJHVZFGGYSMZFXOXSWKXQVYETGIJJAAWBERC9OLKT9J9DTCMDRAAPSBREHIUU9YWKXQAWFDEZTXBXFDVURZJGULGJ9AOPVBPYNTMQHMFLDLYJFVNQE9GAMFLVCORYEHAKPKGNNEJXHYESNBYDBFENYSHFWQDTBXPYFYSTAYNCLJSGWOTMFLVLYDRZU9RUTFIXQCO9HFHLVQFPL9OTKZ9MEMDHSYIITCBSJUTVECSTTJBJZN9MOFFXGPEWJFCHDGSTXCTOEELDTTMCYCIYDGOOOUODYMWKCCUXYPBNCYBTCGYMOZZERVBIECXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZFQU9NOBVKOZEZRENCWAFHMTKLXHFVPYBKWNBLPHGLDRNKXVYDM9WXGQBB9MPA9CJFNVSFQNYB9QW9TRAZIKFCAAEDDMAGKDQWWDAWBLXTRRFR9JKWCMJ9MEFAULEHKFGQZCRYWBQSMMSANFVRAZOCYTOGSOSVMOGJZQJIBVFJSBADFOYYQDBSRZNDELTUOQULHUDVVDRSULBV9GIMUHPUAETCBOZZAZCDADXM9QUEZTCLTCBDSXUVVKCDGWHZYKVKTZXYKJUAEDVNGENJWX9XRTYTZUWSXT9ZIRYKHDWIARPSDPTZLQOLWJ9YHIKHMYGBMTWREYRLKNHT9EVSEGBFMTTIDZH9YVNSYMJQLH9ELQISAMDHYMW99NWOHPNEDHPTRL9TRMBLDQTYFHWGGNQZLAOLAICJWQKMNXTMQZVRPRBKHPQESY9LNEFIXYWYSRTVFUFHRNLYOP9LWIYXSRAKYDDXVLKTQUYMHVSOXENEQETZTCYULDAGXZQUHZMJSGGNOVBCLICAAEFF9RGCH9IZFLOIHSPM9DCVKYVUQWULHMUCSJMIRJELRCVZFRWAQZNVHZHCTWABBQDWXSPSMKIKKDAUWMVDHJQDJLFJVXITCVCCHP9SRBERCOMFFBAGPJNDPECJSKAQBDEKQSWSJZHGNRTWRGATEYRTIXCWDCGF9BKN9BTNANPDWESUBRISQAZQJURZIRJUHFDOTSGJYTLQTXBCCBGAEQHOLNBEBCZPWQXEY9KVITUINKOINNWYHWKVFKKQLCQERUSKESGAWLELHNJMGW9OQNPJLETNLAHYZVFQVJVSFGVAEHUXMRUKULVBXBJXRTZACDQZKTLB9TZPDCFLLBSHXGKJXCTCTGOGFUKXINQWMNKVGLTYHCXATSTXKL9PSGIUI9KZPGIWHOH9CTPAEZJWLNUNBSVJNHBVVYLPX9EQQIQOAMWPNMSBJCWQDXWJDDBORRDO9TYXNIBTHMFTPKJHW9XCUZVKFITI9UW9LBJ9UXE9FGIUBHHTFUQQBVRBWIKMVITRNSTCDBRRJYZ9KSTCOULLMFXUYEEJFGSMVFS9XVLPDCRPTML9EAGIXFALNAKCKRSSIDLF9M9AKCEIDCJEXSOOBYSVWRMAZVCEBRLMPVH9Y9UQMQHSZXGUJZVVGSBEXWOGBZKQAZDJVF9G9JNKPJYGMMRTWOEQHYPQGUODCDVYJKRIHH9KLXWTOTYKSSUBVXUIMPLDJXYAYQITTZDHOVNTSIKPFLPAOVZZEPMLLZUHUYXECXDQZQXHPNAZCNDXCYHMODYN9UC9MGHEKD9WLRKHZZZZJRNNTLFUCGZWSOMYUHQHUDIKUSQBCFYKTDNU9WNKKWD9XVSWGYASRYISLCU9WYRSHAKWVWGDTXKKANRRYFNAWTD9GN9CQM9QLVYUGTLQNLNYKAYDASBQNGFCLYKPBQWPEKDJBQXJ9MQYWUNLWQFJMNIYZFIEZASANRBKCLHQASIZ9JINUKGYUTPSFSCWL9SACEXZACSSRBXS99FLDREE9YVLKGALRCGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999THISISATAG99999999999999999EJDWC9999D99999999E99999999DPINYID9YHTSOYULKLAJSYVBRZZBZRTKJTSWFHRHINLSRKKUUCUFP9FLHXI9QGPNQLERSPLGBWQKUKEXX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("UCWXXFV9NHFODEUTBHXRMMCMYKYQHETNBWJBJ9QVAAZHBIIYLKDBXRRSOEEP9MHHDDWZZBHEFPUPXEWHCYVYKRQWEMHTKXWUYCKWTVGWFK9TAWFBDOCYJKYPPSSGIXU9STYPFJCTGBTTMZBEAXFACFNYOGGKDHMMVWVKREMESDZNPHOZKEIKHTDVCVWKWGRCVEHKJNMONOFFNF9VUUMLPDJYDZLHMVSLMLHAEUJGQXXUVIGVUIWNYM9K9MQD9QERVSSHCEOQCSNEQJNATRWGOCEBDSFPMKRUTVTFLHYEARDDPWRXIJXLCOBHJIEH9GAPIOT9DODVATMROKNNDQOZSL9DGORLRXQNWYJWBVOGOWHUJ9BNDXKHNUDYHTPQLXOHKZYSVVMYWPDDYSUBZSO9CFMSLOBFKLMGAEMOHNJT9AFIDK9QAKGWHOPCQUPDTSCZHNTXEPGYTEGHAXLVV9NLCRWDFEZFYJQQUZGWZBALIC9LNTADFUJHGJBNLLFY9XDLSWOCOFNBBDLRLXWIRGVOAXWUTIYSCMZACGKZNYYGZCOPENZVMGYEFXDPPAYNELOBBLSXPLGDESDWN99ME9MBXMJPFXYUNXOBWTGTMSJUSHQQSO9HV9MRDYRDKFFVH9FWU9IY9OJWYZWUPO9PAXWOHGJDXKPHRQUPSVQPLPHKJAVFTVJP9CGHEIBWLZALGGETINJEFRVEUKCOYSDWTARFJSMAWITBJ9ILUGQUZ9ZSJNWVACPVTPIXXDOLIPWQAKASVNTTKK9JYVJAWOLNHTKAGYRCDOIPQEICWSCPZNYWRDFWCVQEPJGVGCNWWANKKNYAOGCVP9NSLQMBSM9HREIDJZSNBSKFZAFPOEVLGEFAFMSIWPGZHUQIJVCZHGY9WCKUCYEZFKOXXVSUALDPVTASMWNKHSZRNZGOEOULMQVUPWIWIEXQEONRSUWP9PGDCAYMXABYWIUTKWQCGYINFYRQICOVCJYJMUMXELMNDTDKQIQPPDNKWKZO9ZKELRVGHGHRMDLHZGKMYMXTMHIAOJOSXVIYFFHNXWLRHNNJGTVEBXNPDZOVWGUAUTHZWNJAUTHSLSLPZOGOUQIFVIUBS9AQPEDMZLZIXUX9WYRSFPBEPZKHL9LRFMLWOZEEZOWGAHTSRYIQJSVIKOWLTQBIEOX9FJKHFAJVENBWWBAYGNDL9NYOPMCTCDUYUUXHLXCMVVCWQTTCIBUNETBRUNSUM9FAGS9PQIBGG9IAWSSPXUXTPKEJEJPVLMLCXPEPLRELBF9HECQIAARSKVODEXAYRCC9SI9FQDVTFPXEJR9NPNPEC9YKEOALC9JMJRCFWKHLJ9RSRBGSZBUBLYDFPLWK9XIAXKZLNXX9FONQDBQYWUKVCMIJPBLQOJFUDVXDFYBZPJXDIRHSCXLGDKSGYSK9JNNVZIIZUQMZZXHJPZHLI9DV9BZDLGTAA9ZVYIFKEVWGVOZTPMFILNDRQVTAPHMRTDIJLKTWPJGURIPOSSKYTFVTAHNHBOBCPR9O9XUCRHQBOCFREOW9DFRAFSPTPSXVWW9YYNOPNAUYADYYSYWAXFZWTHVGQPFSXPWXHPURROGCKSKNUQEBCPQVHOVUXKYF9SYASRAHYKZRJZVNQBTRWOJLGOVZCAYZQSJIDDIYQWNVMYKVFFLDPJEBERNFXU9XHQCUOGHUOQQYQFCH9MOCDCRJTEYIOPCOPFCTFOXQQKUSMFHKXZL9AKUMOJIKFVXBWBNJOCZSFHYPHNOLEIYKFEEEUBSLG9WIYFSTMWEZYTBTTOKMQVLJXUAXCRTZLRQTEQDEDYSMPFNTQNAKOGOO9FIQSPDYCZMSXNUZPFOXRDCJBL9FEGGP9TXJMCHYGYPJOBGFOYEXJJIQDYGTQVXI9SSGIJLZKVISPWSZWLRJADOPWTGIOYIUA9JFJTMSYTITPPLDXMKWCVPNUWVZEKKZVFTCRXZQAMDGBZEOVTQYZUKXNGUDOEWYJXWPVDIBEIHKIBTSHQL9R9WZVMOBJFNZ9FHDABVUQUZQIDA9WP9LLLNSZWBEYKJDVXWIVB9NYIPDMLRIHXHGVYEBEKTDMI9LTTPXYXFJCWOEIMZJAMAVJDNYR9TQSWMJPGPUHNZIUVJXPWHUGLJBLJTPSXABBUBJEFMFMNANKYXVCRVJBBHJXPOUCZCDTJREIFKDJMBGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999THISISATAG99999999999999999EJDWC9999C99999999E99999999DPINYID9YHTSOYULKLAJSYVBRZZBZRTKJTSWFHRHINLSRKKUUCUFP9FLHXI9QGPNQLERSPLGBWQKUKEXX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[3].toString()).to.be.equal("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGB999999999999999999999999999THISISATAG99999999999999999EJDWC9999B99999999E99999999DPINYID9YHTSOYULKLAJSYVBRZZBZRTKJTSWFHRHINLSRKKUUCUFP9FLHXI9QGPNQLERSPLGBWQKUKEXX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[4].toString()).to.be.equal("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGB999999999999999999999999999THISISATAG99999999999999999EJDWC9999A99999999E99999999DPINYID9YHTSOYULKLAJSYVBRZZBZRTKJTSWFHRHINLSRKKUUCUFP9FLHXI9QGPNQLERSPLGBWQKUKEXX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[5].toString()).to.be.equal("AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBE99999999999999999999999999MJISISATAG99999999999999999EJDWC9999999999999E99999999DPINYID9YHTSOYULKLAJSYVBRZZBZRTKJTSWFHRHINLSRKKUUCUFP9FLHXI9QGPNQLERSPLGBWQKUKEXX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const inputs = [
                Input.fromParams(Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD")),
                                 AddressSecurity.medium,
                                 0,
                                 43)
            ];

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    5,
                    Trytes.fromString("BLAHBLAHBLAHBLAH"),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const response = await obj.prepareTransfers(seed, transfers, { inputs });

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXKA9999999999999999999999999THISISATAG99999999999999999EJDWC9999C99999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("YGGXHATQITGJFXTYXTSZGUNIFJYQQMSBUMCUPUMIVZNKQGPKPPHUW9VUTQRU9PEJFXVVZYHUMAOQKS9KBMUTHGZVBDN9ZXDSXDKRPFWTTQSEXCZJVKOOITJVVMGTNINPIYVJWAFYAYTMWN9VIAWVHMABAUQFMFTXQWTSUBS99ILK9EDCVIFJXBSUWCHUQTMQLHFWCSYRKPPTCDKGKXG9AIH9HVIAPOFOVFGZPDQGPA9AWVYGPIWGHDMAAUDAQPSEXQAANRWLYSKVWGNWMWQUVMGFVCXNYPTXLFCB9MEQUOHACNUOZVKSWMDIC9VJKGCMNLZ9XJS9VAUXFLJUMDMPGLOIPANXIHNVUFZESIJNVBEVGBYGWYLNX9GMQXHCIMBWIFWUZVHWMP9TPBMCFK9VCIHPXDPJSVHOWF9FZKETGHUAIRJQZMJIDLHKZTGLTRQXSUXEEXEKVMPZLATCCMNDYPDQBWUDFTXFRRBS9AEGTIKFZAFQKGVKLLANESPDXUUMEUM9IMPQVUUKGJYMFDVUEFFUXHTJE9TPIBXOFHHMTGJRBSUX9LBPFXXJ9SSXPQJJUCAFZNXSLMWWPJVLLRNBGOQ9HVNAECPGLCFGMWQP9ZECEW9UECDOYEIWEUVWFL9FYYOAKFMDDYTOTEASTMZA9FYLB9HPZWVFSHYOOWTQ9LKZSDTPCRGRHOYAFBNSWISXFVNYHOEDZGSRPQTTMZBDWUVCWXUSJOTRGZRCZGYWJCDTYMFHGWYBQXNDMIEQ9HNSWV9RBFGUNRKCUNDRAAVVBJQWUGFWAUNGJP9TODLGZDXTHRIJBJOTGQMGPOZKK9KDYLRYHIXWOCFOIWOUUDPOJPFFDNQVCSMAXPNLPUEDOZKEHZMTRLHEAOJRSSDUVVKCDGWHZYKVKTZXYKJUAEDVNGENJWX9XRTYTZUWSXT9ZIRYKHDWIARPSDPTZLQOLWJ9YHIKHMYGBMTWZJUJJQPOXZJQTVQGUHSIXVUAISNVAFUTLYAS9ISMMYD9LLTJTJNYGZSTFUYJKNQDVSWKIMCFFYSFXKEV9GYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZTOALYKXTXTTILGBRGMHC99GZHHCRIT9KGUJYJLSSUMRFSOXLCTRAFUPEJSDWSOHYJQBPVAOZBLAVGCOBDVGNKPJKLAWMHWS9AVKWMXDEZCYPMNFXQPHTXNAYUNXF9MTGSAXYWMQFBFAXXIVISHEEVVBHPDLLGCRNEWTMTC9CUWKXDXBEULDPJPZUESC9BZVPILKVFZVFUNWODKPKYJ9BR9RSRDQPNGMIKFRALTLFNJETRYROCTBVCFXLNDPVETVJHJTQYES9IPDQCJLMCQXPXLEIKTIAVERSXMYGGHTCPJBVTTIUWIAWKCLIFKCEIEGVTPSZYETSCQLVTLIJHDNXVDTTLLMLZFJ9CAKEFIKSYESOZ9TJEHTJLTPHQV9TAFDXSSHRZCYKPOZ9VXKZBJXWZWWWHKLOUP9CEOZXDVRPHMLFJQOUIOJSBZMRNGMMPRVFUKWXBQBAVVFRAIWMNWVMUKYSVA9IBPHOCCMOBDYSTYZSFTZTTYOWCTJMVYUAFE9JWKEPCBNTOMIJYVYKLYHVFLVJBVGLRJIGMBSK9HVGNCUNHMQMOEGAWZZRORGTOAZA9NNKXISDDQEELSLVQ9XHYFDLSNLKWGLTKDJJEVAXBCDKQJLJQVIEUMDTGMNMCZBI9FNDCEHDJJWQDWKFGMUEMUTDQPUHLLEQXQRQAWXRHDDPYHXBTYCUEHEVJSVXGWPGIXPJWBYWJOVKDXSNF9WQKHKA9X9CHOTSWNWIAAYQUTXVTMEPDJHX9ZMURDOQCC9RNYQKQYMUSJLWPHQNPXYWUGLBTAHFBVGHVSJSTBXQVBN9UC9MGHEKD9WLRKHZZZZJRNNTLFUCGZWSOMYUHQHUDIKUSQBCFYKTDNU9WNKKWD9XVSWGYASRYISLCU9HXKODOLSQZYUA9AMJRUZCFYKDHKQJWNWPWPNLYDUNOKWHTJDCYASUTFJWOPZNUYEBAN9YWWCVNNEZE9ZW9RCGPDFAKXRRCNBTMOQDARIVZRMLNJ9OXCGWRHYSGIIVZQRAKLVQEPHJWFCD9BAIOZGGEHKWPEEFXZOGYGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999THISISATAG99999999999999999EJDWC9999B99999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("NJTUZNAHHFRIUGQVMZQUJOHXITWTOAITPDFFKXKSNBOCJBBWZKXIXZUVQIIXNKFFPWYTPIXXHWIVHVSPZOBXRQCSKWOJPYFTBWZCFALTXWDNJZOFNTHBLUOAKIQJRODDJYMEKTKGBCUQZAMLQ9CQEFKFJYSHILDBTAVWSWATHRJDZMZRBKMSOYQGNRWOQRMU9FI9ZCJZUTUICBZFHUIIMAGNHK9TLCVXCYEKJZAYTUBGBRWOOZZLLTQAAERF9VTESVQKHQPSRQXUXLYMOTAXOUB9VWPHLQRJZXHTZDUGORJXYXGFZWVTFZMDJNTNG9EZIMRXSEXOFCABWOZN9RKVYF9KCKV9WIGL9ZSWYWOPJOLUKZUNJBMAKPMPBGGYZYLEFPXEBOUYBCTUQUZXOOIYXKBKIAKVRKLJZMRVMWJXJNPAOCJYISAJVZKVQDTFOJHUJDJGDBJNXTDERIVTNHUCULTPJAY9WNWKSSEYD9EFRUTTRDIIBDCQMWVZYSPRRRZGKANSJOIQNKPHQLAYW9BGUNRGUXKYVKIWDOMUBHBNWCEVNVRPTZMKXPXARKHUHBHNGOPEMDDJDWHHSAXJVWZJUQC9JVWHUOFQXVVLKUGBYMVECOQYWVIQTVLMVSZAIITHJFOIUSBBPKVFTHQFYGOMMDLHJVCFXNUKRHQOQWAONCPGPXIZUICISJRNTMTJW9FWJWWRMFCGCQSPLWHDURRKZEEG9SGYOMIWLIJ9NOQD9WFHWAJV9SK9YIQLQVTWITKXARWDMEBXLHDLW9TNMCA9ZKTTVYWNNQ9ZIVRHLVSEVCTLZFQGLAX9DFJXPDT9DPBWYGODIRVPQMZYGNCUJDTFQOZNHSESILGVTYQU9BWEQDVQTXIACJYIZACTGXWXFKNWUUJJCQWLSBDVHWT9DLYMXLHGPJDXRSEM9WFPNPZZBZPXXUKRBEVNXQYOS9NGJKDZSEXWQOUUILFDPBQIPRLMVISKZBRWCTMXSDOYHXYNJA9WMMMVQDWEPJVLDHXOGHBMWBAFFFVERYDKUHDPHFEVPPXWSHY9ZAVCXWUKKGNMHS9SKDDDPFAMALSILASFB9CLHZBRD9LBFFTTQTDSTCLKNKIUKRQQMOIVLEZHUBSNEXU9NAZLOYV9WUXM9YYZSJXUGAWGSBNDDSPIXHBRCZX9FXSWQDVPGAKLHWAWKUUMLLSQFNCHHIRCSPMPFSQETVWQUHFVOY9BPGYOUMU9A9KFZVPCNGHXKLQUFJAFGJPUXAIJZENLM9OONPBYNJVQQ99YUIZCDOKPB9JLLFE9EFGC9WHC9BXXONEZMBMXDDLOKNBTSMIAGXIRLRRSJBGCCKRSNUHKJXO9SY9JIXWW9WPXFRLMVFVJITQEAOBXRAIOCXTSODXFRYUZIVMNDZOPOXMTDPWZEDPXUMOSEYLZZZK9LTVAHAIYLPLVAPMVHEV9PSUVQOUTQ9LKWHBYWMPLKGQELSBCWSWQLVITY9HB9Q9AUCULQSB9EFTVZNRPRTRZFQTBVNLAYBUEITRPRJDKSTI9TRBVZEADHLYJEOCZPCTGPJFJUJ9VJMZTZJ9LSLZUZKLRPIYPLSWAQPSF99EJAYWKZL9BZEDDJSZRGK9EKSKCWXMTLIWKUI9HXYWOTICQEJMLVUAITJPTEABKN9UUOWUIXOVKCDSBMM9JZ9UXESZFW9OHL9XZHUDOKMAYYXMQMPPWHEKOYFJXOEKFTFED9L9ORNFYNOXYLWSWHHLXFLARFIAJNYNQYHONAOXGFTZSFMTRR9NKLLRVEBAEP99QUBEKCILEAKXHZSWRYYSGNTSQTWFQVHF9LWABOKPDTGTSRHYNWWGJCIPMFCBLETMSBVOGQXTO9TZMIAHHGFWEUMW9WJADFWDLIDEELTIGOO999ARKDQQQURJVISYEOJQKPFSZTIDUOTHOWXVUSXWOGQDJHGPDQXSQZGKHWXXCYLUJYRTRVAWYBTYKURUXSR9CFKSFTTRYITBZLGFPYNEWMAFTBIRKHIPRTMFRPTDZCPGDBLVUOOGHTPDQXXQQHLTSMKYMIWVSNIOI9FLCQTWBIHNCLNVFYYDJXZMDA9TRBFKVKVGOLYPYZBSQBLRGSZNYR9TQSWMJPGPUHNZIUVJXPWHUGLJBLJTPSXABBUBJEFMFMNANKYXVCRVJBBHJXPOUCZCDTJREIFKDJMBGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999THISISATAG99999999999999999EJDWC9999A99999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[3].toString()).to.be.equal("BLAHBLAHBLAHBLAH99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBE99999999999999999999999999BNJSISATAG99999999999999999EJDWC9999999999999C99999999XBJWKALTWCWWKDEDBBWHZXLQKRZVZJLFLFLQZJRBBSXDOEPX9QSFWLVCDODGRIAYL9FRCSKRQJHUDHPIC999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with zero balance required", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    0,
                    Trytes.fromString("BLAHBLAHBLAHBLAH"),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const response = await obj.prepareTransfers(seed, transfers);

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("BLAHBLAHBLAHBLAH99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGB999999999999999999999999999NMISISATAG99999999999999999EJDWC9999999999999999999999VPJKKEGZHZXJWTXG9ZRNZGOZETNW9FKGBDSYOPHQFZCBBEDXCJKPAQAEODXNEGGDLGAONDSJAUJHUQAOX999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with zero balance required and long message", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    0,
                    Trytes.fromString("BLAHBLAHBLAHBLAH".repeat(200)),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const response = await obj.prepareTransfers(seed, transfers);

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("HBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAH9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGB999999999999999999999999999THISISATAG99999999999999999EJDWC9999A99999999A99999999SHXACCAOSFDADL9UPQDTIIKPVQAYSPPQLNJKLYSJZBXELFQKEHRIGIVLAYE9CVHBHTVVSBQFADRUSEWLA999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("BLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAHBLAYWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGB999999999999999999999999999WJISISATAG99999999999999999EJDWC9999999999999A99999999SHXACCAOSFDADL9UPQDTIIKPVQAYSPPQLNJKLYSJZBXELFQKEHRIGIVLAYE9CVHBHTVVSBQFADRUSEWLA999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with remainder and remainder address", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    1,
                    Trytes.fromString("BLAHBLAHBLAHBLAH"),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const inputs = [
                Input.fromParams(Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD")),
                                 AddressSecurity.medium,
                                 0,
                                 43)
            ];

            const response = await obj.prepareTransfers(seed, transfers, {
                    inputs,
                    remainderAddress: Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPIAA"))
                });

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPIAAOB9999999999999999999999999THISISATAG99999999999999999EJDWC9999C99999999C99999999NTXHXNNAXJLSGGJXWVNYGEYDNLDXYZGKHZRRNHXWIQYVFRNGIEZRHBTUPOA9GBTVUVBCFFSBIKJJFDCVD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("IERBRJDZBQUXTOTQDNUEBVDVOHWEXIWPBII9XMPHPEUHTXMOMOTMQXOXCSOGPRRSIXKYDZFAMDAUKPY9CYEEXIDTMSPUKTTWYKUZXBXTVYEZAWFJOHLH9ZSEXGGFVBAVAO9FZCAVLVTWQ9SLLDKWGYYHLVBAYEXCVDYHXBQQKKQVIMDOFNPIG9SBKMZGXQLMFPYWCCKPHCQOUILHZ9WYOQTTNSUYLPDTIT9DXMAZTCNLWIDQHEWTDDOKLJA9BQKIDGUUMSZTFHHCKZYOYYRUBPNMIVRPBLEGKGEMDTJRHZBHHVBIIT9YJNLAFILSWFRPDPODFDEZTXBXFDVURZJGULGJ9AOPVBPYNTMQHMFLDLYJFVNQE9GAMFLVCORYEHAKPKGNNEJXHYESNBYDBFENYXPTLHODQNYDHQSUORCPFXCVRJZLVVLNXDHVDDXBCCMBOFIDKHABYYPEMZRQWIYVVUQZXCKDCCBIAEUFUXJS9TAEPTPLPKNKJMA9KOBCEEQSESDQSIHZJLXINZIXITKPJHKNHIWUMHNLXYL9TXFHQJJAPHXHKDNTOX9LREYIYUABOXGJVVIWDDFLIPKUQJCVPXWJLWVPCRUIGSJXQJKGRCHSXRCMTHUWFXBRLKYOAFKTSKTQQALDOLGLYOEMAKHDQTJMYRQQZPEKIWOVGTGSH9LGLUMTDQOGGEBYSDKNTZYRJQ9BVGCEJRNFWYQDJRIYHYWFWPXLCCMCUSHPG9Q9WXLNOHNLCIEFJGUQXJKNIEYCHG9QOVPZDKIGJPL9QWCIGEYDYTPAKEGHVXZR9WLEIDQJIBVFJSBADFOYYQDBSRZNDELTUOQULHUDVVDRSULBV9GIMUHPUAETCBOZZAZCDADXM9QUEZTCLTCBDSXCCCCVCQ9QNUIZYEONABOJZXMEWYCYKPQRCQDAAVPFATXUTXJYNSYDAXZW9HSKFZR9JHJYNBRRYBT9A99XEFDNW9VDEFPQBJTPHXMKPSDDE9MBSWLVPRWWQFHUBPROOZWKAUSEVMSWHFGMVKXK9AF9SEJVWQWKSVGMBLAOLAICJWQKMNXTMQZVRPRBKHPQESY9LNEFIXYWYSRTVFUFHRNLYOP9LWIYXSRAKYDDXVLKTQUYMHVSOXHQHHISIOLOWHGIZF9MEVYPDKOFMEXFRCRZPRI9VEHTJACBSNG9KYXFXUQYVRRJZHXV9GHWDCQKWCEXPJYFVCUWKCJQMQTRQK9XZXBJ9ORZMKUAGOLOOJBZIKTEIKRRMUUFIGXIBOFZSGXXKXPIKQHLJADDVLGPCONDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZTIEDHNOXHKED9WDNVFPZQLZLOBLSEREHG9V9SOEEPDWSXPHJNBUVPTJKYQYBLIUCXRRG9T9IWTLCORSKZYWAQXRYYUMPHMZXKLKPHCVDTBQTFFLKFAXGNMMTUX9ZRRROXIMDXKLVGHORHKP9DGXEFMELSVDLSBFFDYRBCFFQQSMSLTMLUXFYVQWTCHCUTIMC9EWCPEGKPHX9EHNQRZXXTYTCGUBFQPZZFTJASKOAWRIADMYUNADCBCPVLEHDZFDITTOCSBNNORWTOLYBCSTDOOPXVWYKJFUSPLPFKNOOZIEXI9EAYSJIEROAYTINRNVDKDJDTQLHCEZXBUWTUERUIFPVGTQKLVTFGLR9PXFFF9PYUTTUOZINOYGVKCBATAQVVRGSLLOWRKUUSCOIVUZTXPXTCGZWRMTA9DJYDMBWQGRVRYY9YEAEKBRFJZGPTFRRYCLGXFMJQCNFYFEYBE9RLFSHNXBODORCXQXXZXAJGUBSOFGPOFOAUWIIGQXZMLNVUPFVHYPNJXBEIKTIMUVGBTQQZMMYLGJJWRTIQENDEDQPKONXUXIWR9WKSLWTFYJXXJBUKXPQOHQXLOKRDMKPCEMBFWYNFPZKBMRRBEQRTCORIAAJFMIMFWJMLVBQKTFNJQSQIPJWUGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXHXPDGRPR9MITKLWQTGVGIZSVXBFAZLUSLHCVAYELCHKDVSATLKVDSB9TKDCYPBDUKWTCLFAQU9ZFKN9LAGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999THISISATAG99999999999999999EJDWC9999B99999999C99999999NTXHXNNAXJLSGGJXWVNYGEYDNLDXYZGKHZRRNHXWIQYVFRNGIEZRHBTUPOA9GBTVUVBCFFSBIKJJFDCVD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKYNQHAGWUFBRW9QNYQSMRCECTIXDHQBDSLIDYTHRGAJEID9AANMSYVJHRIKJRUEHIDLZWE9QQAPQJWLXYJYEEOTCIQISJHQXQGQC9RVUINRHDZVF9HBCF9BNY9XLMYJFXNJYVCPCYMKKSZXWBNTXQNWKBFYHBGAQMCV9WSQEGZQFRVXZZTFJE9RBORCIIWISNGFFVRXLQHXKRRPLRAPRKHQQBTZHGX9HXBUGMUZMAUVCDNBUFHHEBQQXEAHYLEQPYZGWODQOUIHKQKHKVPUNCVKSRNFXKACKLMJLJKECZFBICMUJNLQWLVRAT9HQJXDQGUJBUYSPGLZWZEODQTKXKOD9ASAOVACAVOQACOFPJRMTHECEYPWLBXSYCWBVKDGCAFCEW9G9XTDWWA9C9UPRFPZFJXKNGRCRICYERXD9FINWTPQXGDBNCUWK9ODE9TZGMUGSUFXN9VXARTXSQCRTBEB9XIPNAULCEQRV9PP9IHGTDEAOJGYBPQBVVRLEIDMTWRFMIAPDVUZFL9KJQTQKJXOQACCAESXO9IMCJUJWKJNIRFUXTB9QELGQWURBTOKUKAMLRCAEXADI9WBBWYSLSQUMPMMYVBFVKNKYQIYKQGWGJEFMJAPZZKNVPNYPEBTJVRJPAFSVQYJEKZYPXQUPQPRYJMCAYKUKKFCCMI9NBHGPJCZRHQSYSIIW99JLSFMLMGT9IJQKAVVBATZZSUWBDPUYTA9NB99HDUUI9RLFTORZGQQGNKGUWFCLBTMFPLSCDNQJESWHVXNGSRLEBSCJQTJWPXROUQO9XTGVWLDIIUHY9WCKUCYEZFKOXXVSUALDPVTASMWNKHSZRNZGOEOULMQVUPWIWIEXQEONRSUWP9PGDCAYMXABYWIUTKWQCRLR9FZLKNVYOEJHCLAYECDWR9PCYFTCS9HUYLMZFDKGYJXSG9AEJVKECRDGLUZQHMLJHCZQKIE9RHCTPXNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYFQSXFDMYIDUYITFXSHDZIZAHEARCATPZJFTOYNPPUJVGRCPNWPOQWUKJAKBHD9EKVBMJXRRLURPOPTLUYCSRSLDJYJOVDXNDNUBJCBMTRUIHFINESCB9RLOGUAVDJCXLCTYJPDH9FNKXDYWHYBGMCLEXCUDXHRSXXWVGVPRDBOWF9TZAXBZYFYWYWYLMCBB9KLPWPGWAUXFXGKYGXITIEPRNCELGID9AXQFCKAV9SDFWXVLQQXXACLAEDRDGCZAOYYZ9XLLBRVTANHZYSHCCROPOYFHTLJJTFRZ9EFFUXJC99O9WHSEEKKBZDNWKX9AVXLMZUDZGDFRZK9PLJNRGQIFQMTUSUMZO99SEIFMF9QWJOHIQHMBXUFNPLJTKTZINOMBNSUPFYFXQZ9JCTIUHBUPJJTHTWQASJE9KQBMF9XPAAUKP9PZHCZBETLTPGOTIQUUSCLFNUQHLBUQVWCPXOCWNIQC9XSK9JKAEGZQXRA9OBCVWAFXWXG9J9V9ZBBHLIBXOVOPSZBBZ9NFSAOOVXU9JTZPHBTNVZEXP9BIVMZEJZNSGAQQFREDFNISGQ9IVGVGTFWKGRYISIGDNVGQKRHOOQCBGD9GNFKILMASGTDSAYYFATT9JFCIRKLJYRYOTOQMAUXTBDRFOW9UTHKQLSUKHCDEQDVG9PV9KKAYMEJKOPNAEUVCNLGRLWEQDRIPKPTMUKFP9EOORSKZBBJLILPAU9BZHBAYXAHFMJZDDFAUYAF9YLDP9CVIMNLLBSPHDKPGVAIPMVOWADLKVFQDEFVYRYOTRVLGIZVMFVDJIADOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDFMNUSAIZERJYYCEDYCJGLXTYFLNPQTEIY9ZSKPAGLTPFBJMMLUIRLMNDFXEDGYMPHZHHKVRCDVSUYDQEBLZHFOEZSPVZYNVABL9BHDNBPPKGLZSNQSIOXP9RELQVGVYLQRQRBZONRDHYOKEVBAARFLLGDWYMI9RHLCGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999THISISATAG99999999999999999EJDWC9999A99999999C99999999NTXHXNNAXJLSGGJXWVNYGEYDNLDXYZGKHZRRNHXWIQYVFRNGIEZRHBTUPOA9GBTVUVBCFFSBIKJJFDCVD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[3].toString()).to.be.equal("BLAHBLAHBLAHBLAH99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBA99999999999999999999999999RKISISATAG99999999999999999EJDWC9999999999999C99999999NTXHXNNAXJLSGGJXWVNYGEYDNLDXYZGKHZRRNHXWIQYVFRNGIEZRHBTUPOA9GBTVUVBCFFSBIKJJFDCVD999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with no remainder", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    43,
                    Trytes.fromString("BLAHBLAHBLAHBLAH"),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const inputs = [
                Input.fromParams(Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD")),
                                 AddressSecurity.medium,
                                 0,
                                 43)
            ];

            const response = await obj.prepareTransfers(seed, transfers, {
                    inputs,
                    remainderAddress: Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPIAA"))
                });

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("YGGXHATQITGJFXTYXTSZGUNIFJYQQMSBUMCUPUMIVZNKQGPKPPHUW9VUTQRU9PEJFXVVZYHUMAOQKS9KBDZI9TLAACPW9ES9VBMXMDO9SJYKIGEDSJLWAKEDLO9GIH9ENWSIUUCQOLRHHPYKFHODIZNPPFWPDCO9KYUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXZVGXNUNKOOKDIZISJLKGCIQWYQSDVMXQMJWLYHLOMUAOWFUAIJQLBNTYZNZCSNRUSHCNDVPWXOBEJRBOYKDGUEUOGAQ9VLXYVHYGWTVOXXAZKWHETJEFEQSRXWTDEQHTS9QTNHJRYOCMHFYOXGGIKIKNNMNWZCSKEWFCYFSXKUYROO9WGKOZSVJWPBTQEBPLQYXAVSGFJIF9VMMMWTLAUVLSSAAOIDCMFKEVINLMPSQIEMUQLP9X9ERUPCRNNNXHI9OSIBZJDPFTHQSPSMCZTGHRR9GXYXWVFYNWRERNHLFUSH9CITIMBSHSMYOMCZCAXSOALREYIYUABOXGJVVIWDDFLIPKUQJCVPXWJLWVPCRUIGSJXQJKGRCHSXRCMTHUWFXBRLKYOAFKTSKTQQALDMVKINS9DPJUFRGZSQKTHHBKFR9D9RPVRABDPTYSRKTHQZMHCAGZNESKYJDSJHBYOMXRDWIBOKUDVMCKYXRQFUNSLMIIPNXDFJWUXTCHEQHH9GJJPUPTSCWDZIPHAMGRMKYFKWNNOWCKVGOKDOTJBYHIMGUALFJFXOXQJIBVFJSBADFOYYQDBSRZNDELTUOQULHUDVVDRSULBV9GIMUHPUAETCBOZZAZCDADXM9QUEZTCLTCBDSXOUQJS9FEQGFSHLARA9UGRHGNJJENHOEPIPTRLT9PIMEQIHHKMENRIBPDCAXWWGIPMKDNKXRTPFAPIBEX9ZJUJJQPOXZJQTVQGUHSIXVUAISNVAFUTLYAS9ISMMYD9LLTJTJNYGZSTFUYJKNQDVSWKIMCFFYSFXKEV99GNCYETTRPEWXOTLUBQSZMVFNWUBHBEJPRKEQGKTLGGFCXDVHPDGQYJSDHWEIIUELIAUQHDDZ9KY9DSXZLJOMIVHNLWOQBQDI99INMPSRRJNXDNKPCCWADIKMERRFCYXUYKTASELHCDSCERDBZVZYHMGP9JPQDPTZWECBDBHVCPAAICVAVP9P9NZYCMLHYSPYCJYHUXNRWJMPSGBPJP9FFYPLPSPLQPRIS9SLDEZRMFDN9LMAWZDVDQGTZHLGBGDYZZGCZOORTUTIATKRJVNBMZPJZMPJHYD9P9LMAWRCBSWLMMBLIOLBMIXLFWEAKKGHSMZJLLLUVLUXLAPZQAOQBGQDYTAWMYAFODIDQAM9BZKICWECDZOHVVDBGMRYJGJWFDTRRBHUUHEHJJAKFSLCEVIWOFMAXUACVNXHQZVCJSZFP9DMVFWMDNPBZHDDEGNKWHV9E9JAQDPYUU9NIPFPJHGXAWVBTUMAHLFQZVQICRCMPLYKQVGGYOVCQTSQVBVEZFRSECYRT99DDL9EFZHN9RZVONOSTJLCUCGICAKEVRSHFLOXHYIPODRWZSJXAASHUQRQTVLAE9ENQCCNDZCY9NGFKWKKQVPBOJGEIQCCVTIQGETCRPRBTSHTCRQHUYBRLOISRACTYQ9AZDDXTXMGNMWGGGPNSLTYRFJZIDYJABJUSZDGRCNYIIBAXIDSEUOLSUC9BLGTGIXJVBBFQEDFZTK9DQQMAKWJJNSQSSSCEFSVVQVGDZEABENZRLRPDDJNKE9B9Q9AKDCS9SYPJUYIJWHMNXQMXOCJGKSSTGKSXZXIEUKCHBEHXEGPWJPFHQLDYJCPCVPOATPNJLGZ9RWNPQDRDHWDDRYDCBLZHPTWMUYESGNOEVVAPVXBOCCNLDTFNLLSILKXMDVCURMTFSCXEBFSHVCGBZ9HEAQXJRCVDEBEVEY99IMSCVJMKOIDAI9HOBCRXJIJUPD9ILGOIFSHMUCRMQH9FJGTCYOOKSMBAOMRTFATSUSWAETQIXKJQBWQIKBBGUKRM9EQJUHULS9OKBOREMVBAKHPXNMRFXKUKX9KDSDUBIEB9QCYNGPADXQXHSWYSICKXPMHOGD9FVAUZOZVJEYKS9KTPWMF9IPYWIZNBGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999THISISATAG99999999999999999EJDWC9999B99999999B99999999IKHLOAUHJZ9FNTYDJIPECFCWGBHKTMZODRRLBHSBJWRBLGLCELDXQIPHYHXZ9IE9PXX9PYTYFKVCZVGIY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("NJTUZNAHHFRIUGQVMZQUJOHXITWTOAITPDFFKXKSNBOCJBBWZKXIXZUVQIIXNKFFPWYTPIXXHWIVHVSPZOBXRQCSKWOJPYFTBWZCFALTXWDNJZOFNTHBLUOAKIQJRODDJYMEKTKGBCUQZAMLQ9CQEFKFJYSHILDBTAOPYEE9RNZIBQSCPKAQZZRWSXFIUSILKSKEIKSOBNIKPTUZPBTYTSPRUTGICXOFJCXLYVDRCXLZTTZXRECLUFUOJILKIWOPOIRBFKQBLFQRNVCCCCSZTZUQVMGXFAXMCDENSVQKBXRV9RGBZPOYMBVFVLZXPMOWNRZXVFGYQEZKZIEJBCNVC9TRKBAOJLMNKXYJUZQQLYV9GHAEIRTBTSEMPFVCAJQNCQIFBQDBOMEUQWGUZC9S9KBKIAKVRKLJZMRVMWJXJNPAOCJYISAJVZKVQDTFOJHUJDJGDBJNXTDERIVTNHUCULTPJAY9WNWKSSEYD9KUKLGPVMHXVCPWFGYIKLXGZHFWOIGQDDOLQYW9ANBBNOZCBKOUSEKKUXLHLOVTHDAZPSFEFZDTFIQTVEDRLOGIJ9FKIDCZIIMYDAXA9DDFKXNVHTYTBYXRSCWPBZHJIWXMBMMARSA9VIHSDFVBMZJKJXZZTURIVXR9RGJWBOAXRMRWLDZIVB9MRLWHLXWV9XSJSCSYFCSIXKKONWAHDLRAFIOEUZFETCIFHOSIXUYS9FKQDJGSXCNGXCMIAFSVGGHSSLCCDAC9ODHJCSCZOVJMXJRZIDXANIGTEVNOMDLBTTRLKNQFODWMBWBBEQGIPTGTVBSS9UJVHIJSTIFLFKOVOAVK9XTLCRYTKYI9CVCWAHHRTMSRUPP9AWJCZJOYGUJWNKSEADSAZ9GXL9YLGDAITZDNZUZUQRUAVHQLBMMFDOSEGMEYRHWRMUZQQJNFAKJJIAKYOT9HNDNWWFNAQATYIS9VROLOPCL9JLKDKGCWXIROWUILBSRFYAPDGQSXWDJPHMGUCCZAKHQZXECPPK9IXAITEYS9BYGTRYSKSRKIXWFLZALCFSL9ZXXJLJDHUVUKIYAPFN9PCNZYVNTOUE9OM9QKIYYNHFHJNQEEETZIBPWWHVNQSVHSKUCHTRENIKJKXIXKDWMUGSCQKIMLBNLMCRIAELOWTOZRFRNVFNUVVKIOJTEDCLPRUPMUCQIOFLFPCQARQBHEDXDKPIEYDSWBCUXQUHFVOY9BPGYOUMU9A9KFZVPCNGHXKLQUFJAFGJPUXAIJZENLM9OONPBYNJVQQ99YUIZCDOKPB9JLLFE99LFKKJCUNNIBAVMWYEAMGRZTSTIAEEMIMJWYSWR9CQHWLTYZAQBJFTYBEVVBMEVJODTISFCOJRPDTYAWD9NIFCVFPKISZVBJVCKMF9ET9OVXSQAKQCBKEUTJKGKOIOWFODEKDSWCBQNXBVBEAWBCIDNPIGP9FNNXYWXYORVQCSBTKFMRYFNDGBSQKQLHMQAKKWTPOIHBGSUNEKFFNBLTYXGRBMKTPEWAJDJTNWNUFRN9VRLPXGDYQDIUUNVROOTLTSJUJDZVYOTN9MOLMGEXUXGFQDXOAYJGOA9WYGIDPCIEILS9LDQRCIOUQEHKWVNATRBAGUCZBPZRSZGANIGZGGZCHJZQ9NIDRTHHJZS9GH9AXGZKZEGCJDDIALCUBROIDMUOFWLTMXEATGLRMPRXDMCNT9TDGTHGXYBLZDDSGEGKSJPPEGJZUNNFBENIJHPFEJRETDADYNLPLJGTGXZLVTMRPTHDYTOTEJMOEAWVABHXOHOAQKGQLAGCYWAU9JOVNYBTQCFTDGOLKXBAZVSUCCFFYYGQ9VJOASEHJEZPGUEGQAVVOMMQRJB9QOWSGZIOQNDVLJNFSXRXRLBOUOLBSTSZNIYJNOEZRMCZLJBHWPDWPJUBZJRPSXBHVMCQYWVSLYJKMERDVGJVCYORNRELJWWFAM9HUCEFVOAWKPNUWTZWWJQYNEWKVAIYYKUKLMHRIZSKAXYAYSNXYQVQBZMXP9FVWCYMYTOT9BEXDFWCLJIOWLJNJDMZCXXUJNUDKS9AN9PWFGNBIBIXP9FCIWMVQM99VCLFOCXHKDQVNKIXFCFLVDKUWODZMSMPHAJJQJIXB9KMV9WYNVQKKEBECBAIUCMWOEJZVXBHDDEPJTGNSGRMS9P9ZOVAJANEGIYGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999THISISATAG99999999999999999EJDWC9999A99999999B99999999IKHLOAUHJZ9FNTYDJIPECFCWGBHKTMZODRRLBHSBJWRBLGLCELDXQIPHYHXZ9IE9PXX9PYTYFKVCZVGIY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("BLAHBLAHBLAHBLAH99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBPB9999999999999999999999999ZRJSISATAG99999999999999999EJDWC9999999999999B99999999IKHLOAUHJZ9FNTYDJIPECFCWGBHKTMZODRRLBHSBJWRBLGLCELDXQIPHYHXZ9IE9PXX9PYTYFKVCZVGIY999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });

        it("can prepare transfers with hmac", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1519037971946);

            const obj = new TransactionClient(apiClientStub, undefined, timeServiceStub);

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: ["43"] });
            apiClientStub.wereAddressesSpentFrom = sandbox.stub().resolves({ states: [false] });
            apiClientStub.findTransactions = sandbox.stub().resolves({ hashes: [] });

            const seed = Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN"));

            const inputs = [
                Input.fromParams(Address.fromTrytes(Trytes.fromString("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD")),
                                 AddressSecurity.medium,
                                 0,
                                 43)
            ];

            const transfers = [
                Transfer.fromParams(
                    Address.fromTrytes(Trytes.fromString("YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBKUUNDKVMX")),
                    5,
                    Trytes.fromString("BLAHBLAHBLAHBLAH"),
                    Tag.fromTrytes(Trytes.fromString("THISISATAG"))
                )
            ];

            const response = await obj.prepareTransfers(seed, transfers, { inputs, hmacKey: Trytes.fromString("MYHMACKEY") });

            // tslint:disable:max-line-length
            chai.expect(response[0].toString()).to.be.equal("RBCTPJZUSPILJHQWBNUHY9IJJYPXBJKBHVXUFKNUKFEXGCBRAUQAWLBSWLXSWAJPJTMLYXDMIQJFJCHGS999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXKA9999999999999999999999999THISISATAG99999999999999999PJCIWYD99C99999999C99999999EXKEJWSQAXRUGLEAKUEYDOGXKBSNWKWDAX9VLILZGRLZWQIZRZRWESRXJCLLFVBPJIO9SCBNPIJRELWJZ999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[1].toString()).to.be.equal("DZPMLPWELYTPXPEAXFFK9G9IWSOPJWDAHIRONVWVXRGZKUFPPZCUQCNBTGNCB9XVAZUHRLQVMDAD9KXMYOMSDZMKLXOWBLGEXMWOFZQLFQJMOMZCCSPZIAKXCDNPYGYEZWFJP9WBPDPXRLPYPPWTXJXHPNHM9HMZHAZTYNCKCTIEUIXCFTNXEEC9BFWXMATSGBAOYWSNMNC9DXLTJCTPAORFAGBTJNSOXOCQDBYCPXHWPNCFGFWLHLR9XJRCCJUD9AUAWQJIADIGYAVKDBAQYZIRIQWUGIJDWQQXBQPEDBXAHEATNYGAGCANYUK9GWBHW9ZBYBRAWWMDQPJQFZXJQVOKLAYWJHRNCKIHDDQHFKFSDZCDNSDIRHQTP9ZQLYWIDDBFRYRBQKTNKDJNLMFVDBACJIBUXKGK9FGLMZNHHNHNYBINBFWKFFRILMMRTVEVHQKZXQMJBHYECPRVN9U9TALDHEWKETPTCONHNWGEUHAZOXWWXXVOOBXBFSDTBNYM9KU9TPGQVVZTVNHCWAMNL9LGDRSDVSOZHCPNTNILYM9JKBDHEAHYXFXDJWUIARNFRLMHEYCZQL9MVSDTPCEEYDTX9HOQRIFSKAFSCFTQH9TXRRETCQGYZUEAMAKOVXOQMDDLUOYDQLDFOKUNLDA9AWOGZPZYVZVPKDTQHZMFTMIPPXEQKCQCBYHTFUOVDNWGYPQDLJMFTSGTSKQFV9VHSGWNZKMDVXGKYCPCGMN9XREJNLVAXJPNKILKBS9AQOFOJOKFQ9IJLSLAEGZHGMYKXCMHVCUTXQOO9JCWMOUBYWVOQOGWSSSYQUMWCEUTJLWKSIECOQDPOUKJALOEPLDVALVLCVMAKKSROUL9BG9DYIMXFHIKNTXIXDIDIJAJRJAVBCYRZIISYATBYPLULADUVLVNXHIVMAECEHGMRIN9FGPTMNMBJSPNRNURTHSQWAMXFTZQAQSZBXKYMYAIUDYMJNURIJSNJQNFZCXXQBDAGZCC9JZQVCTKIYDZSFXSXNBGLMKJR9MNVHVYPPESBDDRFALPDUMAZYQBFRKHS99RVLOF9PEERSHUAGQYGWLGUFATKYCIMMCTYLIXVMEAYJENNK9ZEPWTIOAYQLIITRQQSLRFLZXPOGIVHNPNZFDNYDWVOLLYR9BTCHSLPDCZCBRWAFPZCHCWEHOHMMZRWWLE9MNWIBFNWUJZOLDKEYNIJE9VZFRWAQZNVHZHCTWABBQDWXSPSMKIKKDAUWMVDHJQDJLFJVXITCVCCHP9SRBERCOMFFBAGPJNDPECJSKAT9RDEGDKVZRABNWPYXMVJFRZHQPUYEDXCVNFWZGRS9BXEJ9VRASZRE9KQFHVEIDNETD9QRDN9HHUFOVSDWX9UYGRTJTWAYFDVTZZNELQKGRBZHJJLVCPXEZEGWBE9FQ9VZOVYAMMYKGQEOXPROCYDAPXUVMXGQHLZDDP9ZTRTSAMABXSBFHPCVURHSLUTZIGPGQRCFSORFLYYUASABOJNIPJOIUCIFQHFLVEOGAPCPEBYFNJCADKJCNOPIQOCLXOKWMDHPCENORQYUOZFVHUDNLECSZEOBHGXRY9IOJYDSIVHGJPPCPJHRQLDHAG9VIHJETWKFQABRPXJFDK9GIXZIZCBVFANXDLBWECMOBN9UBLWVTILDRCOIEEUZVDEUWLHMGTUFUTRPNGQMWBNYJVWNYTHOOOJSHDXGBIFEETQNVXWZLGEDWW9KCYOEODNZKQXABHYDBOZFDEQIOME9LXJZRGRBRLOZIMGCUXYDOOYKWR9DNMSJBF9FDJUHGP9ZOUFVBOEUUMYKAT9YDNZ9OZRPJBWD9ICQOZ9RLBHFNYDQKUA9BNJXVBJRXFHTKDFOHA9PUNBQCWOUKQIVCHQSECZLTWVHNMEHWJLIZVHKLP9SASNULKIYQMINLAQPRBJHQKCVGJ9BIZDYNUWDLMFSPADPJLBDZRG9FZONWYVLXGUIHSNQYYDBYCC99YZXDGPYBO9FDENWNKUDTFMZTV9IHPROWVDPK9XPUMFVEXIRTGKKBPPHP9DFVMUONPSWJTQKDXGJRWECVKSLYSQSDZZQIZKZPOTVEGFXJS9ANVI9NMNXZIIIYOXIWDLAIXLBYTVIVNOOGHIOOBYHMEMEGCURDUITQOWYBPPPMDLVABCIOJEADACGALWHYRHKLIKYYGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999THISISATAG99999999999999999PJCIWYD99B99999999C99999999EXKEJWSQAXRUGLEAKUEYDOGXKBSNWKWDAX9VLILZGRLZWQIZRZRWESRXJCLLFVBPJIO9SCBNPIJRELWJZ999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[2].toString()).to.be.equal("NJTUZNAHHFRIUGQVMZQUJOHXITWTOAITPDFFKXKSNBOCJBBWZKXIXZUVQIIXNKFFPWYTPIXXHWIVHVSPZLBG9XZMXAFLLCOSNMNJEWJBXRNTLGWDEUTCXUHJGSAN9D9VYPCRM9KOYA9TQKEHCRJZXEDKDRJE9SWAMB9TZNKKISRIKONBRNETWCSDDOBJNYEISM9DIGYCSIOYOAJLVYXMKLLGSAODCSPHGJLOPIKAPHUQYQGLXUDAADWYBFFXQHHYWQDUNURGO9ZKVDNZRFPZOMEKOJDNGCIPKHSLUDLTND9DUA9KHMGGWKPVEJWISWK9QHXYAWRL9SRBYTTCVYTBMQODLHE99QRXFQZX9GIRHMNKK9ENEYZTI9CJGQAAILWIULPVCNLHNICWDOA9UB9ICOSWOZDWELRJVKCIY9DU9NRAOBVGVHZNNJBPQDTZEBAAWGGMUJJVJKHZGNZJUOOTA9WOJAZCSWNJCJYUADRIKXTWEXFEVWYKUFYTEHGLTZQALKHVYKMUABPDHMGAHFFLADMSCNIGLFZWHKXAXFXQFPMOZZRFYOOSG9BSSEYNRITYUUEABNIPAFRQUADWDBPMTBELSBOYRONFWPUUSFC9PPAIRVCAZ9LUFMPFYNDIVSUBPKRNNPRWBXTXFZWVDAPPRIGGHNDYHHUUCNTNSCXWMYDNEFZU9CCTVMEEKPFMLMHBTJGKGXKNFEZAQ9PM99CMHTLEZZO9MVPRSNNYGWXPCWG9IYBYHRVSRATKQAMKCWSZZHINOTGYUBVNLCKRTYMQZXWOJV9PYMEMENNRLDGURDPWHCTD9MZJTVHIWTZOP9LGJGZYPJLQEVDYZDVWKHVUULXISTZKG9JLJPWHNYHWPCLIQJEKOPUCCXHWGODWMPCKKORFR9NCARMPVJJLLAOROTNHDRLZMTYILTK9XWGXIXHYCXTMWFHNQ9WNRMYPKUISTJCNUBHRHAZXRLR9FZLKNVYOEJHCLAYECDWR9PCYFTCS9HUYLMZFDKGYJXSG9AEJVKECRDGLUZQHMLJHCZQKIE9RHCTPXGCFH9QEFZOYYKOMYWKDCONBXNKQEFIKIIZNHJNCKXWVSFOOZPUEBSQYKTXRZDYWCIYCRJ9IMDT9PQGZKWZLOYV9WUXM9YYZSJXUGAWGSBNDDSPIXHBRCZX9FXSWQDVPGAKLHWAWKUUMLLSQFNCHHIRCSPMPFSQETVW9NLJUBBKUHALLTAVWFCRJUQADHDOTJBXPWUKCECIXDAQPTHORNFDIMAGGTVKKLYMCFGEHB9SALAKOWEODRCC9SI9FQDVTFPXEJR9NPNPEC9YKEOALC9JMJRCFWKHLJ9RSRBGSZBUBLYDFPLWK9XIAXKZLNXX9FONQDMDDSNLG9GRXUEADMSSPUWH9NQAWNZFHULCOSYESVCYWO9PYYB9SSOJETKE9KEJGDEZNTOKFHGZMIFQXQWMMVHXSPAHE9YDRFSFJMCNVKRZSJQAAKDRZDSKOVBVREKYBAVDBLTIOAHODCV9CZEPHRMVIKTQMKPJL9CCUPJJTHTWQASJE9KQBMF9XPAAUKP9PZHCZBETLTPGOTIQUUSCLFNUQHLBUQVWCPXOCWNIQC9XSK9JKAEGZP9NGNRREGDEOQWTYOWXGJEFQLSVTOIZYCUEFBVZPXSJDXTPOVRZAIHXMEJFRVUREHEYDJSKRXQBWU9FCWVJOISDBWYNMHMU9QUALCSDKULXDSOCXPUMJCAZQEMQWXBCQZBAHMJCROH9MTUADZNXRAJEDXXJI9UEGYWQYZRQRNCZVNKYCNNJTUZ9RUDDZ9TUCSOEGCFJADHUGGTFSIGNXNJAREHUGKOCNLPYYFPVGU9PACBQEJRWBLIZJDHBHWPZAZVCGRHDFMWDXKSGSJMLENKPFELFLCXCANKBOWTCEBXPZISGZIXRHVHLBHTAECLQBC9UZQXSQZGKHWXXCYLUJYRTRVAWYBTYKURUXSR9CFKSFTTRYITBZLGFPYNEWMAFTBIRKHIPRTMFRPTDZCPGDBCYMYTOT9BEXDFWCLJIOWLJNJDMZCXXUJNUDKS9AN9PWFGNBIBIXP9FCIWMVQM99VCLFOCXHKDQVNKIXFCTNCFAGPFPZ9NZMKQNQ9ABPAJ9QZVWQNAWGXCKLOJOGEIDIRZUSXPY9TGZBRTNOEJTQYZBLNKO9MNGOGEBGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999THISISATAG99999999999999999PJCIWYD99A99999999C99999999EXKEJWSQAXRUGLEAKUEYDOGXKBSNWKWDAX9VLILZGRLZWQIZRZRWESRXJCLLFVBPJIO9SCBNPIJRELWJZ999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[3].toString()).to.be.equal("RBCTPJZUSPILJHQWBNUHY9IJJYPXBJKBHVXUFKNUKFEXGCBRAUQAWLBSWLXSWAJPJTMLYXDMIQJFJCHGS999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999BLAHBLAHBLAHBLAH99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999YWFOASPRMMHRYPBTSPMRLZRUPQRUXXCXZRVTBHXETBUJFZXJVDHHLORPNECANTVYCTEQULGJXELPVNJGBE99999999999999999999999999PJISISATAG99999999999999999PJCIWYD99999999999C99999999EXKEJWSQAXRUGLEAKUEYDOGXKBSNWKWDAX9VLILZGRLZWQIZRZRWESRXJCLLFVBPJIO9SCBNPIJRELWJZ999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999THISISATAG99999999999999999999999999999999999999999999999999999999999999999999999");
        });
    });

    describe("getBundle", () => {
        it("can fail with invalid trunkTransaction", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getBundle(<any>"ABC");
            } catch (err) {
                chai.expect(err.message).to.contain("The trunkTransaction");
            }
        });

        it("can fail with invalid bundle", async () => {
            const obj = new TransactionClient(apiClientStub);
            apiClientStub.getTrytes = sandbox.stub().onFirstCall().resolves({ trytes: ["AAA"] });
            try {
                // tslint:disable:max-line-length
                apiClientStub.getTrytes = sandbox.stub()
                    .onFirstCall().resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999NQWYCOBATZTLRNELEQZKKJHLQETGCKV9FZNIYSBJFFPQGMGSS99GCZWEEYEJYFZYWGDCVDV9YVQZQMLXCA99999999999999999999999999AF9999999999999999999999999YPEJWYD99999999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDQCWJDQFSGVLSNCLAGZCIDHOQXZPCVJDXOMAZSZJWVDXEDGMLRSHWOOFNVINH9QWEBFRR9JVDSONVZ9999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999AF9999999999999999999999999QIENXZFJE999999999L99999999JCOWHODZ9VWXYOYNTKWWTVY99TJ"] })
                    .onSecondCall().resolves({ trytes: ["QWBEXIJXCAVCYXRBSWATNNCCRMIVE9SFBUGJAPQKDZDFDJPQASSVFXJDLFDGXZJRYLLSHTMNMO9OYORDCJXUCLRCRIMYZHDFDQXPKKK9HZLTSYWTYZ9MIXICDZSRVKQUUNUWUPQZUPDR9AEOJDRWUVXVSTSDZQRKZCXLTBOQVWMQSWUAIUAQHAINFMJNBMU9IBMVHPXQZLUKQBHMPBDAYAOTMQ9VMDWKXUDYXYXLPJDFVTUIEZAALTWPFIDPQJXXMTZZYWCLAF9HV9ULOZ9PTZIQALISTFUUBZO9CAXYUZKJNWCOWKKAL9HINUXVHZDAXTEWSFDNLGFTANUZSPUACFC9XQPHUWA9JBGJIEMUJTHTTRSGVTLJFEAEIUQLTXLCFTWPAT9RRKK9AGUBNQVXBMRMFCAYKGJFMTC9N9JDQDIVZBNWXDBVLRRSIUBFPTUVHUOEDCWXBEGYKDGEZUEDHPRFSVAJROZUBL9RCWYNYUSB9ULWFIMVGDGEUAMVDDIDLMTHATYKGTHRXVF9ZQRICDHQ9LLJUBRDQUSMNRWDDXSGEETSDJHJDBXMJOUILLLZRVOQHUYTUCGJGKUEQAK9NOJBXFCFLTPLJYCJPEYAJNWLUSQGCCBQSGSQGRMNU9UOW9KDBRHX9NEOZJZCPLIROTZLQSXHXCCRVKXCLGTPRJFPFGDNPJTJNXTPNVLLWTKFFVBTTJIWLXKUCYSURAAIMSIVYUVIXZCMQJNGNXWVUOMSA9YJUVOUPFMDJVVTSRBRUQECYZVXEOGTJCULDSIYZXKIOBGYDJHPBQEJBHUOYWEECTJTEFUYOTXATYKTYRE9FCRSDNGPGEMQQXXBB9VPDVMZKBRQLOE9CRDWJTVPLCCCZYDVMYPOJ9KZCCWE9CLNUTSVGTEAGTJZQQDMIVLYKOEHTQCGQQC9COGLTOQLJENUZNNE9LYAWEPTGAFTQFVBGPEQISVBSEZYPLEMXGAYKAAEA9JDLFFZTKJFTXGFRFWGZWYVVQ9UFCOF9YAL9JCTUJTUQT99VOEAOZHSWQMVXBPKPWNQWRBNHANHIGZUXP99DVUZGAR9PTPGZAEBTEZOAZTPFCDERVCHJVHLTRSQ9TYBSBAZGOHTEEWUJWAYAHNJOXCSM9MYESACAAHRYZJKCMTKUK9AGVECWJHOUYNOVGFCXWDUDGYYK9CHVM9LEESLPWASCQBQZSQPEGMPUNZOVNX9ZFZXUUTJSINYZVDQMHKQJQPOXMCWAMQYXEXXLQRLMXNOSGD9XNYNILMUNDQQOFSJGSTXLPLLGVVXDCKBIQBSKQZLPLGWMGLNLNEJPCBPI9RN9DTIFMBPTKDBUILHKJVMDBJDSBOVZGW9VTJBFXLWPDFWBOQHYHEBUTRDBWHLJMMFQPNXWUCDIRWXCAXZUGWWYGUDRBXRQBPCALK9XPODK9UKEZIKTAWUQYAJYXMRMFGKNDZUD99EMLSRYQDFQXJSMED9MXSEOANTACPTKJALKQIMNUVJBVIAPLSGOJUKAYLHQYH9HSPREYVGSPYGIAATCTICVVDLRRKBFUTDAXL9RXTURNDTIBWUJCCOMGLAIZBJMXGAETNTNNVCPFCJBVBZTSLTUDWSYGYBGTRCNW9IRORFOGKPWRLOOTHNGB999JHAJLMJVGB9WNRIIQKMICAPWNELTHXGRAFCRRIUFPSMJWPSCE9BTVZGYTGNMCCOYZSFDLXDFOHVLFQEWUDWKLJOHRBTGKHILPELTICCXQPLENMGGTFRFDLYJCSUOLXDPS9R9DJDQAGADPAIURGOBFZGBOFJCNIWPCZYAPPCEFXWJYYFLUCI9UXJBOORBQAVEBHFNOSPVUQHFGOTVDJLAFDZLFCGVGKQK9O9PEMHQCKZGPLLJSDNUHOGQYNYQUIUDOKDFARFUJBXOETEYEPSGJDZRJ9JOHWFHIMEWYYPRAYYASCNGXKATILOYGRDU9CBPHD9IGXVVL9AIWRWMRIOGLISRDIJDZZCFME9MHDTZLEETD9WUYBEGD9QSUISAPOBYFGAY9WPZFMENXUILGNBHA9RUSO9AVELPIVFTSFCNQQVCMNDOOXCCNV9VMQHUFGFWTNYBGVXJCVPBDFSNEBQGJHFUSZFEXOANLHMADIXEIVEYMKEHBWJFMNHLBW9OHTNYQJEOZUTKNGAJSEOZHHXWTJBOTZPJJCXECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIBZ99999999999999999999999999999999999999999999999999999YPEJWYD99J99999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDCSGDIOUGKLKTZQPTPPGOJI9XXKCBSUEKFOEJQZFFRXIVMDJI9AEDFSCKMCEKLZVHCLYYQZH9TZEH99999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999999999999999999999999999999OOBNXZFJE999999999L99999999OLRF9BJFNPFOIURDUIDYUYUPMSX"] })
                    .onThirdCall().resolves({ trytes: ["DPXEWZVMOSI9OTSC9YY9IBATBWRIAFOQWLKDUDNWHDKVB99GTKCMCEFITGL9BFCAWBKWKMFNBYTALCO9ZBDESYJHRBOWEYSZLXUPBQUDEK9BFSIMJOABKSYXLPHRJHWDEDRNUTRBLEDUUTIJLCLCNWEEOJJGXNPMWAULVFFZQJDQMBFMASQFOWDWBXVV9TCTBAYRLYRCYHVTRYADD9UXQSORQOULURUGOAJLWDXKXJYTIDVDMEDBJYRMUNWKWNHPDEAULNVXMXILVZEUJCSGOITAK9IHTVXKDMZVBUCXUDYXRQJXNCZCUGFJAHRXKTINEPYWWMKMMGEL9OIZUESMGSUTBHJTIS9HFLZDROHRJYETMWSGDKASTRJKGMVVILGGVJLFR9GXV9DRUVEAEHYRDXOPYYL9TSTDDXGTVUCBUGBQXBVPYRSFDJMBCWFGHAXCI9ZFZZJXI9KBMFXLSM9E9WNMDGLVJNTYNKZZHX9BGUCNKXRY9SRSLWWMQSMNARRGYO9IIPSRABMIFWVOVCZSSYICXQTHU9NHTQGAZTTUII9WPFDUZFMXJAAJQCRBEDLLLVZGUNVDRVETWQNJCTUZAYSCNSFDQPYTIIFZLRULSCXTWHJVYZSARFKCRVZUFRSDPMWFPWXAAVDKVRVIWAWGSTSMIG9LGOYJLXDBYTFPIWITGBUSDBZNTQZCKPJYWAEZWA9AMCLZOHQFFFFVEM99SIWDCIZGDFDZRHMMBVOUCEAOLYKBSGBAEKA9HESFDRJNRMZZD9FGTGLUJLUNVTFWZKGHXLLRQDZDWXBOEOCRCXYQJJVASPNGLQPHGYEFZBEPQJMZUHXFBRGVFBIYJBQUDU9HBTUEPW99GTEJNSZEAWIWRUSSOXDEOTQGJK9TR9RDDPOUTDXPALHKABHKTGRZGSDUCGQVM9OCRVYQRZLAEMZJCD9FLJWPERPUPXIJRZMWGGPYUZHWJZVXOMIMFDLKNMTFOBJSGGBYMTQTCZBYYMQOFVRQB9NDRTRQBGVOGEOMAZLIOQIUJBOVOMUFARUQLBOLA9GZDIGVHZICDCIREHOHQWNFWJPHYZIFQDSBNNOYLNWGWUVIVLYSEHTKXIUBLDRXIHUIHTJJOQQOJJSPNTEZYBIUUSHDONVWPXLGJSBXUQNFJ9RCIPUWZAGNVCNCHGWULQWVJWMMOVWQKGNRBLVOGWLPCH9CPEXWHYWFER9JJTXMV9NFZRQRHBPQXUHMFGSVQUSOIQEYQ9CPUYHCYHLNQPGEUB9BANDSACRIRQOSEKRFZJDBZSOXSUDYHULECYC9LEQCDVWDTAJEGNZHJJYJPJRPQVEHTSAEGEEECUICNVOIP9BASZVMDOMFYCRAWTSJZFZNGEYR9YNCJVRJHRHHRBGSFFEPVUQVARIUZJRTNEWCCMIKZAKTZAXUTARGRGGFJMVODIVDEFHENUYKZUCZMMEDHWFWBXTJRMK9KZBDOAMWYWKRWQVE9IBAQCPFRPWANG9XECCEWHTQMQSKHJZNVIKK9QVIMVUPIGA9MLUNMS9DAQHWXTJVGQBOXVYLZGQHYQKVFCZUXCBXYRUFDUAXOLYDUJKBOCGRCQMNPQGMDPRXZFKSLOGEBKLIORB9TJ9AYBAUXGRTQVNOYNUZS9YPGE9JGWFUHJN9NSANREKHOVEUDHWFTGRDCLGURKINSUL9CQVHLKUMRRELAGJBVKOIVEQPUVCNGIKLNIZZYGYSOLTRTOEDTUTCHUAVSJOAMCYANYMJZLJNRSSJQDPQKW9ALXCDMESFGBB9RXSXIVUYMJPNYWLRTFTKOXOKZIXHBTYCV9UDSJNHDKGXFQXWSMBSP9YNIEEDK9YKPHGZBJTYRWI9EDZYXKJSYZOZOUPDMLQXHJASMYITMKWLNYRAAKAIOSXXPTCESBUJSBCCKJTFMPZYIHRIVJUGKLMHEUFGICXCACN9PNVWEPCJYZZWPVPPZWSZUQUJTWDQZSNPHYSFAPI9FVFOMMEPNXDRZHNVSRSE9YUAYMYPTEBMRA9KXINTPYCXWXEMYZIRDEXAHFJVSGZDDOGJHWBFPHYNDQPBYQUAHHAVTPSGBCKRGJHNLBWQRQLSVW9PHVDFGASIZWEYJFTNUQVBGVKLFWSPESLNFPAOVPXEKMCWAFVDCZSB99UHXECKWUXEHRFXKNH9PPDYTEBXUMQCASXXECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIB999999999999999999999999999999999999999999999999999999YPEJWYD99B99999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDPWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999CRTPYSKRCJPBCJMLGTYWSPQSIVRYCCZAGLJCSDR9BXWDKYLFUGZZFNH9EUSXGOCWHDJNJYLRFETUZ9999999999999999999999999999999YLANXZFJE999999999L99999999AJNKZDXLQN9AYHXWIRTBGASOVXP"] })
                    .onCall(3).resolves({ trytes: ["KZXCRXMKOQSVDFUJND9DYSUSAJLRMGISKXJIUPSCSVBTYKERFCJFKXRNPIZDCXASVAYTDLVYNVQBMDOGGDFXOQLQBYTLJIUDSFSEDPTTC9LBLHVRLJO9XXIJITGDGFXSCQZPGOIUHXTLPBDXQYXXUOABECYAYDPVJTHBYBMTJYXWBEYJDTKUDTM9CSRZGRTKYPSTBYCKPEFA9MKLDWGJKWLFJQXMEXXHGGXACRZFXFVYAEHJL9PRNSGXGRESZRJRNXISBRXT9ACPQKTIQUBGNYHAQCT9YWVYRIZEMGEEPXEMWINNM9MSYUZIXYHBFTAEGJVWVPPDSBRXALMSAJDFFYKFMRNNHXDLPV9ITHHDUYDUVHDOYBQNYPQPSBJASIFBXAXMBAA9STGFVEXWBLLOSSGUFKYJWJKLADDOHRXNZTWGKOM9NNPCVEPSLFEFJVTDFQ9LVHQFTLRSPGEPJLLEDNZZPBOCYCQJCZDTWRHMQ9KKGPEHWROEYXSVDSZYAUZZAJCYKZRNZRWKOMJTUNZGORBLEYUAJTCGOLYPJLGKQWBCWJOJCDWRUIQNIGUEIZVQA9VX9AOZVTNOEKDLHGMLS9MPVGADYAASGLFYWELFLGQNDWSKRZOWZWKXZLO9ACX9YCSPQMVFCEPYZXMMADABHJEH9FOIZHQFEUCZTBFVBMGBGUGVYSPVDPPVBEDPQIWFUTITF9IAFCYLUZSSVOMJNCITBLRLCFGRREHDPYKPUDJWAWARQELWUAGQAKPZHMIGJWLMBQUXOHZFRNQZXSQFRZXEJPZGBYAGFIHEMWOLTXMPWGG9ARSNYJMHUCMDCEUKBQDIQQTDGEDEREOYGPZIUNIUBKTVXCUEDYSWAL9NUTKYVHQCMZORJNLWAEBKQGZYUMXOOZNEAMDTL9GBSEIFDZMJRVLZQHJPZBPT9NMSKYSXBSWVFB9FVSCYNLAQXFCJYVXRIVXWX9YKAJV9AHDIMBWDSEIIRDYOWCEWMSEYNPJNYXRXSRIAGJQUNYVGNEBQPFORPNWPGWGNDFC9HHVPVSOZGUQMIXQZMODTD9MYTY9GKFLTNBWYRB9RW9NGPXXZKTLGTSJWZSITHT9ROUECRBWZQCJBE9FOAQMXHFMHVCYSTILMIAZ9YOJIYTHNHJPGUNSSLSWAYMEO9FYYZURIQEKADETRFKTADKSTMAOASVPXZQEJNU9SSAEEAVOYAEGPONTCBUZESONQQESBKMOMKZ9HUQJ9NAKWVAPANO9XNU9ZOUFDS9JBIMSXXDYLPFVNPTSVGPFHOCKFBXIKEIOFYAAVD9TEDRTXZVNYGH9LLFXTWBNXKVZGDNHDFAYWJXZXXKXGBEIZNMVLOGTAF9WPQLPEBDDATOANFTPWEMFIHLFOGHLWGTHJRUQMMEITRLNACRIHTXBTMBARYWZIUKEMBGNXYJIHJVJJEZJKKKCYHUNOIFNTHVTIOA9RVCVWPAQXLWFRDPXHKBYQDJDMZBRKICVHZDNIKHXTKYCRROBHYQF9YSCVOEWTIUFDDLQBMUNZXUKUM9MWEMEFYDKBSVUYKDWCWEMUVRLE9ZKFKOTUHTCZHIGWDHKRAUTLVXCRIWAIJTJOL9NGCJDBKXZSW9ZUKMJNV9FIUDIPMIFKZEQHUMWJPFINZLXKOBTUJRDFR99BTWMNVGEUKNXXRNQLEZQBEPOFFURYPLT9QGJYWVWHHKIXECQRJXIJT9VYNXTURGDVEOCWORII9LXGS9GUOZUUMVUA9WVMCDXZNY9TTMIQKVTGDOK9INLUX9ZPT9VSKXKTRRYDRZWPCCRNSQBQZXH9TKMVHCHBYNZLEHITQOLTFETJCSZKJIXKXKRHFFCQOLDCGIEMXFCYIYKQJI9IYTFYJGETIXDLTTVELXXDLUOVWLNTWAPPPBIQACJMXPQXWENOFDVNGVKWT9BHJTHCTQNEXRWRWZXGDQJBJ9DCKNBLIAJEOJOCIHNUSVCKUDOTLTHRFXVQVFKTJC9BPIRGCCAEIJUROIGMFLFLYFJJMBPSEWIDMZN9YCXOVWWYFSFTDNBYGVUURVXQZQCCYBWR9BEYDWTBUQIUYX9QGUQXGXOTXTSMTTBMXAGLSKZXLODLFKMWMHUYLKTVYZ9AORUIRKXBMLSQLBDW9EFUFZIUVNCYBIAZKLTTPPCYWPHNCHVCNPBRGYJHHWKSBSVKPWCHICGJZXKE9GSUDXZYUAPLHAKAHYHDXNPHENTERYMMBQOPSQIDENXKLKCEYCPVTZQLEEJVYJZV9BWU999999999999999999999999999ZSZRA9999999999999999999999ZUFJWYD99999999999A99999999FGKNTKWXIRJQCXNYBVSYXKBTASXTIIYVXQCMTWJTMBAQUWBEOTONFRSWL9BBEQPXVIGLENQVIQJNVVYPXOLVGNJUXBMJB9XXEOIDUNVSCWFEUDRCNIRN9MV9XSCKZBGOEOXANBQMPDIMFGJRISMJVLZEYP9Y9A9999DNZOV9LPMY9SCGMEUGKLWDLXFAEOCCGHWQUM9CWIBRFYOOJJLBZTOBAGM9OEWTNYVYTSFEKVOXLSZ9999999999999999999999999999999999999999999999999999999999DTQDEHSRLWURPDNPSCQWYTOVFPB"] });

                await obj.getBundle(Hash.fromTrytes(Trytes.fromString("EZIP9CROCHKXAYAERE9SYIJWEDJNSORJ99EZGYVSNIWLJZGCGGQEP9IYMCSAFKJCMDSVVDRHHMMQ99999")));
            } catch (err) {
                chai.expect(err.message).to.contain("Invalid bundle provided");
            }
        });

        it("can get a valid bundle", async () => {
            const obj = new TransactionClient(apiClientStub);

            // tslint:disable:max-line-length
            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999NQWYCOBATZTLRNELEQZKKJHLQETGCKV9FZNIYSBJFFPQGMGSS99GCZWEEYEJYFZYWGDCVDV9YVQZQMLXCA99999999999999999999999999AF9999999999999999999999999YPEJWYD99999999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDQCWJDQFSGVLSNCLAGZCIDHOQXZPCVJDXOMAZSZJWVDXEDGMLRSHWOOFNVINH9QWEBFRR9JVDSONVZ9999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999AF9999999999999999999999999QIENXZFJE999999999L99999999JCOWHODZ9VWXYOYNTKWWTVY99TJ"] })
                // This second entry has an invalid currentIndex
                .onSecondCall().resolves({ trytes: ["QWBEXIJXCAVCYXRBSWATNNCCRMIVE9SFBUGJAPQKDZDFDJPQASSVFXJDLFDGXZJRYLLSHTMNMO9OYORDCJXUCLRCRIMYZHDFDQXPKKK9HZLTSYWTYZ9MIXICDZSRVKQUUNUWUPQZUPDR9AEOJDRWUVXVSTSDZQRKZCXLTBOQVWMQSWUAIUAQHAINFMJNBMU9IBMVHPXQZLUKQBHMPBDAYAOTMQ9VMDWKXUDYXYXLPJDFVTUIEZAALTWPFIDPQJXXMTZZYWCLAF9HV9ULOZ9PTZIQALISTFUUBZO9CAXYUZKJNWCOWKKAL9HINUXVHZDAXTEWSFDNLGFTANUZSPUACFC9XQPHUWA9JBGJIEMUJTHTTRSGVTLJFEAEIUQLTXLCFTWPAT9RRKK9AGUBNQVXBMRMFCAYKGJFMTC9N9JDQDIVZBNWXDBVLRRSIUBFPTUVHUOEDCWXBEGYKDGEZUEDHPRFSVAJROZUBL9RCWYNYUSB9ULWFIMVGDGEUAMVDDIDLMTHATYKGTHRXVF9ZQRICDHQ9LLJUBRDQUSMNRWDDXSGEETSDJHJDBXMJOUILLLZRVOQHUYTUCGJGKUEQAK9NOJBXFCFLTPLJYCJPEYAJNWLUSQGCCBQSGSQGRMNU9UOW9KDBRHX9NEOZJZCPLIROTZLQSXHXCCRVKXCLGTPRJFPFGDNPJTJNXTPNVLLWTKFFVBTTJIWLXKUCYSURAAIMSIVYUVIXZCMQJNGNXWVUOMSA9YJUVOUPFMDJVVTSRBRUQECYZVXEOGTJCULDSIYZXKIOBGYDJHPBQEJBHUOYWEECTJTEFUYOTXATYKTYRE9FCRSDNGPGEMQQXXBB9VPDVMZKBRQLOE9CRDWJTVPLCCCZYDVMYPOJ9KZCCWE9CLNUTSVGTEAGTJZQQDMIVLYKOEHTQCGQQC9COGLTOQLJENUZNNE9LYAWEPTGAFTQFVBGPEQISVBSEZYPLEMXGAYKAAEA9JDLFFZTKJFTXGFRFWGZWYVVQ9UFCOF9YAL9JCTUJTUQT99VOEAOZHSWQMVXBPKPWNQWRBNHANHIGZUXP99DVUZGAR9PTPGZAEBTEZOAZTPFCDERVCHJVHLTRSQ9TYBSBAZGOHTEEWUJWAYAHNJOXCSM9MYESACAAHRYZJKCMTKUK9AGVECWJHOUYNOVGFCXWDUDGYYK9CHVM9LEESLPWASCQBQZSQPEGMPUNZOVNX9ZFZXUUTJSINYZVDQMHKQJQPOXMCWAMQYXEXXLQRLMXNOSGD9XNYNILMUNDQQOFSJGSTXLPLLGVVXDCKBIQBSKQZLPLGWMGLNLNEJPCBPI9RN9DTIFMBPTKDBUILHKJVMDBJDSBOVZGW9VTJBFXLWPDFWBOQHYHEBUTRDBWHLJMMFQPNXWUCDIRWXCAXZUGWWYGUDRBXRQBPCALK9XPODK9UKEZIKTAWUQYAJYXMRMFGKNDZUD99EMLSRYQDFQXJSMED9MXSEOANTACPTKJALKQIMNUVJBVIAPLSGOJUKAYLHQYH9HSPREYVGSPYGIAATCTICVVDLRRKBFUTDAXL9RXTURNDTIBWUJCCOMGLAIZBJMXGAETNTNNVCPFCJBVBZTSLTUDWSYGYBGTRCNW9IRORFOGKPWRLOOTHNGB999JHAJLMJVGB9WNRIIQKMICAPWNELTHXGRAFCRRIUFPSMJWPSCE9BTVZGYTGNMCCOYZSFDLXDFOHVLFQEWUDWKLJOHRBTGKHILPELTICCXQPLENMGGTFRFDLYJCSUOLXDPS9R9DJDQAGADPAIURGOBFZGBOFJCNIWPCZYAPPCEFXWJYYFLUCI9UXJBOORBQAVEBHFNOSPVUQHFGOTVDJLAFDZLFCGVGKQK9O9PEMHQCKZGPLLJSDNUHOGQYNYQUIUDOKDFARFUJBXOETEYEPSGJDZRJ9JOHWFHIMEWYYPRAYYASCNGXKATILOYGRDU9CBPHD9IGXVVL9AIWRWMRIOGLISRDIJDZZCFME9MHDTZLEETD9WUYBEGD9QSUISAPOBYFGAY9WPZFMENXUILGNBHA9RUSO9AVELPIVFTSFCNQQVCMNDOOXCCNV9VMQHUFGFWTNYBGVXJCVPBDFSNEBQGJHFUSZFEXOANLHMADIXEIVEYMKEHBWJFMNHLBW9OHTNYQJEOZUTKNGAJSEOZHHXWTJBOTZPJJCXECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIBZ99999999999999999999999999999999999999999999999999999YPEJWYD99A99999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDCSGDIOUGKLKTZQPTPPGOJI9XXKCBSUEKFOEJQZFFRXIVMDJI9AEDFSCKMCEKLZVHCLYYQZH9TZEH99999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999999999999999999999999999999OOBNXZFJE999999999L99999999OLRF9BJFNPFOIURDUIDYUYUPMSX"] })
                .onThirdCall().resolves({ trytes: ["DPXEWZVMOSI9OTSC9YY9IBATBWRIAFOQWLKDUDNWHDKVB99GTKCMCEFITGL9BFCAWBKWKMFNBYTALCO9ZBDESYJHRBOWEYSZLXUPBQUDEK9BFSIMJOABKSYXLPHRJHWDEDRNUTRBLEDUUTIJLCLCNWEEOJJGXNPMWAULVFFZQJDQMBFMASQFOWDWBXVV9TCTBAYRLYRCYHVTRYADD9UXQSORQOULURUGOAJLWDXKXJYTIDVDMEDBJYRMUNWKWNHPDEAULNVXMXILVZEUJCSGOITAK9IHTVXKDMZVBUCXUDYXRQJXNCZCUGFJAHRXKTINEPYWWMKMMGEL9OIZUESMGSUTBHJTIS9HFLZDROHRJYETMWSGDKASTRJKGMVVILGGVJLFR9GXV9DRUVEAEHYRDXOPYYL9TSTDDXGTVUCBUGBQXBVPYRSFDJMBCWFGHAXCI9ZFZZJXI9KBMFXLSM9E9WNMDGLVJNTYNKZZHX9BGUCNKXRY9SRSLWWMQSMNARRGYO9IIPSRABMIFWVOVCZSSYICXQTHU9NHTQGAZTTUII9WPFDUZFMXJAAJQCRBEDLLLVZGUNVDRVETWQNJCTUZAYSCNSFDQPYTIIFZLRULSCXTWHJVYZSARFKCRVZUFRSDPMWFPWXAAVDKVRVIWAWGSTSMIG9LGOYJLXDBYTFPIWITGBUSDBZNTQZCKPJYWAEZWA9AMCLZOHQFFFFVEM99SIWDCIZGDFDZRHMMBVOUCEAOLYKBSGBAEKA9HESFDRJNRMZZD9FGTGLUJLUNVTFWZKGHXLLRQDZDWXBOEOCRCXYQJJVASPNGLQPHGYEFZBEPQJMZUHXFBRGVFBIYJBQUDU9HBTUEPW99GTEJNSZEAWIWRUSSOXDEOTQGJK9TR9RDDPOUTDXPALHKABHKTGRZGSDUCGQVM9OCRVYQRZLAEMZJCD9FLJWPERPUPXIJRZMWGGPYUZHWJZVXOMIMFDLKNMTFOBJSGGBYMTQTCZBYYMQOFVRQB9NDRTRQBGVOGEOMAZLIOQIUJBOVOMUFARUQLBOLA9GZDIGVHZICDCIREHOHQWNFWJPHYZIFQDSBNNOYLNWGWUVIVLYSEHTKXIUBLDRXIHUIHTJJOQQOJJSPNTEZYBIUUSHDONVWPXLGJSBXUQNFJ9RCIPUWZAGNVCNCHGWULQWVJWMMOVWQKGNRBLVOGWLPCH9CPEXWHYWFER9JJTXMV9NFZRQRHBPQXUHMFGSVQUSOIQEYQ9CPUYHCYHLNQPGEUB9BANDSACRIRQOSEKRFZJDBZSOXSUDYHULECYC9LEQCDVWDTAJEGNZHJJYJPJRPQVEHTSAEGEEECUICNVOIP9BASZVMDOMFYCRAWTSJZFZNGEYR9YNCJVRJHRHHRBGSFFEPVUQVARIUZJRTNEWCCMIKZAKTZAXUTARGRGGFJMVODIVDEFHENUYKZUCZMMEDHWFWBXTJRMK9KZBDOAMWYWKRWQVE9IBAQCPFRPWANG9XECCEWHTQMQSKHJZNVIKK9QVIMVUPIGA9MLUNMS9DAQHWXTJVGQBOXVYLZGQHYQKVFCZUXCBXYRUFDUAXOLYDUJKBOCGRCQMNPQGMDPRXZFKSLOGEBKLIORB9TJ9AYBAUXGRTQVNOYNUZS9YPGE9JGWFUHJN9NSANREKHOVEUDHWFTGRDCLGURKINSUL9CQVHLKUMRRELAGJBVKOIVEQPUVCNGIKLNIZZYGYSOLTRTOEDTUTCHUAVSJOAMCYANYMJZLJNRSSJQDPQKW9ALXCDMESFGBB9RXSXIVUYMJPNYWLRTFTKOXOKZIXHBTYCV9UDSJNHDKGXFQXWSMBSP9YNIEEDK9YKPHGZBJTYRWI9EDZYXKJSYZOZOUPDMLQXHJASMYITMKWLNYRAAKAIOSXXPTCESBUJSBCCKJTFMPZYIHRIVJUGKLMHEUFGICXCACN9PNVWEPCJYZZWPVPPZWSZUQUJTWDQZSNPHYSFAPI9FVFOMMEPNXDRZHNVSRSE9YUAYMYPTEBMRA9KXINTPYCXWXEMYZIRDEXAHFJVSGZDDOGJHWBFPHYNDQPBYQUAHHAVTPSGBCKRGJHNLBWQRQLSVW9PHVDFGASIZWEYJFTNUQVBGVKLFWSPESLNFPAOVPXEKMCWAFVDCZSB99UHXECKWUXEHRFXKNH9PPDYTEBXUMQCASXXECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIB999999999999999999999999999999999999999999999999999999YPEJWYD99B99999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDPWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999CRTPYSKRCJPBCJMLGTYWSPQSIVRYCCZAGLJCSDR9BXWDKYLFUGZZFNH9EUSXGOCWHDJNJYLRFETUZ9999999999999999999999999999999YLANXZFJE999999999L99999999AJNKZDXLQN9AYHXWIRTBGASOVXP"] })
                .onCall(3).resolves({ trytes: ["KZXCRXMKOQSVDFUJND9DYSUSAJLRMGISKXJIUPSCSVBTYKERFCJFKXRNPIZDCXASVAYTDLVYNVQBMDOGGDFXOQLQBYTLJIUDSFSEDPTTC9LBLHVRLJO9XXIJITGDGFXSCQZPGOIUHXTLPBDXQYXXUOABECYAYDPVJTHBYBMTJYXWBEYJDTKUDTM9CSRZGRTKYPSTBYCKPEFA9MKLDWGJKWLFJQXMEXXHGGXACRZFXFVYAEHJL9PRNSGXGRESZRJRNXISBRXT9ACPQKTIQUBGNYHAQCT9YWVYRIZEMGEEPXEMWINNM9MSYUZIXYHBFTAEGJVWVPPDSBRXALMSAJDFFYKFMRNNHXDLPV9ITHHDUYDUVHDOYBQNYPQPSBJASIFBXAXMBAA9STGFVEXWBLLOSSGUFKYJWJKLADDOHRXNZTWGKOM9NNPCVEPSLFEFJVTDFQ9LVHQFTLRSPGEPJLLEDNZZPBOCYCQJCZDTWRHMQ9KKGPEHWROEYXSVDSZYAUZZAJCYKZRNZRWKOMJTUNZGORBLEYUAJTCGOLYPJLGKQWBCWJOJCDWRUIQNIGUEIZVQA9VX9AOZVTNOEKDLHGMLS9MPVGADYAASGLFYWELFLGQNDWSKRZOWZWKXZLO9ACX9YCSPQMVFCEPYZXMMADABHJEH9FOIZHQFEUCZTBFVBMGBGUGVYSPVDPPVBEDPQIWFUTITF9IAFCYLUZSSVOMJNCITBLRLCFGRREHDPYKPUDJWAWARQELWUAGQAKPZHMIGJWLMBQUXOHZFRNQZXSQFRZXEJPZGBYAGFIHEMWOLTXMPWGG9ARSNYJMHUCMDCEUKBQDIQQTDGEDEREOYGPZIUNIUBKTVXCUEDYSWAL9NUTKYVHQCMZORJNLWAEBKQGZYUMXOOZNEAMDTL9GBSEIFDZMJRVLZQHJPZBPT9NMSKYSXBSWVFB9FVSCYNLAQXFCJYVXRIVXWX9YKAJV9AHDIMBWDSEIIRDYOWCEWMSEYNPJNYXRXSRIAGJQUNYVGNEBQPFORPNWPGWGNDFC9HHVPVSOZGUQMIXQZMODTD9MYTY9GKFLTNBWYRB9RW9NGPXXZKTLGTSJWZSITHT9ROUECRBWZQCJBE9FOAQMXHFMHVCYSTILMIAZ9YOJIYTHNHJPGUNSSLSWAYMEO9FYYZURIQEKADETRFKTADKSTMAOASVPXZQEJNU9SSAEEAVOYAEGPONTCBUZESONQQESBKMOMKZ9HUQJ9NAKWVAPANO9XNU9ZOUFDS9JBIMSXXDYLPFVNPTSVGPFHOCKFBXIKEIOFYAAVD9TEDRTXZVNYGH9LLFXTWBNXKVZGDNHDFAYWJXZXXKXGBEIZNMVLOGTAF9WPQLPEBDDATOANFTPWEMFIHLFOGHLWGTHJRUQMMEITRLNACRIHTXBTMBARYWZIUKEMBGNXYJIHJVJJEZJKKKCYHUNOIFNTHVTIOA9RVCVWPAQXLWFRDPXHKBYQDJDMZBRKICVHZDNIKHXTKYCRROBHYQF9YSCVOEWTIUFDDLQBMUNZXUKUM9MWEMEFYDKBSVUYKDWCWEMUVRLE9ZKFKOTUHTCZHIGWDHKRAUTLVXCRIWAIJTJOL9NGCJDBKXZSW9ZUKMJNV9FIUDIPMIFKZEQHUMWJPFINZLXKOBTUJRDFR99BTWMNVGEUKNXXRNQLEZQBEPOFFURYPLT9QGJYWVWHHKIXECQRJXIJT9VYNXTURGDVEOCWORII9LXGS9GUOZUUMVUA9WVMCDXZNY9TTMIQKVTGDOK9INLUX9ZPT9VSKXKTRRYDRZWPCCRNSQBQZXH9TKMVHCHBYNZLEHITQOLTFETJCSZKJIXKXKRHFFCQOLDCGIEMXFCYIYKQJI9IYTFYJGETIXDLTTVELXXDLUOVWLNTWAPPPBIQACJMXPQXWENOFDVNGVKWT9BHJTHCTQNEXRWRWZXGDQJBJ9DCKNBLIAJEOJOCIHNUSVCKUDOTLTHRFXVQVFKTJC9BPIRGCCAEIJUROIGMFLFLYFJJMBPSEWIDMZN9YCXOVWWYFSFTDNBYGVUURVXQZQCCYBWR9BEYDWTBUQIUYX9QGUQXGXOTXTSMTTBMXAGLSKZXLODLFKMWMHUYLKTVYZ9AORUIRKXBMLSQLBDW9EFUFZIUVNCYBIAZKLTTPPCYWPHNCHVCNPBRGYJHHWKSBSVKPWCHICGJZXKE9GSUDXZYUAPLHAKAHYHDXNPHENTERYMMBQOPSQIDENXKLKCEYCPVTZQLEEJVYJZV9BWU999999999999999999999999999ZSZRA9999999999999999999999ZUFJWYD99999999999A99999999FGKNTKWXIRJQCXNYBVSYXKBTASXTIIYVXQCMTWJTMBAQUWBEOTONFRSWL9BBEQPXVIGLENQVIQJNVVYPXOLVGNJUXBMJB9XXEOIDUNVSCWFEUDRCNIRN9MV9XSCKZBGOEOXANBQMPDIMFGJRISMJVLZEYP9Y9A9999DNZOV9LPMY9SCGMEUGKLWDLXFAEOCCGHWQUM9CWIBRFYOOJJLBZTOBAGM9OEWTNYVYTSFEKVOXLSZ9999999999999999999999999999999999999999999999999999999999DTQDEHSRLWURPDNPSCQWYTOVFPB"] });

            const response = await obj.getBundle(Hash.fromTrytes(Trytes.fromString("EZIP9CROCHKXAYAERE9SYIJWEDJNSORJ99EZGYVSNIWLJZGCGGQEP9IYMCSAFKJCMDSVVDRHHMMQ99999")));

            chai.expect(response.transactions.length).to.be.equal(3);
            chai.expect(response.transactions[0].signatureMessageFragment.toTrytes().toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response.transactions[0].address.toTrytes().toString()).to.be.equal("NQWYCOBATZTLRNELEQZKKJHLQETGCKV9FZNIYSBJFFPQGMGSS99GCZWEEYEJYFZYWGDCVDV9YVQZQMLXC");
            chai.expect(response.transactions[0].value.toNumber()).to.be.equal(1);
            chai.expect(response.transactions[0].obsoleteTag.toTrytes().toString()).to.be.equal("AF9999999999999999999999999");
            chai.expect(response.transactions[0].timestamp.toNumber()).to.be.equal(1519058554);
            chai.expect(response.transactions[0].currentIndex.toNumber()).to.be.equal(0);
            chai.expect(response.transactions[0].lastIndex.toNumber()).to.be.equal(2);
            chai.expect(response.transactions[0].bundle.toTrytes().toString()).to.be.equal("EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSD");
            chai.expect(response.transactions[0].trunkTransaction.toTrytes().toString()).to.be.equal("QCWJDQFSGVLSNCLAGZCIDHOQXZPCVJDXOMAZSZJWVDXEDGMLRSHWOOFNVINH9QWEBFRR9JVDSONVZ9999");
            chai.expect(response.transactions[0].branchTransaction.toTrytes().toString()).to.be.equal("PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999");
            chai.expect(response.transactions[0].tag.toTrytes().toString()).to.be.equal("AF9999999999999999999999999");
            chai.expect(response.transactions[0].attachmentTimestamp.toNumber()).to.be.equal(1519059542138);
            chai.expect(response.transactions[0].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response.transactions[0].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response.transactions[0].nonce.toTrytes().toString()).to.be.equal("JCOWHODZ9VWXYOYNTKWWTVY99TJ");

            chai.expect(response.transactions[1].signatureMessageFragment.toTrytes().toString()).to.be.equal("QWBEXIJXCAVCYXRBSWATNNCCRMIVE9SFBUGJAPQKDZDFDJPQASSVFXJDLFDGXZJRYLLSHTMNMO9OYORDCJXUCLRCRIMYZHDFDQXPKKK9HZLTSYWTYZ9MIXICDZSRVKQUUNUWUPQZUPDR9AEOJDRWUVXVSTSDZQRKZCXLTBOQVWMQSWUAIUAQHAINFMJNBMU9IBMVHPXQZLUKQBHMPBDAYAOTMQ9VMDWKXUDYXYXLPJDFVTUIEZAALTWPFIDPQJXXMTZZYWCLAF9HV9ULOZ9PTZIQALISTFUUBZO9CAXYUZKJNWCOWKKAL9HINUXVHZDAXTEWSFDNLGFTANUZSPUACFC9XQPHUWA9JBGJIEMUJTHTTRSGVTLJFEAEIUQLTXLCFTWPAT9RRKK9AGUBNQVXBMRMFCAYKGJFMTC9N9JDQDIVZBNWXDBVLRRSIUBFPTUVHUOEDCWXBEGYKDGEZUEDHPRFSVAJROZUBL9RCWYNYUSB9ULWFIMVGDGEUAMVDDIDLMTHATYKGTHRXVF9ZQRICDHQ9LLJUBRDQUSMNRWDDXSGEETSDJHJDBXMJOUILLLZRVOQHUYTUCGJGKUEQAK9NOJBXFCFLTPLJYCJPEYAJNWLUSQGCCBQSGSQGRMNU9UOW9KDBRHX9NEOZJZCPLIROTZLQSXHXCCRVKXCLGTPRJFPFGDNPJTJNXTPNVLLWTKFFVBTTJIWLXKUCYSURAAIMSIVYUVIXZCMQJNGNXWVUOMSA9YJUVOUPFMDJVVTSRBRUQECYZVXEOGTJCULDSIYZXKIOBGYDJHPBQEJBHUOYWEECTJTEFUYOTXATYKTYRE9FCRSDNGPGEMQQXXBB9VPDVMZKBRQLOE9CRDWJTVPLCCCZYDVMYPOJ9KZCCWE9CLNUTSVGTEAGTJZQQDMIVLYKOEHTQCGQQC9COGLTOQLJENUZNNE9LYAWEPTGAFTQFVBGPEQISVBSEZYPLEMXGAYKAAEA9JDLFFZTKJFTXGFRFWGZWYVVQ9UFCOF9YAL9JCTUJTUQT99VOEAOZHSWQMVXBPKPWNQWRBNHANHIGZUXP99DVUZGAR9PTPGZAEBTEZOAZTPFCDERVCHJVHLTRSQ9TYBSBAZGOHTEEWUJWAYAHNJOXCSM9MYESACAAHRYZJKCMTKUK9AGVECWJHOUYNOVGFCXWDUDGYYK9CHVM9LEESLPWASCQBQZSQPEGMPUNZOVNX9ZFZXUUTJSINYZVDQMHKQJQPOXMCWAMQYXEXXLQRLMXNOSGD9XNYNILMUNDQQOFSJGSTXLPLLGVVXDCKBIQBSKQZLPLGWMGLNLNEJPCBPI9RN9DTIFMBPTKDBUILHKJVMDBJDSBOVZGW9VTJBFXLWPDFWBOQHYHEBUTRDBWHLJMMFQPNXWUCDIRWXCAXZUGWWYGUDRBXRQBPCALK9XPODK9UKEZIKTAWUQYAJYXMRMFGKNDZUD99EMLSRYQDFQXJSMED9MXSEOANTACPTKJALKQIMNUVJBVIAPLSGOJUKAYLHQYH9HSPREYVGSPYGIAATCTICVVDLRRKBFUTDAXL9RXTURNDTIBWUJCCOMGLAIZBJMXGAETNTNNVCPFCJBVBZTSLTUDWSYGYBGTRCNW9IRORFOGKPWRLOOTHNGB999JHAJLMJVGB9WNRIIQKMICAPWNELTHXGRAFCRRIUFPSMJWPSCE9BTVZGYTGNMCCOYZSFDLXDFOHVLFQEWUDWKLJOHRBTGKHILPELTICCXQPLENMGGTFRFDLYJCSUOLXDPS9R9DJDQAGADPAIURGOBFZGBOFJCNIWPCZYAPPCEFXWJYYFLUCI9UXJBOORBQAVEBHFNOSPVUQHFGOTVDJLAFDZLFCGVGKQK9O9PEMHQCKZGPLLJSDNUHOGQYNYQUIUDOKDFARFUJBXOETEYEPSGJDZRJ9JOHWFHIMEWYYPRAYYASCNGXKATILOYGRDU9CBPHD9IGXVVL9AIWRWMRIOGLISRDIJDZZCFME9MHDTZLEETD9WUYBEGD9QSUISAPOBYFGAY9WPZFMENXUILGNBHA9RUSO9AVELPIVFTSFCNQQVCMNDOOXCCNV9VMQHUFGFWTNYBGVXJCVPBDFSNEBQGJHFUSZFEXOANLHMADIXEIVEYMKEHBWJFMNHLBW9OHTNYQJEOZUTKNGAJSEOZHHXWTJBOTZPJJC");
            chai.expect(response.transactions[1].address.toTrytes().toString()).to.be.equal("XECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIB");
            chai.expect(response.transactions[1].value.toNumber()).to.be.equal(-1);
            chai.expect(response.transactions[1].obsoleteTag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response.transactions[1].timestamp.toNumber()).to.be.equal(1519058554);
            chai.expect(response.transactions[1].currentIndex.toNumber()).to.be.equal(1);
            chai.expect(response.transactions[1].lastIndex.toNumber()).to.be.equal(2);
            chai.expect(response.transactions[1].bundle.toTrytes().toString()).to.be.equal("EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSD");
            chai.expect(response.transactions[1].trunkTransaction.toTrytes().toString()).to.be.equal("CSGDIOUGKLKTZQPTPPGOJI9XXKCBSUEKFOEJQZFFRXIVMDJI9AEDFSCKMCEKLZVHCLYYQZH9TZEH99999");
            chai.expect(response.transactions[1].branchTransaction.toTrytes().toString()).to.be.equal("PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999");
            chai.expect(response.transactions[1].tag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response.transactions[1].attachmentTimestamp.toNumber()).to.be.equal(1519059539382);
            chai.expect(response.transactions[1].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response.transactions[1].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response.transactions[1].nonce.toTrytes().toString()).to.be.equal("OLRF9BJFNPFOIURDUIDYUYUPMSX");

            response.transactions[1].currentIndex = TryteNumber.fromNumber(10);

            chai.expect(response.transactions[2].signatureMessageFragment.toTrytes().toString()).to.be.equal("DPXEWZVMOSI9OTSC9YY9IBATBWRIAFOQWLKDUDNWHDKVB99GTKCMCEFITGL9BFCAWBKWKMFNBYTALCO9ZBDESYJHRBOWEYSZLXUPBQUDEK9BFSIMJOABKSYXLPHRJHWDEDRNUTRBLEDUUTIJLCLCNWEEOJJGXNPMWAULVFFZQJDQMBFMASQFOWDWBXVV9TCTBAYRLYRCYHVTRYADD9UXQSORQOULURUGOAJLWDXKXJYTIDVDMEDBJYRMUNWKWNHPDEAULNVXMXILVZEUJCSGOITAK9IHTVXKDMZVBUCXUDYXRQJXNCZCUGFJAHRXKTINEPYWWMKMMGEL9OIZUESMGSUTBHJTIS9HFLZDROHRJYETMWSGDKASTRJKGMVVILGGVJLFR9GXV9DRUVEAEHYRDXOPYYL9TSTDDXGTVUCBUGBQXBVPYRSFDJMBCWFGHAXCI9ZFZZJXI9KBMFXLSM9E9WNMDGLVJNTYNKZZHX9BGUCNKXRY9SRSLWWMQSMNARRGYO9IIPSRABMIFWVOVCZSSYICXQTHU9NHTQGAZTTUII9WPFDUZFMXJAAJQCRBEDLLLVZGUNVDRVETWQNJCTUZAYSCNSFDQPYTIIFZLRULSCXTWHJVYZSARFKCRVZUFRSDPMWFPWXAAVDKVRVIWAWGSTSMIG9LGOYJLXDBYTFPIWITGBUSDBZNTQZCKPJYWAEZWA9AMCLZOHQFFFFVEM99SIWDCIZGDFDZRHMMBVOUCEAOLYKBSGBAEKA9HESFDRJNRMZZD9FGTGLUJLUNVTFWZKGHXLLRQDZDWXBOEOCRCXYQJJVASPNGLQPHGYEFZBEPQJMZUHXFBRGVFBIYJBQUDU9HBTUEPW99GTEJNSZEAWIWRUSSOXDEOTQGJK9TR9RDDPOUTDXPALHKABHKTGRZGSDUCGQVM9OCRVYQRZLAEMZJCD9FLJWPERPUPXIJRZMWGGPYUZHWJZVXOMIMFDLKNMTFOBJSGGBYMTQTCZBYYMQOFVRQB9NDRTRQBGVOGEOMAZLIOQIUJBOVOMUFARUQLBOLA9GZDIGVHZICDCIREHOHQWNFWJPHYZIFQDSBNNOYLNWGWUVIVLYSEHTKXIUBLDRXIHUIHTJJOQQOJJSPNTEZYBIUUSHDONVWPXLGJSBXUQNFJ9RCIPUWZAGNVCNCHGWULQWVJWMMOVWQKGNRBLVOGWLPCH9CPEXWHYWFER9JJTXMV9NFZRQRHBPQXUHMFGSVQUSOIQEYQ9CPUYHCYHLNQPGEUB9BANDSACRIRQOSEKRFZJDBZSOXSUDYHULECYC9LEQCDVWDTAJEGNZHJJYJPJRPQVEHTSAEGEEECUICNVOIP9BASZVMDOMFYCRAWTSJZFZNGEYR9YNCJVRJHRHHRBGSFFEPVUQVARIUZJRTNEWCCMIKZAKTZAXUTARGRGGFJMVODIVDEFHENUYKZUCZMMEDHWFWBXTJRMK9KZBDOAMWYWKRWQVE9IBAQCPFRPWANG9XECCEWHTQMQSKHJZNVIKK9QVIMVUPIGA9MLUNMS9DAQHWXTJVGQBOXVYLZGQHYQKVFCZUXCBXYRUFDUAXOLYDUJKBOCGRCQMNPQGMDPRXZFKSLOGEBKLIORB9TJ9AYBAUXGRTQVNOYNUZS9YPGE9JGWFUHJN9NSANREKHOVEUDHWFTGRDCLGURKINSUL9CQVHLKUMRRELAGJBVKOIVEQPUVCNGIKLNIZZYGYSOLTRTOEDTUTCHUAVSJOAMCYANYMJZLJNRSSJQDPQKW9ALXCDMESFGBB9RXSXIVUYMJPNYWLRTFTKOXOKZIXHBTYCV9UDSJNHDKGXFQXWSMBSP9YNIEEDK9YKPHGZBJTYRWI9EDZYXKJSYZOZOUPDMLQXHJASMYITMKWLNYRAAKAIOSXXPTCESBUJSBCCKJTFMPZYIHRIVJUGKLMHEUFGICXCACN9PNVWEPCJYZZWPVPPZWSZUQUJTWDQZSNPHYSFAPI9FVFOMMEPNXDRZHNVSRSE9YUAYMYPTEBMRA9KXINTPYCXWXEMYZIRDEXAHFJVSGZDDOGJHWBFPHYNDQPBYQUAHHAVTPSGBCKRGJHNLBWQRQLSVW9PHVDFGASIZWEYJFTNUQVBGVKLFWSPESLNFPAOVPXEKMCWAFVDCZSB99UHXECKWUXEHRFXKNH9PPDYTEBXUMQCASX");
            chai.expect(response.transactions[2].address.toTrytes().toString()).to.be.equal("XECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIB");
            chai.expect(response.transactions[2].value.toNumber()).to.be.equal(0);
            chai.expect(response.transactions[2].obsoleteTag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response.transactions[2].timestamp.toNumber()).to.be.equal(1519058554);
            chai.expect(response.transactions[2].currentIndex.toNumber()).to.be.equal(2);
            chai.expect(response.transactions[2].lastIndex.toNumber()).to.be.equal(2);
            chai.expect(response.transactions[2].bundle.toTrytes().toString()).to.be.equal("EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSD");
            chai.expect(response.transactions[2].trunkTransaction.toTrytes().toString()).to.be.equal("PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999");
            chai.expect(response.transactions[2].branchTransaction.toTrytes().toString()).to.be.equal("CRTPYSKRCJPBCJMLGTYWSPQSIVRYCCZAGLJCSDR9BXWDKYLFUGZZFNH9EUSXGOCWHDJNJYLRFETUZ9999");
            chai.expect(response.transactions[2].tag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response.transactions[2].attachmentTimestamp.toNumber()).to.be.equal(1519059539311);
            chai.expect(response.transactions[2].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response.transactions[2].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response.transactions[2].nonce.toTrytes().toString()).to.be.equal("AJNKZDXLQN9AYHXWIRTBGASOVXP");
        });
    });

    describe("traverseBundle", () => {
        it("can fail with invalid trunkTransaction", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.traverseBundle(undefined);
                chai.assert("Should have failed");
            } catch (err) {
                chai.expect(err.message).to.contain("The trunkTransaction");
            }
        });

        it("can fail with empty getTrytes response", async () => {
            const obj = new TransactionClient(apiClientStub);
            apiClientStub.getTrytes = sandbox.stub().resolves(undefined);
            try {
                await obj.traverseBundle(Hash.fromTrytes(Trytes.fromString("EZIP9CROCHKXAYAERE9SYIJWEDJNSORJ99EZGYVSNIWLJZGCGGQEP9IYMCSAFKJCMDSVVDRHHMMQ99999")));
                chai.assert("Should have failed");
            } catch (err) {
                chai.expect(err.message).to.contain("transactions not visible");
            }
        });

        it("can fail if first transaction is not a tail", async () => {
            const obj = new TransactionClient(apiClientStub);
            // tslint:disable:max-line-length
            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: ["QWBEXIJXCAVCYXRBSWATNNCCRMIVE9SFBUGJAPQKDZDFDJPQASSVFXJDLFDGXZJRYLLSHTMNMO9OYORDCJXUCLRCRIMYZHDFDQXPKKK9HZLTSYWTYZ9MIXICDZSRVKQUUNUWUPQZUPDR9AEOJDRWUVXVSTSDZQRKZCXLTBOQVWMQSWUAIUAQHAINFMJNBMU9IBMVHPXQZLUKQBHMPBDAYAOTMQ9VMDWKXUDYXYXLPJDFVTUIEZAALTWPFIDPQJXXMTZZYWCLAF9HV9ULOZ9PTZIQALISTFUUBZO9CAXYUZKJNWCOWKKAL9HINUXVHZDAXTEWSFDNLGFTANUZSPUACFC9XQPHUWA9JBGJIEMUJTHTTRSGVTLJFEAEIUQLTXLCFTWPAT9RRKK9AGUBNQVXBMRMFCAYKGJFMTC9N9JDQDIVZBNWXDBVLRRSIUBFPTUVHUOEDCWXBEGYKDGEZUEDHPRFSVAJROZUBL9RCWYNYUSB9ULWFIMVGDGEUAMVDDIDLMTHATYKGTHRXVF9ZQRICDHQ9LLJUBRDQUSMNRWDDXSGEETSDJHJDBXMJOUILLLZRVOQHUYTUCGJGKUEQAK9NOJBXFCFLTPLJYCJPEYAJNWLUSQGCCBQSGSQGRMNU9UOW9KDBRHX9NEOZJZCPLIROTZLQSXHXCCRVKXCLGTPRJFPFGDNPJTJNXTPNVLLWTKFFVBTTJIWLXKUCYSURAAIMSIVYUVIXZCMQJNGNXWVUOMSA9YJUVOUPFMDJVVTSRBRUQECYZVXEOGTJCULDSIYZXKIOBGYDJHPBQEJBHUOYWEECTJTEFUYOTXATYKTYRE9FCRSDNGPGEMQQXXBB9VPDVMZKBRQLOE9CRDWJTVPLCCCZYDVMYPOJ9KZCCWE9CLNUTSVGTEAGTJZQQDMIVLYKOEHTQCGQQC9COGLTOQLJENUZNNE9LYAWEPTGAFTQFVBGPEQISVBSEZYPLEMXGAYKAAEA9JDLFFZTKJFTXGFRFWGZWYVVQ9UFCOF9YAL9JCTUJTUQT99VOEAOZHSWQMVXBPKPWNQWRBNHANHIGZUXP99DVUZGAR9PTPGZAEBTEZOAZTPFCDERVCHJVHLTRSQ9TYBSBAZGOHTEEWUJWAYAHNJOXCSM9MYESACAAHRYZJKCMTKUK9AGVECWJHOUYNOVGFCXWDUDGYYK9CHVM9LEESLPWASCQBQZSQPEGMPUNZOVNX9ZFZXUUTJSINYZVDQMHKQJQPOXMCWAMQYXEXXLQRLMXNOSGD9XNYNILMUNDQQOFSJGSTXLPLLGVVXDCKBIQBSKQZLPLGWMGLNLNEJPCBPI9RN9DTIFMBPTKDBUILHKJVMDBJDSBOVZGW9VTJBFXLWPDFWBOQHYHEBUTRDBWHLJMMFQPNXWUCDIRWXCAXZUGWWYGUDRBXRQBPCALK9XPODK9UKEZIKTAWUQYAJYXMRMFGKNDZUD99EMLSRYQDFQXJSMED9MXSEOANTACPTKJALKQIMNUVJBVIAPLSGOJUKAYLHQYH9HSPREYVGSPYGIAATCTICVVDLRRKBFUTDAXL9RXTURNDTIBWUJCCOMGLAIZBJMXGAETNTNNVCPFCJBVBZTSLTUDWSYGYBGTRCNW9IRORFOGKPWRLOOTHNGB999JHAJLMJVGB9WNRIIQKMICAPWNELTHXGRAFCRRIUFPSMJWPSCE9BTVZGYTGNMCCOYZSFDLXDFOHVLFQEWUDWKLJOHRBTGKHILPELTICCXQPLENMGGTFRFDLYJCSUOLXDPS9R9DJDQAGADPAIURGOBFZGBOFJCNIWPCZYAPPCEFXWJYYFLUCI9UXJBOORBQAVEBHFNOSPVUQHFGOTVDJLAFDZLFCGVGKQK9O9PEMHQCKZGPLLJSDNUHOGQYNYQUIUDOKDFARFUJBXOETEYEPSGJDZRJ9JOHWFHIMEWYYPRAYYASCNGXKATILOYGRDU9CBPHD9IGXVVL9AIWRWMRIOGLISRDIJDZZCFME9MHDTZLEETD9WUYBEGD9QSUISAPOBYFGAY9WPZFMENXUILGNBHA9RUSO9AVELPIVFTSFCNQQVCMNDOOXCCNV9VMQHUFGFWTNYBGVXJCVPBDFSNEBQGJHFUSZFEXOANLHMADIXEIVEYMKEHBWJFMNHLBW9OHTNYQJEOZUTKNGAJSEOZHHXWTJBOTZPJJCXECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIBZ99999999999999999999999999999999999999999999999999999YPEJWYD99A99999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDCSGDIOUGKLKTZQPTPPGOJI9XXKCBSUEKFOEJQZFFRXIVMDJI9AEDFSCKMCEKLZVHCLYYQZH9TZEH99999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999999999999999999999999999999OOBNXZFJE999999999L99999999OLRF9BJFNPFOIURDUIDYUYUPMSX"] });

            try {
                await obj.traverseBundle(Hash.fromTrytes(Trytes.fromString("EZIP9CROCHKXAYAERE9SYIJWEDJNSORJ99EZGYVSNIWLJZGCGGQEP9IYMCSAFKJCMDSVVDRHHMMQ99999")));
                chai.assert("Should have failed");
            } catch (err) {
                chai.expect(err.message).to.contain("tail transaction supplied");
            }
        });

        it("can succeed with single element", async () => {
            const obj = new TransactionClient(apiClientStub);
            // tslint:disable:max-line-length
            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999NQWYCOBATZTLRNELEQZKKJHLQETGCKV9FZNIYSBJFFPQGMGSS99GCZWEEYEJYFZYWGDCVDV9YVQZQMLXCA99999999999999999999999999AF9999999999999999999999999YPEJWYD99999999999999999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDQCWJDQFSGVLSNCLAGZCIDHOQXZPCVJDXOMAZSZJWVDXEDGMLRSHWOOFNVINH9QWEBFRR9JVDSONVZ9999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999AF9999999999999999999999999QIENXZFJE999999999L99999999JCOWHODZ9VWXYOYNTKWWTVY99TJ"] });

            const response = await obj.traverseBundle(Hash.fromTrytes(Trytes.fromString("EZIP9CROCHKXAYAERE9SYIJWEDJNSORJ99EZGYVSNIWLJZGCGGQEP9IYMCSAFKJCMDSVVDRHHMMQ99999")));

            chai.expect(response.length).to.be.equal(1);
            chai.expect(response[0].signatureMessageFragment.toTrytes().toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[0].address.toTrytes().toString()).to.be.equal("NQWYCOBATZTLRNELEQZKKJHLQETGCKV9FZNIYSBJFFPQGMGSS99GCZWEEYEJYFZYWGDCVDV9YVQZQMLXC");
            chai.expect(response[0].value.toNumber()).to.be.equal(1);
            chai.expect(response[0].obsoleteTag.toTrytes().toString()).to.be.equal("AF9999999999999999999999999");
            chai.expect(response[0].timestamp.toNumber()).to.be.equal(1519058554);
            chai.expect(response[0].currentIndex.toNumber()).to.be.equal(0);
            chai.expect(response[0].lastIndex.toNumber()).to.be.equal(0);
            chai.expect(response[0].bundle.toTrytes().toString()).to.be.equal("EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSD");
            chai.expect(response[0].trunkTransaction.toTrytes().toString()).to.be.equal("QCWJDQFSGVLSNCLAGZCIDHOQXZPCVJDXOMAZSZJWVDXEDGMLRSHWOOFNVINH9QWEBFRR9JVDSONVZ9999");
            chai.expect(response[0].branchTransaction.toTrytes().toString()).to.be.equal("PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999");
            chai.expect(response[0].tag.toTrytes().toString()).to.be.equal("AF9999999999999999999999999");
            chai.expect(response[0].attachmentTimestamp.toNumber()).to.be.equal(1519059542138);
            chai.expect(response[0].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response[0].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response[0].nonce.toTrytes().toString()).to.be.equal("JCOWHODZ9VWXYOYNTKWWTVY99TJ");
        });

        it("can traverse bundles", async () => {
            const obj = new TransactionClient(apiClientStub);

            // tslint:disable:max-line-length
            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999NQWYCOBATZTLRNELEQZKKJHLQETGCKV9FZNIYSBJFFPQGMGSS99GCZWEEYEJYFZYWGDCVDV9YVQZQMLXCA99999999999999999999999999AF9999999999999999999999999YPEJWYD99999999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDQCWJDQFSGVLSNCLAGZCIDHOQXZPCVJDXOMAZSZJWVDXEDGMLRSHWOOFNVINH9QWEBFRR9JVDSONVZ9999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999AF9999999999999999999999999QIENXZFJE999999999L99999999JCOWHODZ9VWXYOYNTKWWTVY99TJ"] })
                .onSecondCall().resolves({ trytes: ["QWBEXIJXCAVCYXRBSWATNNCCRMIVE9SFBUGJAPQKDZDFDJPQASSVFXJDLFDGXZJRYLLSHTMNMO9OYORDCJXUCLRCRIMYZHDFDQXPKKK9HZLTSYWTYZ9MIXICDZSRVKQUUNUWUPQZUPDR9AEOJDRWUVXVSTSDZQRKZCXLTBOQVWMQSWUAIUAQHAINFMJNBMU9IBMVHPXQZLUKQBHMPBDAYAOTMQ9VMDWKXUDYXYXLPJDFVTUIEZAALTWPFIDPQJXXMTZZYWCLAF9HV9ULOZ9PTZIQALISTFUUBZO9CAXYUZKJNWCOWKKAL9HINUXVHZDAXTEWSFDNLGFTANUZSPUACFC9XQPHUWA9JBGJIEMUJTHTTRSGVTLJFEAEIUQLTXLCFTWPAT9RRKK9AGUBNQVXBMRMFCAYKGJFMTC9N9JDQDIVZBNWXDBVLRRSIUBFPTUVHUOEDCWXBEGYKDGEZUEDHPRFSVAJROZUBL9RCWYNYUSB9ULWFIMVGDGEUAMVDDIDLMTHATYKGTHRXVF9ZQRICDHQ9LLJUBRDQUSMNRWDDXSGEETSDJHJDBXMJOUILLLZRVOQHUYTUCGJGKUEQAK9NOJBXFCFLTPLJYCJPEYAJNWLUSQGCCBQSGSQGRMNU9UOW9KDBRHX9NEOZJZCPLIROTZLQSXHXCCRVKXCLGTPRJFPFGDNPJTJNXTPNVLLWTKFFVBTTJIWLXKUCYSURAAIMSIVYUVIXZCMQJNGNXWVUOMSA9YJUVOUPFMDJVVTSRBRUQECYZVXEOGTJCULDSIYZXKIOBGYDJHPBQEJBHUOYWEECTJTEFUYOTXATYKTYRE9FCRSDNGPGEMQQXXBB9VPDVMZKBRQLOE9CRDWJTVPLCCCZYDVMYPOJ9KZCCWE9CLNUTSVGTEAGTJZQQDMIVLYKOEHTQCGQQC9COGLTOQLJENUZNNE9LYAWEPTGAFTQFVBGPEQISVBSEZYPLEMXGAYKAAEA9JDLFFZTKJFTXGFRFWGZWYVVQ9UFCOF9YAL9JCTUJTUQT99VOEAOZHSWQMVXBPKPWNQWRBNHANHIGZUXP99DVUZGAR9PTPGZAEBTEZOAZTPFCDERVCHJVHLTRSQ9TYBSBAZGOHTEEWUJWAYAHNJOXCSM9MYESACAAHRYZJKCMTKUK9AGVECWJHOUYNOVGFCXWDUDGYYK9CHVM9LEESLPWASCQBQZSQPEGMPUNZOVNX9ZFZXUUTJSINYZVDQMHKQJQPOXMCWAMQYXEXXLQRLMXNOSGD9XNYNILMUNDQQOFSJGSTXLPLLGVVXDCKBIQBSKQZLPLGWMGLNLNEJPCBPI9RN9DTIFMBPTKDBUILHKJVMDBJDSBOVZGW9VTJBFXLWPDFWBOQHYHEBUTRDBWHLJMMFQPNXWUCDIRWXCAXZUGWWYGUDRBXRQBPCALK9XPODK9UKEZIKTAWUQYAJYXMRMFGKNDZUD99EMLSRYQDFQXJSMED9MXSEOANTACPTKJALKQIMNUVJBVIAPLSGOJUKAYLHQYH9HSPREYVGSPYGIAATCTICVVDLRRKBFUTDAXL9RXTURNDTIBWUJCCOMGLAIZBJMXGAETNTNNVCPFCJBVBZTSLTUDWSYGYBGTRCNW9IRORFOGKPWRLOOTHNGB999JHAJLMJVGB9WNRIIQKMICAPWNELTHXGRAFCRRIUFPSMJWPSCE9BTVZGYTGNMCCOYZSFDLXDFOHVLFQEWUDWKLJOHRBTGKHILPELTICCXQPLENMGGTFRFDLYJCSUOLXDPS9R9DJDQAGADPAIURGOBFZGBOFJCNIWPCZYAPPCEFXWJYYFLUCI9UXJBOORBQAVEBHFNOSPVUQHFGOTVDJLAFDZLFCGVGKQK9O9PEMHQCKZGPLLJSDNUHOGQYNYQUIUDOKDFARFUJBXOETEYEPSGJDZRJ9JOHWFHIMEWYYPRAYYASCNGXKATILOYGRDU9CBPHD9IGXVVL9AIWRWMRIOGLISRDIJDZZCFME9MHDTZLEETD9WUYBEGD9QSUISAPOBYFGAY9WPZFMENXUILGNBHA9RUSO9AVELPIVFTSFCNQQVCMNDOOXCCNV9VMQHUFGFWTNYBGVXJCVPBDFSNEBQGJHFUSZFEXOANLHMADIXEIVEYMKEHBWJFMNHLBW9OHTNYQJEOZUTKNGAJSEOZHHXWTJBOTZPJJCXECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIBZ99999999999999999999999999999999999999999999999999999YPEJWYD99A99999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDCSGDIOUGKLKTZQPTPPGOJI9XXKCBSUEKFOEJQZFFRXIVMDJI9AEDFSCKMCEKLZVHCLYYQZH9TZEH99999PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999999999999999999999999999999OOBNXZFJE999999999L99999999OLRF9BJFNPFOIURDUIDYUYUPMSX"] })
                .onThirdCall().resolves({ trytes: ["DPXEWZVMOSI9OTSC9YY9IBATBWRIAFOQWLKDUDNWHDKVB99GTKCMCEFITGL9BFCAWBKWKMFNBYTALCO9ZBDESYJHRBOWEYSZLXUPBQUDEK9BFSIMJOABKSYXLPHRJHWDEDRNUTRBLEDUUTIJLCLCNWEEOJJGXNPMWAULVFFZQJDQMBFMASQFOWDWBXVV9TCTBAYRLYRCYHVTRYADD9UXQSORQOULURUGOAJLWDXKXJYTIDVDMEDBJYRMUNWKWNHPDEAULNVXMXILVZEUJCSGOITAK9IHTVXKDMZVBUCXUDYXRQJXNCZCUGFJAHRXKTINEPYWWMKMMGEL9OIZUESMGSUTBHJTIS9HFLZDROHRJYETMWSGDKASTRJKGMVVILGGVJLFR9GXV9DRUVEAEHYRDXOPYYL9TSTDDXGTVUCBUGBQXBVPYRSFDJMBCWFGHAXCI9ZFZZJXI9KBMFXLSM9E9WNMDGLVJNTYNKZZHX9BGUCNKXRY9SRSLWWMQSMNARRGYO9IIPSRABMIFWVOVCZSSYICXQTHU9NHTQGAZTTUII9WPFDUZFMXJAAJQCRBEDLLLVZGUNVDRVETWQNJCTUZAYSCNSFDQPYTIIFZLRULSCXTWHJVYZSARFKCRVZUFRSDPMWFPWXAAVDKVRVIWAWGSTSMIG9LGOYJLXDBYTFPIWITGBUSDBZNTQZCKPJYWAEZWA9AMCLZOHQFFFFVEM99SIWDCIZGDFDZRHMMBVOUCEAOLYKBSGBAEKA9HESFDRJNRMZZD9FGTGLUJLUNVTFWZKGHXLLRQDZDWXBOEOCRCXYQJJVASPNGLQPHGYEFZBEPQJMZUHXFBRGVFBIYJBQUDU9HBTUEPW99GTEJNSZEAWIWRUSSOXDEOTQGJK9TR9RDDPOUTDXPALHKABHKTGRZGSDUCGQVM9OCRVYQRZLAEMZJCD9FLJWPERPUPXIJRZMWGGPYUZHWJZVXOMIMFDLKNMTFOBJSGGBYMTQTCZBYYMQOFVRQB9NDRTRQBGVOGEOMAZLIOQIUJBOVOMUFARUQLBOLA9GZDIGVHZICDCIREHOHQWNFWJPHYZIFQDSBNNOYLNWGWUVIVLYSEHTKXIUBLDRXIHUIHTJJOQQOJJSPNTEZYBIUUSHDONVWPXLGJSBXUQNFJ9RCIPUWZAGNVCNCHGWULQWVJWMMOVWQKGNRBLVOGWLPCH9CPEXWHYWFER9JJTXMV9NFZRQRHBPQXUHMFGSVQUSOIQEYQ9CPUYHCYHLNQPGEUB9BANDSACRIRQOSEKRFZJDBZSOXSUDYHULECYC9LEQCDVWDTAJEGNZHJJYJPJRPQVEHTSAEGEEECUICNVOIP9BASZVMDOMFYCRAWTSJZFZNGEYR9YNCJVRJHRHHRBGSFFEPVUQVARIUZJRTNEWCCMIKZAKTZAXUTARGRGGFJMVODIVDEFHENUYKZUCZMMEDHWFWBXTJRMK9KZBDOAMWYWKRWQVE9IBAQCPFRPWANG9XECCEWHTQMQSKHJZNVIKK9QVIMVUPIGA9MLUNMS9DAQHWXTJVGQBOXVYLZGQHYQKVFCZUXCBXYRUFDUAXOLYDUJKBOCGRCQMNPQGMDPRXZFKSLOGEBKLIORB9TJ9AYBAUXGRTQVNOYNUZS9YPGE9JGWFUHJN9NSANREKHOVEUDHWFTGRDCLGURKINSUL9CQVHLKUMRRELAGJBVKOIVEQPUVCNGIKLNIZZYGYSOLTRTOEDTUTCHUAVSJOAMCYANYMJZLJNRSSJQDPQKW9ALXCDMESFGBB9RXSXIVUYMJPNYWLRTFTKOXOKZIXHBTYCV9UDSJNHDKGXFQXWSMBSP9YNIEEDK9YKPHGZBJTYRWI9EDZYXKJSYZOZOUPDMLQXHJASMYITMKWLNYRAAKAIOSXXPTCESBUJSBCCKJTFMPZYIHRIVJUGKLMHEUFGICXCACN9PNVWEPCJYZZWPVPPZWSZUQUJTWDQZSNPHYSFAPI9FVFOMMEPNXDRZHNVSRSE9YUAYMYPTEBMRA9KXINTPYCXWXEMYZIRDEXAHFJVSGZDDOGJHWBFPHYNDQPBYQUAHHAVTPSGBCKRGJHNLBWQRQLSVW9PHVDFGASIZWEYJFTNUQVBGVKLFWSPESLNFPAOVPXEKMCWAFVDCZSB99UHXECKWUXEHRFXKNH9PPDYTEBXUMQCASXXECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIB999999999999999999999999999999999999999999999999999999YPEJWYD99B99999999B99999999EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSDPWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999CRTPYSKRCJPBCJMLGTYWSPQSIVRYCCZAGLJCSDR9BXWDKYLFUGZZFNH9EUSXGOCWHDJNJYLRFETUZ9999999999999999999999999999999YLANXZFJE999999999L99999999AJNKZDXLQN9AYHXWIRTBGASOVXP"] })
                .onCall(3).resolves({ trytes: ["KZXCRXMKOQSVDFUJND9DYSUSAJLRMGISKXJIUPSCSVBTYKERFCJFKXRNPIZDCXASVAYTDLVYNVQBMDOGGDFXOQLQBYTLJIUDSFSEDPTTC9LBLHVRLJO9XXIJITGDGFXSCQZPGOIUHXTLPBDXQYXXUOABECYAYDPVJTHBYBMTJYXWBEYJDTKUDTM9CSRZGRTKYPSTBYCKPEFA9MKLDWGJKWLFJQXMEXXHGGXACRZFXFVYAEHJL9PRNSGXGRESZRJRNXISBRXT9ACPQKTIQUBGNYHAQCT9YWVYRIZEMGEEPXEMWINNM9MSYUZIXYHBFTAEGJVWVPPDSBRXALMSAJDFFYKFMRNNHXDLPV9ITHHDUYDUVHDOYBQNYPQPSBJASIFBXAXMBAA9STGFVEXWBLLOSSGUFKYJWJKLADDOHRXNZTWGKOM9NNPCVEPSLFEFJVTDFQ9LVHQFTLRSPGEPJLLEDNZZPBOCYCQJCZDTWRHMQ9KKGPEHWROEYXSVDSZYAUZZAJCYKZRNZRWKOMJTUNZGORBLEYUAJTCGOLYPJLGKQWBCWJOJCDWRUIQNIGUEIZVQA9VX9AOZVTNOEKDLHGMLS9MPVGADYAASGLFYWELFLGQNDWSKRZOWZWKXZLO9ACX9YCSPQMVFCEPYZXMMADABHJEH9FOIZHQFEUCZTBFVBMGBGUGVYSPVDPPVBEDPQIWFUTITF9IAFCYLUZSSVOMJNCITBLRLCFGRREHDPYKPUDJWAWARQELWUAGQAKPZHMIGJWLMBQUXOHZFRNQZXSQFRZXEJPZGBYAGFIHEMWOLTXMPWGG9ARSNYJMHUCMDCEUKBQDIQQTDGEDEREOYGPZIUNIUBKTVXCUEDYSWAL9NUTKYVHQCMZORJNLWAEBKQGZYUMXOOZNEAMDTL9GBSEIFDZMJRVLZQHJPZBPT9NMSKYSXBSWVFB9FVSCYNLAQXFCJYVXRIVXWX9YKAJV9AHDIMBWDSEIIRDYOWCEWMSEYNPJNYXRXSRIAGJQUNYVGNEBQPFORPNWPGWGNDFC9HHVPVSOZGUQMIXQZMODTD9MYTY9GKFLTNBWYRB9RW9NGPXXZKTLGTSJWZSITHT9ROUECRBWZQCJBE9FOAQMXHFMHVCYSTILMIAZ9YOJIYTHNHJPGUNSSLSWAYMEO9FYYZURIQEKADETRFKTADKSTMAOASVPXZQEJNU9SSAEEAVOYAEGPONTCBUZESONQQESBKMOMKZ9HUQJ9NAKWVAPANO9XNU9ZOUFDS9JBIMSXXDYLPFVNPTSVGPFHOCKFBXIKEIOFYAAVD9TEDRTXZVNYGH9LLFXTWBNXKVZGDNHDFAYWJXZXXKXGBEIZNMVLOGTAF9WPQLPEBDDATOANFTPWEMFIHLFOGHLWGTHJRUQMMEITRLNACRIHTXBTMBARYWZIUKEMBGNXYJIHJVJJEZJKKKCYHUNOIFNTHVTIOA9RVCVWPAQXLWFRDPXHKBYQDJDMZBRKICVHZDNIKHXTKYCRROBHYQF9YSCVOEWTIUFDDLQBMUNZXUKUM9MWEMEFYDKBSVUYKDWCWEMUVRLE9ZKFKOTUHTCZHIGWDHKRAUTLVXCRIWAIJTJOL9NGCJDBKXZSW9ZUKMJNV9FIUDIPMIFKZEQHUMWJPFINZLXKOBTUJRDFR99BTWMNVGEUKNXXRNQLEZQBEPOFFURYPLT9QGJYWVWHHKIXECQRJXIJT9VYNXTURGDVEOCWORII9LXGS9GUOZUUMVUA9WVMCDXZNY9TTMIQKVTGDOK9INLUX9ZPT9VSKXKTRRYDRZWPCCRNSQBQZXH9TKMVHCHBYNZLEHITQOLTFETJCSZKJIXKXKRHFFCQOLDCGIEMXFCYIYKQJI9IYTFYJGETIXDLTTVELXXDLUOVWLNTWAPPPBIQACJMXPQXWENOFDVNGVKWT9BHJTHCTQNEXRWRWZXGDQJBJ9DCKNBLIAJEOJOCIHNUSVCKUDOTLTHRFXVQVFKTJC9BPIRGCCAEIJUROIGMFLFLYFJJMBPSEWIDMZN9YCXOVWWYFSFTDNBYGVUURVXQZQCCYBWR9BEYDWTBUQIUYX9QGUQXGXOTXTSMTTBMXAGLSKZXLODLFKMWMHUYLKTVYZ9AORUIRKXBMLSQLBDW9EFUFZIUVNCYBIAZKLTTPPCYWPHNCHVCNPBRGYJHHWKSBSVKPWCHICGJZXKE9GSUDXZYUAPLHAKAHYHDXNPHENTERYMMBQOPSQIDENXKLKCEYCPVTZQLEEJVYJZV9BWU999999999999999999999999999ZSZRA9999999999999999999999ZUFJWYD99999999999A99999999FGKNTKWXIRJQCXNYBVSYXKBTASXTIIYVXQCMTWJTMBAQUWBEOTONFRSWL9BBEQPXVIGLENQVIQJNVVYPXOLVGNJUXBMJB9XXEOIDUNVSCWFEUDRCNIRN9MV9XSCKZBGOEOXANBQMPDIMFGJRISMJVLZEYP9Y9A9999DNZOV9LPMY9SCGMEUGKLWDLXFAEOCCGHWQUM9CWIBRFYOOJJLBZTOBAGM9OEWTNYVYTSFEKVOXLSZ9999999999999999999999999999999999999999999999999999999999DTQDEHSRLWURPDNPSCQWYTOVFPB"] });

            const response = await obj.traverseBundle(Hash.fromTrytes(Trytes.fromString("EZIP9CROCHKXAYAERE9SYIJWEDJNSORJ99EZGYVSNIWLJZGCGGQEP9IYMCSAFKJCMDSVVDRHHMMQ99999")));

            chai.expect(response.length).to.be.equal(3);
            chai.expect(response[0].signatureMessageFragment.toTrytes().toString()).to.be.equal("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999");
            chai.expect(response[0].address.toTrytes().toString()).to.be.equal("NQWYCOBATZTLRNELEQZKKJHLQETGCKV9FZNIYSBJFFPQGMGSS99GCZWEEYEJYFZYWGDCVDV9YVQZQMLXC");
            chai.expect(response[0].value.toNumber()).to.be.equal(1);
            chai.expect(response[0].obsoleteTag.toTrytes().toString()).to.be.equal("AF9999999999999999999999999");
            chai.expect(response[0].timestamp.toNumber()).to.be.equal(1519058554);
            chai.expect(response[0].currentIndex.toNumber()).to.be.equal(0);
            chai.expect(response[0].lastIndex.toNumber()).to.be.equal(2);
            chai.expect(response[0].bundle.toTrytes().toString()).to.be.equal("EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSD");
            chai.expect(response[0].trunkTransaction.toTrytes().toString()).to.be.equal("QCWJDQFSGVLSNCLAGZCIDHOQXZPCVJDXOMAZSZJWVDXEDGMLRSHWOOFNVINH9QWEBFRR9JVDSONVZ9999");
            chai.expect(response[0].branchTransaction.toTrytes().toString()).to.be.equal("PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999");
            chai.expect(response[0].tag.toTrytes().toString()).to.be.equal("AF9999999999999999999999999");
            chai.expect(response[0].attachmentTimestamp.toNumber()).to.be.equal(1519059542138);
            chai.expect(response[0].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response[0].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response[0].nonce.toTrytes().toString()).to.be.equal("JCOWHODZ9VWXYOYNTKWWTVY99TJ");

            chai.expect(response[1].signatureMessageFragment.toTrytes().toString()).to.be.equal("QWBEXIJXCAVCYXRBSWATNNCCRMIVE9SFBUGJAPQKDZDFDJPQASSVFXJDLFDGXZJRYLLSHTMNMO9OYORDCJXUCLRCRIMYZHDFDQXPKKK9HZLTSYWTYZ9MIXICDZSRVKQUUNUWUPQZUPDR9AEOJDRWUVXVSTSDZQRKZCXLTBOQVWMQSWUAIUAQHAINFMJNBMU9IBMVHPXQZLUKQBHMPBDAYAOTMQ9VMDWKXUDYXYXLPJDFVTUIEZAALTWPFIDPQJXXMTZZYWCLAF9HV9ULOZ9PTZIQALISTFUUBZO9CAXYUZKJNWCOWKKAL9HINUXVHZDAXTEWSFDNLGFTANUZSPUACFC9XQPHUWA9JBGJIEMUJTHTTRSGVTLJFEAEIUQLTXLCFTWPAT9RRKK9AGUBNQVXBMRMFCAYKGJFMTC9N9JDQDIVZBNWXDBVLRRSIUBFPTUVHUOEDCWXBEGYKDGEZUEDHPRFSVAJROZUBL9RCWYNYUSB9ULWFIMVGDGEUAMVDDIDLMTHATYKGTHRXVF9ZQRICDHQ9LLJUBRDQUSMNRWDDXSGEETSDJHJDBXMJOUILLLZRVOQHUYTUCGJGKUEQAK9NOJBXFCFLTPLJYCJPEYAJNWLUSQGCCBQSGSQGRMNU9UOW9KDBRHX9NEOZJZCPLIROTZLQSXHXCCRVKXCLGTPRJFPFGDNPJTJNXTPNVLLWTKFFVBTTJIWLXKUCYSURAAIMSIVYUVIXZCMQJNGNXWVUOMSA9YJUVOUPFMDJVVTSRBRUQECYZVXEOGTJCULDSIYZXKIOBGYDJHPBQEJBHUOYWEECTJTEFUYOTXATYKTYRE9FCRSDNGPGEMQQXXBB9VPDVMZKBRQLOE9CRDWJTVPLCCCZYDVMYPOJ9KZCCWE9CLNUTSVGTEAGTJZQQDMIVLYKOEHTQCGQQC9COGLTOQLJENUZNNE9LYAWEPTGAFTQFVBGPEQISVBSEZYPLEMXGAYKAAEA9JDLFFZTKJFTXGFRFWGZWYVVQ9UFCOF9YAL9JCTUJTUQT99VOEAOZHSWQMVXBPKPWNQWRBNHANHIGZUXP99DVUZGAR9PTPGZAEBTEZOAZTPFCDERVCHJVHLTRSQ9TYBSBAZGOHTEEWUJWAYAHNJOXCSM9MYESACAAHRYZJKCMTKUK9AGVECWJHOUYNOVGFCXWDUDGYYK9CHVM9LEESLPWASCQBQZSQPEGMPUNZOVNX9ZFZXUUTJSINYZVDQMHKQJQPOXMCWAMQYXEXXLQRLMXNOSGD9XNYNILMUNDQQOFSJGSTXLPLLGVVXDCKBIQBSKQZLPLGWMGLNLNEJPCBPI9RN9DTIFMBPTKDBUILHKJVMDBJDSBOVZGW9VTJBFXLWPDFWBOQHYHEBUTRDBWHLJMMFQPNXWUCDIRWXCAXZUGWWYGUDRBXRQBPCALK9XPODK9UKEZIKTAWUQYAJYXMRMFGKNDZUD99EMLSRYQDFQXJSMED9MXSEOANTACPTKJALKQIMNUVJBVIAPLSGOJUKAYLHQYH9HSPREYVGSPYGIAATCTICVVDLRRKBFUTDAXL9RXTURNDTIBWUJCCOMGLAIZBJMXGAETNTNNVCPFCJBVBZTSLTUDWSYGYBGTRCNW9IRORFOGKPWRLOOTHNGB999JHAJLMJVGB9WNRIIQKMICAPWNELTHXGRAFCRRIUFPSMJWPSCE9BTVZGYTGNMCCOYZSFDLXDFOHVLFQEWUDWKLJOHRBTGKHILPELTICCXQPLENMGGTFRFDLYJCSUOLXDPS9R9DJDQAGADPAIURGOBFZGBOFJCNIWPCZYAPPCEFXWJYYFLUCI9UXJBOORBQAVEBHFNOSPVUQHFGOTVDJLAFDZLFCGVGKQK9O9PEMHQCKZGPLLJSDNUHOGQYNYQUIUDOKDFARFUJBXOETEYEPSGJDZRJ9JOHWFHIMEWYYPRAYYASCNGXKATILOYGRDU9CBPHD9IGXVVL9AIWRWMRIOGLISRDIJDZZCFME9MHDTZLEETD9WUYBEGD9QSUISAPOBYFGAY9WPZFMENXUILGNBHA9RUSO9AVELPIVFTSFCNQQVCMNDOOXCCNV9VMQHUFGFWTNYBGVXJCVPBDFSNEBQGJHFUSZFEXOANLHMADIXEIVEYMKEHBWJFMNHLBW9OHTNYQJEOZUTKNGAJSEOZHHXWTJBOTZPJJC");
            chai.expect(response[1].address.toTrytes().toString()).to.be.equal("XECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIB");
            chai.expect(response[1].value.toNumber()).to.be.equal(-1);
            chai.expect(response[1].obsoleteTag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response[1].timestamp.toNumber()).to.be.equal(1519058554);
            chai.expect(response[1].currentIndex.toNumber()).to.be.equal(1);
            chai.expect(response[1].lastIndex.toNumber()).to.be.equal(2);
            chai.expect(response[1].bundle.toTrytes().toString()).to.be.equal("EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSD");
            chai.expect(response[1].trunkTransaction.toTrytes().toString()).to.be.equal("CSGDIOUGKLKTZQPTPPGOJI9XXKCBSUEKFOEJQZFFRXIVMDJI9AEDFSCKMCEKLZVHCLYYQZH9TZEH99999");
            chai.expect(response[1].branchTransaction.toTrytes().toString()).to.be.equal("PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999");
            chai.expect(response[1].tag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response[1].attachmentTimestamp.toNumber()).to.be.equal(1519059539382);
            chai.expect(response[1].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response[1].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response[1].nonce.toTrytes().toString()).to.be.equal("OLRF9BJFNPFOIURDUIDYUYUPMSX");

            chai.expect(response[2].signatureMessageFragment.toTrytes().toString()).to.be.equal("DPXEWZVMOSI9OTSC9YY9IBATBWRIAFOQWLKDUDNWHDKVB99GTKCMCEFITGL9BFCAWBKWKMFNBYTALCO9ZBDESYJHRBOWEYSZLXUPBQUDEK9BFSIMJOABKSYXLPHRJHWDEDRNUTRBLEDUUTIJLCLCNWEEOJJGXNPMWAULVFFZQJDQMBFMASQFOWDWBXVV9TCTBAYRLYRCYHVTRYADD9UXQSORQOULURUGOAJLWDXKXJYTIDVDMEDBJYRMUNWKWNHPDEAULNVXMXILVZEUJCSGOITAK9IHTVXKDMZVBUCXUDYXRQJXNCZCUGFJAHRXKTINEPYWWMKMMGEL9OIZUESMGSUTBHJTIS9HFLZDROHRJYETMWSGDKASTRJKGMVVILGGVJLFR9GXV9DRUVEAEHYRDXOPYYL9TSTDDXGTVUCBUGBQXBVPYRSFDJMBCWFGHAXCI9ZFZZJXI9KBMFXLSM9E9WNMDGLVJNTYNKZZHX9BGUCNKXRY9SRSLWWMQSMNARRGYO9IIPSRABMIFWVOVCZSSYICXQTHU9NHTQGAZTTUII9WPFDUZFMXJAAJQCRBEDLLLVZGUNVDRVETWQNJCTUZAYSCNSFDQPYTIIFZLRULSCXTWHJVYZSARFKCRVZUFRSDPMWFPWXAAVDKVRVIWAWGSTSMIG9LGOYJLXDBYTFPIWITGBUSDBZNTQZCKPJYWAEZWA9AMCLZOHQFFFFVEM99SIWDCIZGDFDZRHMMBVOUCEAOLYKBSGBAEKA9HESFDRJNRMZZD9FGTGLUJLUNVTFWZKGHXLLRQDZDWXBOEOCRCXYQJJVASPNGLQPHGYEFZBEPQJMZUHXFBRGVFBIYJBQUDU9HBTUEPW99GTEJNSZEAWIWRUSSOXDEOTQGJK9TR9RDDPOUTDXPALHKABHKTGRZGSDUCGQVM9OCRVYQRZLAEMZJCD9FLJWPERPUPXIJRZMWGGPYUZHWJZVXOMIMFDLKNMTFOBJSGGBYMTQTCZBYYMQOFVRQB9NDRTRQBGVOGEOMAZLIOQIUJBOVOMUFARUQLBOLA9GZDIGVHZICDCIREHOHQWNFWJPHYZIFQDSBNNOYLNWGWUVIVLYSEHTKXIUBLDRXIHUIHTJJOQQOJJSPNTEZYBIUUSHDONVWPXLGJSBXUQNFJ9RCIPUWZAGNVCNCHGWULQWVJWMMOVWQKGNRBLVOGWLPCH9CPEXWHYWFER9JJTXMV9NFZRQRHBPQXUHMFGSVQUSOIQEYQ9CPUYHCYHLNQPGEUB9BANDSACRIRQOSEKRFZJDBZSOXSUDYHULECYC9LEQCDVWDTAJEGNZHJJYJPJRPQVEHTSAEGEEECUICNVOIP9BASZVMDOMFYCRAWTSJZFZNGEYR9YNCJVRJHRHHRBGSFFEPVUQVARIUZJRTNEWCCMIKZAKTZAXUTARGRGGFJMVODIVDEFHENUYKZUCZMMEDHWFWBXTJRMK9KZBDOAMWYWKRWQVE9IBAQCPFRPWANG9XECCEWHTQMQSKHJZNVIKK9QVIMVUPIGA9MLUNMS9DAQHWXTJVGQBOXVYLZGQHYQKVFCZUXCBXYRUFDUAXOLYDUJKBOCGRCQMNPQGMDPRXZFKSLOGEBKLIORB9TJ9AYBAUXGRTQVNOYNUZS9YPGE9JGWFUHJN9NSANREKHOVEUDHWFTGRDCLGURKINSUL9CQVHLKUMRRELAGJBVKOIVEQPUVCNGIKLNIZZYGYSOLTRTOEDTUTCHUAVSJOAMCYANYMJZLJNRSSJQDPQKW9ALXCDMESFGBB9RXSXIVUYMJPNYWLRTFTKOXOKZIXHBTYCV9UDSJNHDKGXFQXWSMBSP9YNIEEDK9YKPHGZBJTYRWI9EDZYXKJSYZOZOUPDMLQXHJASMYITMKWLNYRAAKAIOSXXPTCESBUJSBCCKJTFMPZYIHRIVJUGKLMHEUFGICXCACN9PNVWEPCJYZZWPVPPZWSZUQUJTWDQZSNPHYSFAPI9FVFOMMEPNXDRZHNVSRSE9YUAYMYPTEBMRA9KXINTPYCXWXEMYZIRDEXAHFJVSGZDDOGJHWBFPHYNDQPBYQUAHHAVTPSGBCKRGJHNLBWQRQLSVW9PHVDFGASIZWEYJFTNUQVBGVKLFWSPESLNFPAOVPXEKMCWAFVDCZSB99UHXECKWUXEHRFXKNH9PPDYTEBXUMQCASX");
            chai.expect(response[2].address.toTrytes().toString()).to.be.equal("XECWTYDA9UWNYZEVNDHFHFGEKGIFRGKARQG9UMRAESXYSTBTDSLEBLLWVAVVVBYYQZOIEZGIPIIL9BXIB");
            chai.expect(response[2].value.toNumber()).to.be.equal(0);
            chai.expect(response[2].obsoleteTag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response[2].timestamp.toNumber()).to.be.equal(1519058554);
            chai.expect(response[2].currentIndex.toNumber()).to.be.equal(2);
            chai.expect(response[2].lastIndex.toNumber()).to.be.equal(2);
            chai.expect(response[2].bundle.toTrytes().toString()).to.be.equal("EWEUWXFPUJCCWJT9ANZ9UJHCTBKYK9CSHPCNRJLSIKZJDGGFDWUNCIBCKKNWALE9ZOVWVVGWCDUJUDSSD");
            chai.expect(response[2].trunkTransaction.toTrytes().toString()).to.be.equal("PWK9RFDCFL9NHLVXTRTOBYQLDTGDOKZEOZGVNEOOQSILOCTHCMVHVGAJMGAJUOSPCJ9JESXNATBL99999");
            chai.expect(response[2].branchTransaction.toTrytes().toString()).to.be.equal("CRTPYSKRCJPBCJMLGTYWSPQSIVRYCCZAGLJCSDR9BXWDKYLFUGZZFNH9EUSXGOCWHDJNJYLRFETUZ9999");
            chai.expect(response[2].tag.toTrytes().toString()).to.be.equal("999999999999999999999999999");
            chai.expect(response[2].attachmentTimestamp.toNumber()).to.be.equal(1519059539311);
            chai.expect(response[2].attachmentTimestampLowerBound.toNumber()).to.be.equal(0);
            chai.expect(response[2].attachmentTimestampUpperBound.toNumber()).to.be.equal(12);
            chai.expect(response[2].nonce.toTrytes().toString()).to.be.equal("AJNKZDXLQN9AYHXWIRTBGASOVXP");
        });
    });

    describe("isPromotable", () => {
        it("can fail with invalid transactionTail", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.isPromotable(<any>"ABC");
            } catch (err) {
                chai.expect(err.message).to.contain("The transactionTail");
            }
        });

        it("can find out if tail hash is promotable", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.checkConsistency = sandbox.stub().resolves({ state: true });

            const response = await obj.isPromotable(Hash.fromTrytes(Trytes.fromString("HSXHHMXFSXMU9BPHHUVZNNMPGMJGDLXAOICGIESRMNAVUWKIQLNCLXCEEOS9XZHTKNFIVHOLWPHCA9999")));

            chai.expect(response).to.be.equal(true);
        });
    });

    describe("getAccountData", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAccountData(<any>"ABC");
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can find out if tail hash is promotable", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.checkConsistency = sandbox.stub().resolves({ state: true });

            const response = await obj.isPromotable(Hash.fromTrytes(Trytes.fromString("HSXHHMXFSXMU9BPHHUVZNNMPGMJGDLXAOICGIESRMNAVUWKIQLNCLXCEEOS9XZHTKNFIVHOLWPHCA9999")));

            chai.expect(response).to.be.equal(true);
        });
    });

    describe("getTransfers", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getTransfers(<any>"ABC");
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can succeed getting transfers with no inclusion states", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub()
                .onFirstCall().resolves({ states: [false] })
                .onSecondCall().resolves({ states: [true] })
                .onThirdCall().resolves({ states: [false] })
                .onCall(3).resolves({ states: [false] });

            apiClientStub.findTransactions = sandbox.stub()
                .onFirstCall().resolves({ hashes: ["FEYIRDWADNECHOLNSVFMXP9T9ZGVYLVFNTKEOGQTWDLMEWHFHYHV9XCPGXUUOSS9TLDGGRSRRNTP99999"] })
                .onSecondCall().resolves({ hashes: ["IJLHCBOQEMPZ9AZQABYHWGNODH9KEUANECDSDVKDMSOZXODSUPWFWHFKTVOQBYSGALWSRKMHETIA99999"] })
                .onThirdCall().resolves({ hashes: [] })
                .onCall(3).resolves({ hashes: ["FEYIRDWADNECHOLNSVFMXP9T9ZGVYLVFNTKEOGQTWDLMEWHFHYHV9XCPGXUUOSS9TLDGGRSRRNTP99999",
                "IJLHCBOQEMPZ9AZQABYHWGNODH9KEUANECDSDVKDMSOZXODSUPWFWHFKTVOQBYSGALWSRKMHETIA99999"] })
                .onCall(4).resolves({ hashes: [] });

            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: [
                    // tslint:disable:max-line-length
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999MJYZGLOPCBS9MJPBEPREB9MBZF9ULQVKVXIVJHWLLRBKXUPWLLEPQDWQJZZASWANXSQHOAXBVYMYGIKKA999999999999999999999999999QC9999999999999999999999999JKSBTYD99999999999999999999LLCXNCTZXFWXGVHAFHBROIIFCQQZYHKCIHSL9UVGLROZWUF9TDBF9UZNFLYAOFJZVQEDXBILAQINGECEYEPPBYDVSQPGBPLJMWFKMSSZAMINHEJQECNIVIRGPWVLADAEGMJZZZ9DEDODIKVQZYWTXMEBSS9ZHZ9999HBSQXDEVJHWEVKGMPBCGKSNEWFLXARYGLIXEBOM9FHGPJMKIE9BL9GRDNVPYVXIRJRATXFENHCSHA9999999999999999999999999999999DQLRCKAJE999999999MMMMMMMMMOA9999VD9999999999999999999",
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GIMLWZTAWQLIGROCDUPETMNFQQOHQVDSTKIFJUSV9KNQUCZXDQEY9TJRDNAMXLMQTMQNI9ERDSGGBXA99999999999999999999999999999WB9999999999999999999999999HUTBTYD99999999999999999999GGDQXLILX9SICBKBSQEQROQJYJCTUKIWHUPGBZODDABCXPYKIXGKRGEKO9JISXEJRAPLWSXLHFXXSJGFCRM9QWDUOWVTNHZAWRNRYUVYAT9KECRXXF9NMVHJOPMRJRYJJGETPUHGR9JFOIEZJGAVPAIBIPXQAA9999ELDEHWCZGGZCYKNKOYSPZOMFJRZVOKBIZUSZKTPCVWBQPNDFUIILAYGERSVJ9CLTPPODCWUFLVHBZ9999999999999999999999999999999SNAECKAJE999999999MMMMMMMMMQA999RBB9999999999999999999"] })
                .onCall(1).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999MJYZGLOPCBS9MJPBEPREB9MBZF9ULQVKVXIVJHWLLRBKXUPWLLEPQDWQJZZASWANXSQHOAXBVYMYGIKKA999999999999999999999999999QC9999999999999999999999999JKSBTYD99999999999999999999LLCXNCTZXFWXGVHAFHBROIIFCQQZYHKCIHSL9UVGLROZWUF9TDBF9UZNFLYAOFJZVQEDXBILAQINGECEYEPPBYDVSQPGBPLJMWFKMSSZAMINHEJQECNIVIRGPWVLADAEGMJZZZ9DEDODIKVQZYWTXMEBSS9ZHZ9999HBSQXDEVJHWEVKGMPBCGKSNEWFLXARYGLIXEBOM9FHGPJMKIE9BL9GRDNVPYVXIRJRATXFENHCSHA9999999999999999999999999999999DQLRCKAJE999999999MMMMMMMMMOA9999VD9999999999999999999"]})
                .onCall(2).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GIMLWZTAWQLIGROCDUPETMNFQQOHQVDSTKIFJUSV9KNQUCZXDQEY9TJRDNAMXLMQTMQNI9ERDSGGBXA99999999999999999999999999999WB9999999999999999999999999HUTBTYD99999999999999999999GGDQXLILX9SICBKBSQEQROQJYJCTUKIWHUPGBZODDABCXPYKIXGKRGEKO9JISXEJRAPLWSXLHFXXSJGFCRM9QWDUOWVTNHZAWRNRYUVYAT9KECRXXF9NMVHJOPMRJRYJJGETPUHGR9JFOIEZJGAVPAIBIPXQAA9999ELDEHWCZGGZCYKNKOYSPZOMFJRZVOKBIZUSZKTPCVWBQPNDFUIILAYGERSVJ9CLTPPODCWUFLVHBZ9999999999999999999999999999999SNAECKAJE999999999MMMMMMMMMQA999RBB9999999999999999999"] });

            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: 123 });

            const response = await obj.getTransfers(Hash.fromTrytes(Trytes.fromString("HSXHHMXFSXMU9BPHHUVZNNMPGMJGDLXAOICGIESRMNAVUWKIQLNCLXCEEOS9XZHTKNFIVHOLWPHCA9999")));

            chai.expect(response.length).to.be.equal(2);
            chai.expect(response[0].inclusionState).to.be.equal(undefined);
            chai.expect(response[0].transactions[0].address.toTrytes().toString()).to.be.equal("MJYZGLOPCBS9MJPBEPREB9MBZF9ULQVKVXIVJHWLLRBKXUPWLLEPQDWQJZZASWANXSQHOAXBVYMYGIKKA");
            chai.expect(response[1].inclusionState).to.be.equal(undefined);
            chai.expect(response[1].transactions[0].address.toTrytes().toString()).to.be.equal("GIMLWZTAWQLIGROCDUPETMNFQQOHQVDSTKIFJUSV9KNQUCZXDQEY9TJRDNAMXLMQTMQNI9ERDSGGBXA99");
        });

        it("can succeed getting transfers with tail transfers", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub()
                .onFirstCall().resolves({ states: [true] })
                .onSecondCall().resolves({ states: [false] })
                .onThirdCall().resolves({ states: [false] });

            apiClientStub.findTransactions = sandbox.stub()
                .onFirstCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999"] })
                .onSecondCall().resolves({ hashes: [] })
                .onThirdCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999",
                    "YUYMTKRVBAOMWIGXOZZXHRWSF9KSMHKG9GFJVRUWQGI9JIJHWOWGOJXHAJXXVPTYRPKLJLZJSVDA99999",
                    "FDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999",
                    "VOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999"
                ] })
                .onCall(3).resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999",
                    "OJTCTLGDZUEMDNKKKAPDYJIHNLUGVDUYNW9DRFLWJCLEHXJ9AVOLFUQSWVGCUUGPPTTDGNELURHD99999",
                    "FDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999",
                    "VOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999"
                ] });

            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: [
                    // tslint:disable:max-line-length
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999",
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999BE9999999999999999999999999PEUSWYD99999999999999999999EPZMHQIEKFCYJBHCBOCCPENSKTFAZEUUIIDLJWUIPRJKRAXLAYZLZKZMYBLSWLIZDIQWBZDRAB9JHTPPZHIYMANYRSLZXOTCDIBXZOCSTZMWUGQELJN9DOXFAJLGVBSHMLIHDVLJMXD9S9COAMEEXRDZCDISQA9999VOJIMERXAQICAWSQTZKRNM9URKXPEKPB9HSSZETSMECG9QPZMKQNBGQYDLVHQLOPYNWTGPUCFKTGA9999999999999999999999999999999XGLSPAEJE999999999MMMMMMMMMKA9999HC9999999999999999999",
                    "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999",
                    "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"
                ] })
                .onSecondCall().resolves({ trytes: [
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999",
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999",
                    "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999",
                    "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"
                ]})
                .onThirdCall().resolves({ trytes: [ "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999BE9999999999999999999999999PEUSWYD99999999999999999999EPZMHQIEKFCYJBHCBOCCPENSKTFAZEUUIIDLJWUIPRJKRAXLAYZLZKZMYBLSWLIZDIQWBZDRAB9JHTPPZHIYMANYRSLZXOTCDIBXZOCSTZMWUGQELJN9DOXFAJLGVBSHMLIHDVLJMXD9S9COAMEEXRDZCDISQA9999VOJIMERXAQICAWSQTZKRNM9URKXPEKPB9HSSZETSMECG9QPZMKQNBGQYDLVHQLOPYNWTGPUCFKTGA9999999999999999999999999999999XGLSPAEJE999999999MMMMMMMMMKA9999HC9999999999999999999"]})
                .onCall(3).resolves({ trytes: [ "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999" ]})
                .onCall(4).resolves({ trytes: [ "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999" ]})
                .onCall(5).resolves({ trytes: [ "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999" ]})
                .onCall(6).resolves({ trytes: [ "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999" ]})
                .onCall(7).resolves({ trytes: [ "ODGAHDLDGDNCGDIDRCRCTCTCSCTCSCGADBWACBZAYAVAABQAGAHDLDGDNCUCPCXC9DTCSCGADBUAQAGAQCPCSCNCQCFDPCBDRCWCGADBYAQAGAQCPCSCNCHDFDIDBDZCGADBYAQAGAQCPCSCNCHDFDIDBDZCNCPCBDSCNCQCFDPCBDRCWCGADBUAQAGAADXC9DTCGDHDCDBDTCNCHDFDIDBDZCGADBVAUAYAXAQAGAADXC9DTCGDHDCDBDTCNCQCFDPCBDRCWCGADBVAVAUAQAGAHDDDGDGADBVASACBBB9BZAABWABBYAZACBZA9BYAYAYAQAGATCFDFDCDFDNCFDPCHDTCGADBUAQAGARCPCRCWCTCSCNCHDLDGADBVA9BWAABCBWAQAGABDTCKDNCHDLDGADBYAWABBUAYA9BQAGARCCDBDUCXCFDADTCSCNCHDLDGADBCBYAQAGARCCDBDUCXCFDADPCHDXCCDBDNCFDPCHDTCGADBUASAUAXAVABBVACBYAWABBVAXAUAYAUAZAYACB9BQD99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999EXKCFXNJKBFVKXRGQINNCHDUGMOUDITMCPRMBTQCSTCDHLDSGXQEFMCWJVTGREXJZZKBVN9SRFLZAIQDB999999999999999999999999999XB9DTLG9LINUX9POWSSE9999999KGDUYYD99999999999999999999CJXRTY9K9FKITNCGJGJGQCWPDFWO9VW9VCBYLXRJFFCDO9CKTROBEZGTOJ9KUG9SEGCOBVSBKLRXZJUNYXNMHSSHYTEWPJBBGGCWVAPCCGXUDUBCYVOXBPYUOJRUUGJKFQ9KKDZZSRYKADGJYNCDBICKNQRZEA9999ABQYAEOXGIKJRZBAKYIMIMESUOOLEZJUPVOIKAFOTZRMGBKKW9GWPXSIQXZNYEYXTWTBAVYXHHFKZ9999999DTLG9LINUX9POWSSE9999999TSIQYXHJE999999999L99999999MVD9999999UHC99999999999999" ]});

            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: 123 });

            apiClientStub.getInclusionStates = sandbox.stub().resolves({ states: [false, false] });

            const response = await obj.getTransfers(Hash.fromTrytes(Trytes.fromString("HSXHHMXFSXMU9BPHHUVZNNMPGMJGDLXAOICGIESRMNAVUWKIQLNCLXCEEOS9XZHTKNFIVHOLWPHCA9999")), 0, undefined, undefined, true);

            chai.expect(response.length).to.be.equal(2);
            chai.expect(response[0].inclusionState).to.be.equal(false);
            chai.expect(response[0].transactions.length).to.be.equal(1);
            chai.expect(response[0].transactions[0].address.toTrytes().toString()).to.be.equal("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD");
            chai.expect(response[1].inclusionState).to.be.equal(false);
            chai.expect(response[1].transactions.length).to.be.equal(4);
            chai.expect(response[1].transactions[0].address.toTrytes().toString()).to.be.equal("JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROW");
            chai.expect(response[1].transactions[1].address.toTrytes().toString()).to.be.equal("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD");
            chai.expect(response[1].transactions[2].address.toTrytes().toString()).to.be.equal("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD");
            chai.expect(response[1].transactions[3].address.toTrytes().toString()).to.be.equal("PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGX");
        });

        it("can succeed getting transfers which need reordering", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub()
                .onFirstCall().resolves({ states: [true] })
                .onSecondCall().resolves({ states: [false] })
                .onThirdCall().resolves({ states: [false] });

            apiClientStub.findTransactions = sandbox.stub()
                .onFirstCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999"] })
                .onSecondCall().resolves({ hashes: [] })
                .onThirdCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999",
                    "YUYMTKRVBAOMWIGXOZZXHRWSF9KSMHKG9GFJVRUWQGI9JIJHWOWGOJXHAJXXVPTYRPKLJLZJSVDA99999",
                    "FDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999",
                    "VOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999"
                ] })
                .onCall(3).resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999",
                    "OJTCTLGDZUEMDNKKKAPDYJIHNLUGVDUYNW9DRFLWJCLEHXJ9AVOLFUQSWVGCUUGPPTTDGNELURHD99999",
                    "FDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999",
                    "VOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999"
                ] });

            const transaction1 = Transaction.fromTrytes(Trytes.fromString("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999BE9999999999999999999999999PEUSWYD99999999999999999999EPZMHQIEKFCYJBHCBOCCPENSKTFAZEUUIIDLJWUIPRJKRAXLAYZLZKZMYBLSWLIZDIQWBZDRAB9JHTPPZHIYMANYRSLZXOTCDIBXZOCSTZMWUGQELJN9DOXFAJLGVBSHMLIHDVLJMXD9S9COAMEEXRDZCDISQA9999VOJIMERXAQICAWSQTZKRNM9URKXPEKPB9HSSZETSMECG9QPZMKQNBGQYDLVHQLOPYNWTGPUCFKTGA9999999999999999999999999999999XGLSPAEJE999999999MMMMMMMMMKA9999HC9999999999999999999"));

            transaction1.attachmentTimestamp = TryteNumber.fromNumber(1619806929721);

            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: [
                    // tslint:disable:max-line-length
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999",
                    transaction1.toTrytes().toString(),
                    "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999",
                    "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"
                ] })
                .onSecondCall().resolves({ trytes: [
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999",
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999",
                    "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999",
                    "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"
                ]})
                .onThirdCall().resolves({ trytes: [ transaction1.toTrytes().toString()]})
                .onCall(3).resolves({ trytes: [ "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999" ]})
                .onCall(4).resolves({ trytes: [ "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999" ]})
                .onCall(5).resolves({ trytes: [ "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999" ]})
                .onCall(6).resolves({ trytes: [ "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999" ]})
                .onCall(7).resolves({ trytes: [ "ODGAHDLDGDNCGDIDRCRCTCTCSCTCSCGADBWACBZAYAVAABQAGAHDLDGDNCUCPCXC9DTCSCGADBUAQAGAQCPCSCNCQCFDPCBDRCWCGADBYAQAGAQCPCSCNCHDFDIDBDZCGADBYAQAGAQCPCSCNCHDFDIDBDZCNCPCBDSCNCQCFDPCBDRCWCGADBUAQAGAADXC9DTCGDHDCDBDTCNCHDFDIDBDZCGADBVAUAYAXAQAGAADXC9DTCGDHDCDBDTCNCQCFDPCBDRCWCGADBVAVAUAQAGAHDDDGDGADBVASACBBB9BZAABWABBYAZACBZA9BYAYAYAQAGATCFDFDCDFDNCFDPCHDTCGADBUAQAGARCPCRCWCTCSCNCHDLDGADBVA9BWAABCBWAQAGABDTCKDNCHDLDGADBYAWABBUAYA9BQAGARCCDBDUCXCFDADTCSCNCHDLDGADBCBYAQAGARCCDBDUCXCFDADPCHDXCCDBDNCFDPCHDTCGADBUASAUAXAVABBVACBYAWABBVAXAUAYAUAZAYACB9BQD99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999EXKCFXNJKBFVKXRGQINNCHDUGMOUDITMCPRMBTQCSTCDHLDSGXQEFMCWJVTGREXJZZKBVN9SRFLZAIQDB999999999999999999999999999XB9DTLG9LINUX9POWSSE9999999KGDUYYD99999999999999999999CJXRTY9K9FKITNCGJGJGQCWPDFWO9VW9VCBYLXRJFFCDO9CKTROBEZGTOJ9KUG9SEGCOBVSBKLRXZJUNYXNMHSSHYTEWPJBBGGCWVAPCCGXUDUBCYVOXBPYUOJRUUGJKFQ9KKDZZSRYKADGJYNCDBICKNQRZEA9999ABQYAEOXGIKJRZBAKYIMIMESUOOLEZJUPVOIKAFOTZRMGBKKW9GWPXSIQXZNYEYXTWTBAVYXHHFKZ9999999DTLG9LINUX9POWSSE9999999TSIQYXHJE999999999L99999999MVD9999999UHC99999999999999" ]});

            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: 123 });

            apiClientStub.getInclusionStates = sandbox.stub().resolves({ states: [false, false] });

            const response = await obj.getTransfers(Hash.fromTrytes(Trytes.fromString("HSXHHMXFSXMU9BPHHUVZNNMPGMJGDLXAOICGIESRMNAVUWKIQLNCLXCEEOS9XZHTKNFIVHOLWPHCA9999")), 0, undefined, undefined, true);

            chai.expect(response.length).to.be.equal(2);
            chai.expect(response[0].inclusionState).to.be.equal(false);
            chai.expect(response[0].transactions.length).to.be.equal(4);
            chai.expect(response[0].transactions[0].address.toTrytes().toString()).to.be.equal("JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROW");
            chai.expect(response[0].transactions[1].address.toTrytes().toString()).to.be.equal("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD");
            chai.expect(response[0].transactions[2].address.toTrytes().toString()).to.be.equal("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD");
            chai.expect(response[0].transactions[3].address.toTrytes().toString()).to.be.equal("PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGX");
            chai.expect(response[1].inclusionState).to.be.equal(false);
            chai.expect(response[1].transactions.length).to.be.equal(1);
            chai.expect(response[1].transactions[0].address.toTrytes().toString()).to.be.equal("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD");
        });
    });

    describe("findTransactionObjects", () => {
        it("can be called with no response", async () => {
            apiClientStub.findTransactions = sandbox.stub().resolves(undefined);
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.findTransactionObjects(undefined, [Address.fromTrytes(Trytes.fromString("XFAELMMFKBKNGAYLKNFOLHMOTAM9IVOLABDLNKNWUIFK9QJXEJKGAUHMEPMYPGLPFBWZAXJMFZYCWMQEA"))]);
            chai.expect(response).be.deep.equal([]);
        });

        it("can be called with bundles and return some transactions", async () => {
            apiClientStub.findTransactions = sandbox.stub().resolves({
                hashes: [
                    "TSQWPHOJGWJOACGHSWKXLOVSLPUZWTWGMOPKUWDNXGUERKK9PPFKBGFUKWMDGZBZZTLXHRTPIYEU99999",
                    "PPAYHUKKHOAPUNCMRXWLZKY9WOVUJ9BNETKVMYZKA9UIVYJSEOVVNPZSYBFVRZGHEKPMQSHEEVPLA9999"
                ]
            });
            // tslint:disable-next-line:max-line-length
            apiClientStub.getTrytes = sandbox.stub().resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999"]});
            const obj = new TransactionClient(apiClientStub);
            const response = await obj.findTransactionObjects([Hash.fromTrytes(Trytes.fromString("XGEGFFINFHKFCTT9TCSFVNWYZRWMGMVJKKXQBTGSTFUKDVJ9SGSIWZJIZTNO9DWNGQGHVJBKOR9GBKKWW"))]);
            chai.expect(response[0].address.toTrytes().toString()).be.equal("PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGX");
        });
    });

    describe("getAccountData", () => {
        it("can fail with invalid seed", async () => {
            const obj = new TransactionClient(apiClientStub);
            try {
                await obj.getAccountData(<any>"ABC");
            } catch (err) {
                chai.expect(err.message).to.contain("The seed");
            }
        });

        it("can be called to get account data", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub()
                .onFirstCall().resolves({ states: [true] })
                .onSecondCall().resolves({ states: [false] })
                .onThirdCall().resolves({ states: [false] });

            apiClientStub.findTransactions = sandbox.stub()
                .onFirstCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999"] })
                .onSecondCall().resolves({ hashes: [] })
                .onThirdCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999"] })
                .onCall(3).resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999",
                    "OJTCTLGDZUEMDNKKKAPDYJIHNLUGVDUYNW9DRFLWJCLEHXJ9AVOLFUQSWVGCUUGPPTTDGNELURHD99999",
                    "FDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999",
                    "VOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999"
                ] });

            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: [
                    // tslint:disable:max-line-length
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999",
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999BE9999999999999999999999999PEUSWYD99999999999999999999EPZMHQIEKFCYJBHCBOCCPENSKTFAZEUUIIDLJWUIPRJKRAXLAYZLZKZMYBLSWLIZDIQWBZDRAB9JHTPPZHIYMANYRSLZXOTCDIBXZOCSTZMWUGQELJN9DOXFAJLGVBSHMLIHDVLJMXD9S9COAMEEXRDZCDISQA9999VOJIMERXAQICAWSQTZKRNM9URKXPEKPB9HSSZETSMECG9QPZMKQNBGQYDLVHQLOPYNWTGPUCFKTGA9999999999999999999999999999999XGLSPAEJE999999999MMMMMMMMMKA9999HC9999999999999999999",
                    "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999",
                    "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"
                ] })
                .onCall(1).resolves({ trytes: [
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999",
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999",
                    "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999",
                    "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"
                ]})
                .onCall(2).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999BE9999999999999999999999999PEUSWYD99999999999999999999EPZMHQIEKFCYJBHCBOCCPENSKTFAZEUUIIDLJWUIPRJKRAXLAYZLZKZMYBLSWLIZDIQWBZDRAB9JHTPPZHIYMANYRSLZXOTCDIBXZOCSTZMWUGQELJN9DOXFAJLGVBSHMLIHDVLJMXD9S9COAMEEXRDZCDISQA9999VOJIMERXAQICAWSQTZKRNM9URKXPEKPB9HSSZETSMECG9QPZMKQNBGQYDLVHQLOPYNWTGPUCFKTGA9999999999999999999999999999999XGLSPAEJE999999999MMMMMMMMMKA9999HC9999999999999999999"] })
                .onCall(3).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999"] })
                .onCall(4).resolves({ trytes: ["YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"] })
                .onCall(5).resolves({ trytes: ["UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999"] })
                .onCall(6).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999"] })
                .onCall(7).resolves({ trytes: ["ODGAHDLDGDNCGDIDRCRCTCTCSCTCSCGADBWACBZAYAVAABQAGAHDLDGDNCUCPCXC9DTCSCGADBUAQAGAQCPCSCNCQCFDPCBDRCWCGADBYAQAGAQCPCSCNCHDFDIDBDZCGADBYAQAGAQCPCSCNCHDFDIDBDZCNCPCBDSCNCQCFDPCBDRCWCGADBUAQAGAADXC9DTCGDHDCDBDTCNCHDFDIDBDZCGADBVAUAYAXAQAGAADXC9DTCGDHDCDBDTCNCQCFDPCBDRCWCGADBVAVAUAQAGAHDDDGDGADBVASACBBB9BZAABWABBYAZACBZA9BYAYAYAQAGATCFDFDCDFDNCFDPCHDTCGADBUAQAGARCPCRCWCTCSCNCHDLDGADBVA9BWAABCBWAQAGABDTCKDNCHDLDGADBYAWABBUAYA9BQAGARCCDBDUCXCFDADTCSCNCHDLDGADBCBYAQAGARCCDBDUCXCFDADPCHDXCCDBDNCFDPCHDTCGADBUASAUAXAVABBVACBYAWABBVAXAUAYAUAZAYACB9BQD99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999EXKCFXNJKBFVKXRGQINNCHDUGMOUDITMCPRMBTQCSTCDHLDSGXQEFMCWJVTGREXJZZKBVN9SRFLZAIQDB999999999999999999999999999XB9DTLG9LINUX9POWSSE9999999KGDUYYD99999999999999999999CJXRTY9K9FKITNCGJGJGQCWPDFWO9VW9VCBYLXRJFFCDO9CKTROBEZGTOJ9KUG9SEGCOBVSBKLRXZJUNYXNMHSSHYTEWPJBBGGCWVAPCCGXUDUBCYVOXBPYUOJRUUGJKFQ9KKDZZSRYKADGJYNCDBICKNQRZEA9999ABQYAEOXGIKJRZBAKYIMIMESUOOLEZJUPVOIKAFOTZRMGBKKW9GWPXSIQXZNYEYXTWTBAVYXHHFKZ9999999DTLG9LINUX9POWSSE9999999TSIQYXHJE999999999L99999999MVD9999999UHC99999999999999"] });

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: [ "0", "42" ] });

            apiClientStub.getInclusionStates = sandbox.stub().resolves({ states: [false, true] });

            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: 123 });

            const response = await obj.getAccountData(Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN")));
            chai.expect(response.latestAddress.toTrytes().toString()).be.equal("IXZB9YTAFLWEZXLGWYHWFJMFZTZIELYYVYNVFLAVAOVKVQWHLHIEZCPECH9ZDHXATTKFANDZWTSSWTVLC");
            chai.expect(response.addresses[0].toTrytes().toString()).be.equal("GGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD");
            chai.expect(response.addresses[1].toTrytes().toString()).be.equal("PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGX");
            chai.expect(response.transfers.length).be.equal(2);
            chai.expect(response.transfers[0].transactions.length).be.equal(1);
            chai.expect(response.transfers[1].transactions.length).be.equal(4);
            chai.expect(response.inputs.length).be.equal(1);
            chai.expect(response.inputs[0].address.toTrytes().toString()).be.equal("PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGX");
            chai.expect(response.inputs[0].keyIndex).be.equal(1);
            chai.expect(response.inputs[0].security).be.equal(2);
            chai.expect(response.inputs[0].balance).be.equal(42);
            chai.expect(response.balance).be.equal(42);
        });

        it("can be called to get account data with startIndex", async () => {
            const obj = new TransactionClient(apiClientStub);

            apiClientStub.wereAddressesSpentFrom = sandbox.stub()
                .onFirstCall().resolves({ states: [false] })
                .onSecondCall().resolves({ states: [false] });

            apiClientStub.findTransactions = sandbox.stub()
                .onFirstCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999"] })
                .onSecondCall().resolves({ hashes: [] })
                .onThirdCall().resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999"] })
                .onCall(3).resolves({ hashes: ["AWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999",
                    "OJTCTLGDZUEMDNKKKAPDYJIHNLUGVDUYNW9DRFLWJCLEHXJ9AVOLFUQSWVGCUUGPPTTDGNELURHD99999",
                    "FDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999",
                    "VOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999"
                ] });

            apiClientStub.getTrytes = sandbox.stub()
                .onFirstCall().resolves({ trytes: [
                    // tslint:disable:max-line-length
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999"] })
                .onCall(1).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999",
                    "999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999",
                    "UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999",
                    "YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"
                ]})
                .onCall(2).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999"] })
                .onCall(3).resolves({ trytes: ["YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999"] })
                .onCall(4).resolves({ trytes: ["UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999"] })
                .onCall(5).resolves({ trytes: ["999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999"] })
                .onCall(6).resolves({ trytes: ["ODGAHDLDGDNCGDIDRCRCTCTCSCTCSCGADBWACBZAYAVAABQAGAHDLDGDNCUCPCXC9DTCSCGADBUAQAGAQCPCSCNCQCFDPCBDRCWCGADBYAQAGAQCPCSCNCHDFDIDBDZCGADBYAQAGAQCPCSCNCHDFDIDBDZCNCPCBDSCNCQCFDPCBDRCWCGADBUAQAGAADXC9DTCGDHDCDBDTCNCHDFDIDBDZCGADBVAUAYAXAQAGAADXC9DTCGDHDCDBDTCNCQCFDPCBDRCWCGADBVAVAUAQAGAHDDDGDGADBVASACBBB9BZAABWABBYAZACBZA9BYAYAYAQAGATCFDFDCDFDNCFDPCHDTCGADBUAQAGARCPCRCWCTCSCNCHDLDGADBVA9BWAABCBWAQAGABDTCKDNCHDLDGADBYAWABBUAYA9BQAGARCCDBDUCXCFDADTCSCNCHDLDGADBCBYAQAGARCCDBDUCXCFDADPCHDXCCDBDNCFDPCHDTCGADBUASAUAXAVABBVACBYAWABBVAXAUAYAUAZAYACB9BQD99999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999EXKCFXNJKBFVKXRGQINNCHDUGMOUDITMCPRMBTQCSTCDHLDSGXQEFMCWJVTGREXJZZKBVN9SRFLZAIQDB999999999999999999999999999XB9DTLG9LINUX9POWSSE9999999KGDUYYD99999999999999999999CJXRTY9K9FKITNCGJGJGQCWPDFWO9VW9VCBYLXRJFFCDO9CKTROBEZGTOJ9KUG9SEGCOBVSBKLRXZJUNYXNMHSSHYTEWPJBBGGCWVAPCCGXUDUBCYVOXBPYUOJRUUGJKFQ9KKDZZSRYKADGJYNCDBICKNQRZEA9999ABQYAEOXGIKJRZBAKYIMIMESUOOLEZJUPVOIKAFOTZRMGBKKW9GWPXSIQXZNYEYXTWTBAVYXHHFKZ9999999DTLG9LINUX9POWSSE9999999TSIQYXHJE999999999L99999999MVD9999999UHC99999999999999"] });

            apiClientStub.getBalances = sandbox.stub().resolves({ balances: [ "42" ] });

            apiClientStub.getInclusionStates = sandbox.stub().resolves({ states: [true] });

            apiClientStub.getNodeInfo = sandbox.stub().resolves({ latestSolidSubtangleMilestone: 123 });

            const response = await obj.getAccountData(Hash.fromTrytes(Trytes.fromString("ISHKSEIVNKYFLYAUKVDRAWEUIZJIAAVICHFCIAEEUPSIJJXTLOLVJBZWEISNBVQLQJCSHCAUAFMATP9KN")), 1);
            chai.expect(response.latestAddress.toTrytes().toString()).be.equal("IXZB9YTAFLWEZXLGWYHWFJMFZTZIELYYVYNVFLAVAOVKVQWHLHIEZCPECH9ZDHXATTKFANDZWTSSWTVLC");
            chai.expect(response.addresses[0].toTrytes().toString()).be.equal("PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGX");
            chai.expect(response.transfers.length).be.equal(1);
            chai.expect(response.transfers[0].transactions.length).be.equal(4);
            chai.expect(response.inputs.length).be.equal(1);
            chai.expect(response.inputs[0].address.toTrytes().toString()).be.equal("PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGX");
            chai.expect(response.inputs[0].keyIndex).be.equal(1);
            chai.expect(response.inputs[0].security).be.equal(2);
            chai.expect(response.inputs[0].balance).be.equal(42);
            chai.expect(response.balance).be.equal(42);
        });
    });
});
